
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Official documentation for RL4CO">
      
      
      
        <link rel="canonical" href="https://ai4co.github.io/rl4co/docs/content/api/zoo/constructive_nar/">
      
      
        <link rel="prev" href="../constructive_ar/">
      
      
        <link rel="next" href="../improvement/">
      
      
        
      
      
      <link rel="icon" href="../../../../assets/figs/rl4co-logo.svg">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.1">
    
    
      
        <title>Constructive NAR Methods - RL4CO</title>
      
    
    
      <link rel="stylesheet" href="../../../../../assets/stylesheets/main.484c7ddc.min.css">
      
        
        <link rel="stylesheet" href="../../../../../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Noto+Sans:300,300i,400,400i,700,700i%7CFira+Code:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Noto Sans";--md-code-font:"Fira Code"}</style>
      
    
    
      <link rel="stylesheet" href="../../../../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../../../stylesheets/extra.css">
    
      <link rel="stylesheet" href="../../../../stylesheets/mkdocstrings.css">
    
      <link rel="stylesheet" href="https://unpkg.com/katex@0/dist/katex.min.css">
    
    <script>__md_scope=new URL("../../../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#constructive-nonautoregressive" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../../../.." title="RL4CO" class="md-header__button md-logo" aria-label="RL4CO" data-md-component="logo">
      
  <img src="../../../../assets/figs/rl4co-logo.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            RL4CO
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Constructive NAR Methods
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9zM20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12zm-9.15 3.96h2.3L12 9z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="custom" data-md-color-accent="custom"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="custom" data-md-color-accent="custom"  aria-label="Switch to system preference"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Switch to system preference" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/ai4co/rl4co/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    ai4co/rl4co
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../../.." class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../start/installation/" class="md-tabs__link">
          
  
  
    
  
  Getting Started

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../intro/intro/" class="md-tabs__link">
          
  
  
    
  
  Overview

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../../examples/1-quickstart/" class="md-tabs__link">
          
  
  
    
  
  Tutorials

        </a>
      </li>
    
  

    
  

      
        
  
  
  
    
  
  
    
    
      
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../../envs/base/" class="md-tabs__link">
          
  
  
    
  
  API Reference

        </a>
      </li>
    
  

    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../general/contribute/" class="md-tabs__link">
          
  
  
    
  
  About

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../../.." title="RL4CO" class="md-nav__button md-logo" aria-label="RL4CO" data-md-component="logo">
      
  <img src="../../../../assets/figs/rl4co-logo.svg" alt="logo">

    </a>
    RL4CO
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/ai4co/rl4co/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    ai4co/rl4co
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Home
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Getting Started
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Getting Started
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../start/installation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Installation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../examples/1-quickstart/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    RL4CO Quickstart Notebook
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../start/hydra/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Training with Hydra
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Overview
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../intro/intro/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Introduction
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../intro/environments/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Environments
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../intro/policies/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Policies
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../intro/rl/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    RL Algorithms
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Tutorials
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Tutorials
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4_1" >
        
          
          <label class="md-nav__link" for="__nav_4_1" id="__nav_4_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Main
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1">
            <span class="md-nav__icon md-icon"></span>
            
  
    Main
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../examples/1-quickstart/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    RL4CO Quickstart Notebook
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../examples/2-full-training/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Training: Checkpoints, Logging, and Callbacks
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../examples/3-creating-new-env-model/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    New Environment: Creating and Modeling
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4_2" >
        
          
          <label class="md-nav__link" for="__nav_4_2" id="__nav_4_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Modeling
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Modeling
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../examples/modeling/1-decoding-strategies/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    RL4CO Decoding Strategies Notebook
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../examples/modeling/2-transductive-methods/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Transductive Methods
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../examples/modeling/3-change-encoder/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Encoder Customization
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4_3" >
        
          
          <label class="md-nav__link" for="__nav_4_3" id="__nav_4_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Advanced
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Advanced
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../examples/advanced/1-hydra-config/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Hydra Configuration
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../examples/advanced/3-local-search/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Local Search
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../examples/other/3-data-generator-distributions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Generating data in RL4CO
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4_4" >
        
          
          <label class="md-nav__link" for="__nav_4_4" id="__nav_4_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Routing
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Routing
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../examples/other/1-mtvrp/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    MTVRP: Multi-task VRP environment
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../examples/datasets/1-test-on-tsplib/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Testing Model on TSPLib
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../examples/datasets/2-test-on-cvrplib/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Testing Model on VRPLib
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4_5" >
        
          
          <label class="md-nav__link" for="__nav_4_5" id="__nav_4_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Scheduling
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    Scheduling
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../examples/other/2-scheduling/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Solving the Flexible Job-Shop Scheduling Problem (FJSP)
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" checked>
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    API Reference
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    API Reference
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5_1" >
        
          
          <label class="md-nav__link" for="__nav_5_1" id="__nav_5_1_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Environments
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1">
            <span class="md-nav__icon md-icon"></span>
            
  
    Environments
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../envs/base/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Base Classes
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../envs/routing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Routing Problems
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../envs/scheduling/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Scheduling Problems
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../envs/eda/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    EDA Problems
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../envs/graph/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Graph Problems
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5_2" >
        
          
          <label class="md-nav__link" for="__nav_5_2" id="__nav_5_2_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Networks
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Networks
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../networks/base_policies/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Policy Base Classes
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../networks/nn/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Neural Network Modules
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../networks/env_embeddings/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Environment Embeddings
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5_3" >
        
          
          <label class="md-nav__link" for="__nav_5_3" id="__nav_5_3_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    RL Algorithms
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    RL Algorithms
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../rl/base/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Base Classes
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../rl/reinforce/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    REINFORCE
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../rl/ppo/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    PPO
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../rl/a2c/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    A2C
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_4" checked>
        
          
          <label class="md-nav__link" for="__nav_5_4" id="__nav_5_4_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Zoo
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Zoo
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../constructive_ar/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Constructive AR Methods
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    Constructive NAR Methods
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    Constructive NAR Methods
  

    
  </span>
  
  

      </a>
      
        

  

<nav class="md-nav md-nav--secondary" aria-label="Page contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Page contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#deepaco" class="md-nav__link">
    <span class="md-ellipsis">
      
        DeepACO
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#models.zoo.deepaco.antsystem.AntSystem" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;AntSystem
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" AntSystem">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#models.zoo.deepaco.antsystem.AntSystem.run" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;run
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#models.zoo.deepaco.antsystem.AntSystem.local_search" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;local_search
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#models.zoo.deepaco.model.DeepACO" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;DeepACO
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" DeepACO">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#models.zoo.deepaco.model.DeepACO.calculate_loss" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;calculate_loss
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#models.zoo.deepaco.policy.DeepACOPolicy" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;DeepACOPolicy
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" DeepACOPolicy">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#models.zoo.deepaco.policy.DeepACOPolicy.forward" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;forward
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nar-gnn" class="md-nav__link">
    <span class="md-ellipsis">
      
        NAR-GNN
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#models.zoo.nargnn.policy.NARGNNPolicy" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;NARGNNPolicy
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#models.zoo.nargnn.encoder.EdgeHeatmapGenerator" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;EdgeHeatmapGenerator
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#models.zoo.nargnn.encoder.NARGNNEncoder" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;NARGNNEncoder
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" NARGNNEncoder">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#models.zoo.nargnn.encoder.NARGNNEncoder.forward" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;forward
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#models.zoo.nargnn.encoder.NARGNNNodeEncoder" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;NARGNNNodeEncoder
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" NARGNNNodeEncoder">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#models.zoo.nargnn.encoder.NARGNNNodeEncoder.forward" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;forward
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../improvement/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Improvement Methods
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../transductive/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Transductive Methods
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5_5" >
        
          
          <label class="md-nav__link" for="__nav_5_5" id="__nav_5_5_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Additional APIs
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    Additional APIs
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tasks/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Train and Evaluation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../decoding/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Decoding Strategies
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Data
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    About
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            
  
    About
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../general/contribute/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Contributing to RL4CO
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../general/faq/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    FAQ
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../general/paper/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Paper and Citation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../general/licensing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    License and Usage
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../general/ai4co/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Join AI4CO
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  

<nav class="md-nav md-nav--secondary" aria-label="Page contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Page contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#deepaco" class="md-nav__link">
    <span class="md-ellipsis">
      
        DeepACO
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#models.zoo.deepaco.antsystem.AntSystem" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;AntSystem
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" AntSystem">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#models.zoo.deepaco.antsystem.AntSystem.run" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;run
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#models.zoo.deepaco.antsystem.AntSystem.local_search" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;local_search
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#models.zoo.deepaco.model.DeepACO" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;DeepACO
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" DeepACO">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#models.zoo.deepaco.model.DeepACO.calculate_loss" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;calculate_loss
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#models.zoo.deepaco.policy.DeepACOPolicy" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;DeepACOPolicy
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" DeepACOPolicy">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#models.zoo.deepaco.policy.DeepACOPolicy.forward" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;forward
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nar-gnn" class="md-nav__link">
    <span class="md-ellipsis">
      
        NAR-GNN
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#models.zoo.nargnn.policy.NARGNNPolicy" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;NARGNNPolicy
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#models.zoo.nargnn.encoder.EdgeHeatmapGenerator" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;EdgeHeatmapGenerator
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#models.zoo.nargnn.encoder.NARGNNEncoder" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;NARGNNEncoder
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" NARGNNEncoder">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#models.zoo.nargnn.encoder.NARGNNEncoder.forward" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;forward
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#models.zoo.nargnn.encoder.NARGNNNodeEncoder" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;NARGNNNodeEncoder
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" NARGNNNodeEncoder">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#models.zoo.nargnn.encoder.NARGNNNodeEncoder.forward" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;forward
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
                



  


  <nav class="md-path" aria-label="Navigation" >
    <ol class="md-path__list">
      
        
  
  
    <li class="md-path__item">
      <a href="../../../../.." class="md-path__link">
        
  <span class="md-ellipsis">
    Home
  </span>

      </a>
    </li>
  

      
      
        
  
  
    
    
      
  
  
    
    
      <li class="md-path__item">
        <a href="../../envs/base/" class="md-path__link">
          
  <span class="md-ellipsis">
    API Reference
  </span>

        </a>
      </li>
    
  

    
  

      
        
  
  
    
    
      <li class="md-path__item">
        <a href="../constructive_ar/" class="md-path__link">
          
  <span class="md-ellipsis">
    Zoo
  </span>

        </a>
      </li>
    
  

      
    </ol>
  </nav>

              
              <article class="md-content__inner md-typeset">
                


                  


  
  


<h1 id="constructive-nonautoregressive">Constructive NonAutoregressive<a class="headerlink" href="#constructive-nonautoregressive" title="Permanent link">&para;</a></h1>
<h2 id="deepaco">DeepACO<a class="headerlink" href="#deepaco" title="Permanent link">&para;</a></h2>


<div class="doc doc-object doc-module">




    <div class="doc doc-contents first">










<p><span class="doc-section-title">Classes:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          <b><code><a class="autorefs autorefs-internal" href="#models.zoo.deepaco.antsystem.AntSystem">AntSystem</a></code></b>
          –
          <div class="doc-md-description">
            <p>Implements the Ant System algorithm: <a href="https://doi.org/10.1109/3477.484436">https://doi.org/10.1109/3477.484436</a>.</p>
          </div>
        </li>
    </ul>







<div class="doc doc-children">









<div class="doc doc-object doc-class">



<h2 id="models.zoo.deepaco.antsystem.AntSystem" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">AntSystem</span>


<a href="#models.zoo.deepaco.antsystem.AntSystem" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="language-python doc-signature highlight"><pre><span></span><code><span class="nf">AntSystem</span><span class="p">(</span>
    <span class="n">log_heuristic</span><span class="p">:</span> <span class="n"><span title="torch.Tensor">Tensor</span></span><span class="p">,</span>
    <span class="n">n_ants</span><span class="p">:</span> <span class="n"><span title="int">int</span></span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span>
    <span class="n">alpha</span><span class="p">:</span> <span class="n"><span title="float">float</span></span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
    <span class="n">beta</span><span class="p">:</span> <span class="n"><span title="float">float</span></span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
    <span class="n">decay</span><span class="p">:</span> <span class="n"><span title="float">float</span></span> <span class="o">=</span> <span class="mf">0.95</span><span class="p">,</span>
    <span class="n">Q</span><span class="p">:</span> <span class="n"><span title="float">float</span></span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">pheromone</span><span class="p">:</span> <span class="n"><span title="torch.Tensor">Tensor</span></span> <span class="o">|</span> <span class="n"><span title="int">int</span></span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">use_local_search</span><span class="p">:</span> <span class="n"><span title="bool">bool</span></span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">use_nls</span><span class="p">:</span> <span class="n"><span title="bool">bool</span></span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">n_perturbations</span><span class="p">:</span> <span class="n"><span title="int">int</span></span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">local_search_params</span><span class="p">:</span> <span class="n"><span title="dict">dict</span></span> <span class="o">=</span> <span class="p">{},</span>
    <span class="n">perturbation_params</span><span class="p">:</span> <span class="n"><span title="dict">dict</span></span> <span class="o">=</span> <span class="p">{},</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">



        <p>Implements the Ant System algorithm: <a href="https://doi.org/10.1109/3477.484436">https://doi.org/10.1109/3477.484436</a>.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>log_heuristic</code></b>
              (<code><span title="torch.Tensor">Tensor</span></code>)
          –
          <div class="doc-md-description">
            <p>Logarithm of the heuristic matrix.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>n_ants</code></b>
              (<code><span title="int">int</span></code>, default:
                  <code>20</code>
)
          –
          <div class="doc-md-description">
            <p>Number of ants to be used in the algorithm. Defaults to 20.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>alpha</code></b>
              (<code><span title="float">float</span></code>, default:
                  <code>1.0</code>
)
          –
          <div class="doc-md-description">
            <p>Importance of pheromone in the decision-making process. Defaults to 1.0.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>beta</code></b>
              (<code><span title="float">float</span></code>, default:
                  <code>1.0</code>
)
          –
          <div class="doc-md-description">
            <p>Importance of heuristic information in the decision-making process. Defaults to 1.0.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>decay</code></b>
              (<code><span title="float">float</span></code>, default:
                  <code>0.95</code>
)
          –
          <div class="doc-md-description">
            <p>Rate at which pheromone evaporates. Should be between 0 and 1. Defaults to 0.95.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>Q</code></b>
              (<code><span title="float">float</span> | None</code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>Rate at which pheromone deposits. Defaults to <code>1 / n_ants</code>.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>pheromone</code></b>
              (<code><span title="torch.Tensor">Tensor</span> | <span title="int">int</span> | None</code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>Initial pheromone matrix. Defaults to <code>torch.ones_like(log_heuristic)</code>.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>use_local_search</code></b>
              (<code><span title="bool">bool</span></code>, default:
                  <code>False</code>
)
          –
          <div class="doc-md-description">
            <p>Whether to use local_search provided by the env. Default to False.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>use_nls</code></b>
              (<code><span title="bool">bool</span></code>, default:
                  <code>False</code>
)
          –
          <div class="doc-md-description">
            <p>Whether to use neural-guided local search provided by the env. Default to False.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>n_perturbations</code></b>
              (<code><span title="int">int</span></code>, default:
                  <code>1</code>
)
          –
          <div class="doc-md-description">
            <p>Number of perturbations to be used for nls. Defaults to 5.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>local_search_params</code></b>
              (<code><span title="dict">dict</span></code>, default:
                  <code>{}</code>
)
          –
          <div class="doc-md-description">
            <p>Arguments to be passed to the local_search.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>perturbation_params</code></b>
              (<code><span title="dict">dict</span></code>, default:
                  <code>{}</code>
)
          –
          <div class="doc-md-description">
            <p>Arguments to be passed to the perturbation used for nls.</p>
          </div>
        </li>
    </ul>












<p><span class="doc-section-title">Methods:</span></p>
    <ul>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" href="#models.zoo.deepaco.antsystem.AntSystem.run">run</a></code></b>
            –
            <div class="doc-md-description">
              <p>Run the Ant System algorithm for a specified number of iterations.</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" href="#models.zoo.deepaco.antsystem.AntSystem.local_search">local_search</a></code></b>
            –
            <div class="doc-md-description">
              <p>Perform local search on the actions and reward obtained.</p>
            </div>
          </li>
    </ul>



                  <details class="mkdocstrings-source">
                    <summary>Source code in <code>rl4co/models/zoo/deepaco/antsystem.py</code></summary>
                    <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">log_heuristic</span><span class="p">:</span> <span class="n">Tensor</span><span class="p">,</span>
    <span class="n">n_ants</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span>
    <span class="n">alpha</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
    <span class="n">beta</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
    <span class="n">decay</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.95</span><span class="p">,</span>
    <span class="n">Q</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">pheromone</span><span class="p">:</span> <span class="n">Tensor</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">use_local_search</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">use_nls</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">n_perturbations</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">local_search_params</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{},</span>
    <span class="n">perturbation_params</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{},</span>
<span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">batch_size</span> <span class="o">=</span> <span class="n">log_heuristic</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">n_ants</span> <span class="o">=</span> <span class="n">n_ants</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">alpha</span> <span class="o">=</span> <span class="n">alpha</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">beta</span> <span class="o">=</span> <span class="n">beta</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">decay</span> <span class="o">=</span> <span class="n">decay</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">Q</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_ants</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">decay</span> <span class="k">if</span> <span class="n">Q</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">Q</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">log_heuristic</span> <span class="o">=</span> <span class="n">log_heuristic</span>

    <span class="k">if</span> <span class="n">pheromone</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">pheromone</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pheromone</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">log_heuristic</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pheromone</span><span class="o">.</span><span class="n">fill_</span><span class="p">(</span><span class="n">pheromone</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">pheromone</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="k">else</span> <span class="mi">1</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">assert</span> <span class="n">pheromone</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="n">log_heuristic</span><span class="o">.</span><span class="n">shape</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pheromone</span> <span class="o">=</span> <span class="n">pheromone</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">final_actions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">final_reward</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">final_reward_cache</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">use_local_search</span> <span class="o">=</span> <span class="n">use_local_search</span>
    <span class="k">assert</span> <span class="ow">not</span> <span class="p">(</span><span class="n">use_nls</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">use_local_search</span><span class="p">),</span> <span class="s2">&quot;use_nls requires use_local_search&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">use_nls</span> <span class="o">=</span> <span class="n">use_nls</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">n_perturbations</span> <span class="o">=</span> <span class="n">n_perturbations</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">local_search_params</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">local_search_params</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="p">)</span>  <span class="c1"># needs to be copied to avoid side effects</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">perturbation_params</span> <span class="o">=</span> <span class="n">perturbation_params</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_batchindex</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">batch_size</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">log_heuristic</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
                  </details>



<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h3 id="models.zoo.deepaco.antsystem.AntSystem.run" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">run</span>


<a href="#models.zoo.deepaco.antsystem.AntSystem.run" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span class="nf">run</span><span class="p">(</span>
    <span class="n">td_initial</span><span class="p">:</span> <span class="n"><span title="tensordict.TensorDict">TensorDict</span></span><span class="p">,</span>
    <span class="n">env</span><span class="p">:</span> <span class="n"><span title="rl4co.envs.RL4COEnvBase">RL4COEnvBase</span></span><span class="p">,</span>
    <span class="n">n_iterations</span><span class="p">:</span> <span class="n"><span title="int">int</span></span><span class="p">,</span>
    <span class="n">decoding_kwargs</span><span class="p">:</span> <span class="n"><span title="dict">dict</span></span><span class="p">,</span>
    <span class="n">disable_tqdm</span><span class="p">:</span> <span class="n"><span title="bool">bool</span></span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="tuple">tuple</span></span><span class="p">[</span><span class="n"><span title="torch.Tensor">Tensor</span></span><span class="p">,</span> <span class="n"><span title="dict">dict</span></span><span class="p">[</span><span class="n"><span title="int">int</span></span><span class="p">,</span> <span class="n"><span title="torch.Tensor">Tensor</span></span><span class="p">]]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Run the Ant System algorithm for a specified number of iterations.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>td_initial</code></b>
              (<code><span title="tensordict.TensorDict">TensorDict</span></code>)
          –
          <div class="doc-md-description">
            <p>Initial state of the problem.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>env</code></b>
              (<code><span title="rl4co.envs.RL4COEnvBase">RL4COEnvBase</span></code>)
          –
          <div class="doc-md-description">
            <p>Environment representing the problem.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>n_iterations</code></b>
              (<code><span title="int">int</span></code>)
          –
          <div class="doc-md-description">
            <p>Number of iterations to run the algorithm.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>decoding_kwargs</code></b>
              (<code><span title="dict">dict</span></code>)
          –
          <div class="doc-md-description">
            <p>Keyword arguments for decoding strategy.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>disable_tqdm</code></b>
              (<code><span title="bool">bool</span></code>, default:
                  <code>True</code>
)
          –
          <div class="doc-md-description">
            <p>Whether to disable the tqdm progress bar. Defaults to False.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<b><code>td</code></b> (              <code><span title="torch.Tensor">Tensor</span></code>
)          –
          <div class="doc-md-description">
            <p>The final state of the problem.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
<b><code>actions</code></b> (              <code><span title="dict">dict</span>[<span title="int">int</span>, <span title="torch.Tensor">Tensor</span>]</code>
)          –
          <div class="doc-md-description">
            <p>The final actions chosen by the algorithm.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
<b><code>reward</code></b> (              <code><span title="tuple">tuple</span>[<span title="torch.Tensor">Tensor</span>, <span title="dict">dict</span>[<span title="int">int</span>, <span title="torch.Tensor">Tensor</span>]]</code>
)          –
          <div class="doc-md-description">
            <p>The final reward achieved by the algorithm.</p>
          </div>
        </li>
    </ul>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>rl4co/models/zoo/deepaco/antsystem.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">run</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">td_initial</span><span class="p">:</span> <span class="n">TensorDict</span><span class="p">,</span>
    <span class="n">env</span><span class="p">:</span> <span class="n">RL4COEnvBase</span><span class="p">,</span>
    <span class="n">n_iterations</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">decoding_kwargs</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
    <span class="n">disable_tqdm</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">Tensor</span><span class="p">,</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">Tensor</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Run the Ant System algorithm for a specified number of iterations.</span>

<span class="sd">    Args:</span>
<span class="sd">        td_initial: Initial state of the problem.</span>
<span class="sd">        env: Environment representing the problem.</span>
<span class="sd">        n_iterations: Number of iterations to run the algorithm.</span>
<span class="sd">        decoding_kwargs: Keyword arguments for decoding strategy.</span>
<span class="sd">        disable_tqdm: Whether to disable the tqdm progress bar. Defaults to False.</span>

<span class="sd">    Returns:</span>
<span class="sd">        td: The final state of the problem.</span>
<span class="sd">        actions: The final actions chosen by the algorithm.</span>
<span class="sd">        reward: The final reward achieved by the algorithm.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">pbar</span> <span class="o">=</span> <span class="n">trange</span><span class="p">(</span><span class="n">n_iterations</span><span class="p">,</span> <span class="n">dynamic_ncols</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="s2">&quot;Running ACO&quot;</span><span class="p">,</span> <span class="n">disable</span><span class="o">=</span><span class="n">disable_tqdm</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">pbar</span><span class="p">:</span>
        <span class="c1"># reset environment</span>
        <span class="n">td</span> <span class="o">=</span> <span class="n">td_initial</span><span class="o">.</span><span class="n">clone</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_one_step</span><span class="p">(</span><span class="n">td</span><span class="p">,</span> <span class="n">env</span><span class="p">,</span> <span class="n">decoding_kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">final_reward_cache</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">final_reward</span><span class="o">.</span><span class="n">clone</span><span class="p">()</span>  <span class="c1"># type: ignore</span>
        <span class="n">pbar</span><span class="o">.</span><span class="n">set_postfix</span><span class="p">({</span><span class="s2">&quot;reward&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">final_reward</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">item</span><span class="p">()</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">})</span>  <span class="c1"># type: ignore</span>

    <span class="n">action_matrix</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_convert_final_action_to_matrix</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">action_matrix</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">final_reward_cache</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="models.zoo.deepaco.antsystem.AntSystem.local_search" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">local_search</span>


<a href="#models.zoo.deepaco.antsystem.AntSystem.local_search" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span class="nf">local_search</span><span class="p">(</span>
    <span class="n">td</span><span class="p">:</span> <span class="n"><span title="tensordict.TensorDict">TensorDict</span></span><span class="p">,</span>
    <span class="n">env</span><span class="p">:</span> <span class="n"><span title="rl4co.envs.RL4COEnvBase">RL4COEnvBase</span></span><span class="p">,</span>
    <span class="n">actions</span><span class="p">:</span> <span class="n"><span title="torch.Tensor">Tensor</span></span><span class="p">,</span>
    <span class="n">decoding_kwargs</span><span class="p">:</span> <span class="n"><span title="dict">dict</span></span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="tuple">tuple</span></span><span class="p">[</span><span class="n"><span title="torch.Tensor">Tensor</span></span><span class="p">,</span> <span class="n"><span title="torch.Tensor">Tensor</span></span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Perform local search on the actions and reward obtained.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>td</code></b>
              (<code><span title="tensordict.TensorDict">TensorDict</span></code>)
          –
          <div class="doc-md-description">
            <p>Current state of the problem.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>env</code></b>
              (<code><span title="rl4co.envs.RL4COEnvBase">RL4COEnvBase</span></code>)
          –
          <div class="doc-md-description">
            <p>Environment representing the problem.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>actions</code></b>
              (<code><span title="torch.Tensor">Tensor</span></code>)
          –
          <div class="doc-md-description">
            <p>Actions chosen by the algorithm.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<b><code>actions</code></b> (              <code><span title="torch.Tensor">Tensor</span></code>
)          –
          <div class="doc-md-description">
            <p>The modified actions</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
<b><code>reward</code></b> (              <code><span title="torch.Tensor">Tensor</span></code>
)          –
          <div class="doc-md-description">
            <p>The modified reward</p>
          </div>
        </li>
    </ul>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>rl4co/models/zoo/deepaco/antsystem.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">local_search</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">td</span><span class="p">:</span> <span class="n">TensorDict</span><span class="p">,</span> <span class="n">env</span><span class="p">:</span> <span class="n">RL4COEnvBase</span><span class="p">,</span> <span class="n">actions</span><span class="p">:</span> <span class="n">Tensor</span><span class="p">,</span> <span class="n">decoding_kwargs</span><span class="p">:</span> <span class="nb">dict</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">Tensor</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Perform local search on the actions and reward obtained.</span>

<span class="sd">    Args:</span>
<span class="sd">        td: Current state of the problem.</span>
<span class="sd">        env: Environment representing the problem.</span>
<span class="sd">        actions: Actions chosen by the algorithm.</span>

<span class="sd">    Returns:</span>
<span class="sd">        actions: The modified actions</span>
<span class="sd">        reward: The modified reward</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">device</span> <span class="o">=</span> <span class="n">td</span><span class="o">.</span><span class="n">device</span>
    <span class="k">if</span> <span class="n">env</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;tsp&quot;</span><span class="p">,</span> <span class="s2">&quot;cvrp&quot;</span><span class="p">]:</span>
        <span class="c1"># Convert to CPU in advance to minimize the overhead from device transfer</span>
        <span class="n">td</span> <span class="o">=</span> <span class="n">td</span><span class="o">.</span><span class="n">detach</span><span class="p">()</span><span class="o">.</span><span class="n">cpu</span><span class="p">()</span>
        <span class="c1"># TODO: avoid or generalize this, e.g., pre-compute for local search in each env</span>
        <span class="n">td</span><span class="p">[</span><span class="s2">&quot;distances&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">get_distance_matrix</span><span class="p">(</span><span class="n">td</span><span class="p">[</span><span class="s2">&quot;locs&quot;</span><span class="p">])</span>
        <span class="n">actions</span> <span class="o">=</span> <span class="n">actions</span><span class="o">.</span><span class="n">detach</span><span class="p">()</span><span class="o">.</span><span class="n">cpu</span><span class="p">()</span>
    <span class="k">elif</span> <span class="n">env</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;pctsp&quot;</span><span class="p">,</span> <span class="s2">&quot;op&quot;</span><span class="p">]:</span>  <span class="c1"># destroy &amp; repair local search</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">local_search_params</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
            <span class="p">{</span>
                <span class="s2">&quot;decoding_kwargs&quot;</span><span class="p">:</span> <span class="n">decoding_kwargs</span><span class="p">,</span>
                <span class="s2">&quot;heatmap&quot;</span><span class="p">:</span> <span class="n">batchify</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">log_heuristic</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_ants</span><span class="p">),</span>
            <span class="p">}</span>
        <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Local search not implemented for </span><span class="si">{</span><span class="n">env</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="n">best_actions</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">local_search</span><span class="p">(</span><span class="n">td</span><span class="o">=</span><span class="n">td</span><span class="p">,</span> <span class="n">actions</span><span class="o">=</span><span class="n">actions</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">local_search_params</span><span class="p">)</span>
    <span class="n">best_rewards</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">get_reward</span><span class="p">(</span><span class="n">td</span><span class="p">,</span> <span class="n">best_actions</span><span class="p">)</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_nls</span><span class="p">:</span>
        <span class="n">td_perturb</span> <span class="o">=</span> <span class="n">td</span><span class="o">.</span><span class="n">clone</span><span class="p">()</span>
        <span class="n">td_perturb</span><span class="p">[</span><span class="s2">&quot;distances&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">heuristic_dist</span><span class="p">,</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_ants</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
        <span class="n">new_actions</span> <span class="o">=</span> <span class="n">best_actions</span><span class="o">.</span><span class="n">clone</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_perturbations</span><span class="p">):</span>
            <span class="n">perturbed_actions</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">local_search</span><span class="p">(</span>
                <span class="n">td</span><span class="o">=</span><span class="n">td_perturb</span><span class="p">,</span> <span class="n">actions</span><span class="o">=</span><span class="n">new_actions</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">perturbation_params</span>
            <span class="p">)</span>
            <span class="n">new_actions</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">local_search</span><span class="p">(</span>
                <span class="n">td</span><span class="o">=</span><span class="n">td</span><span class="p">,</span> <span class="n">actions</span><span class="o">=</span><span class="n">perturbed_actions</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">local_search_params</span>
            <span class="p">)</span>
            <span class="n">new_rewards</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">get_reward</span><span class="p">(</span><span class="n">td</span><span class="p">,</span> <span class="n">new_actions</span><span class="p">)</span>

            <span class="n">improved_indices</span> <span class="o">=</span> <span class="n">new_rewards</span> <span class="o">&gt;</span> <span class="n">best_rewards</span>
            <span class="n">best_actions</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">replace_selected_actions</span><span class="p">(</span>
                <span class="n">best_actions</span><span class="p">,</span> <span class="n">new_actions</span><span class="p">,</span> <span class="n">improved_indices</span>
            <span class="p">)</span>
            <span class="n">best_rewards</span><span class="p">[</span><span class="n">improved_indices</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_rewards</span><span class="p">[</span><span class="n">improved_indices</span><span class="p">]</span>

    <span class="n">best_actions</span> <span class="o">=</span> <span class="n">best_actions</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
    <span class="n">best_rewards</span> <span class="o">=</span> <span class="n">best_rewards</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">best_actions</span><span class="p">,</span> <span class="n">best_rewards</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>

<div class="doc doc-object doc-module">




    <div class="doc doc-contents first">










<p><span class="doc-section-title">Classes:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          <b><code><a class="autorefs autorefs-internal" href="#models.zoo.deepaco.model.DeepACO">DeepACO</a></code></b>
          –
          <div class="doc-md-description">
            <p>Implements DeepACO: <a href="https://arxiv.org/abs/2309.14032">https://arxiv.org/abs/2309.14032</a>.</p>
          </div>
        </li>
    </ul>







<div class="doc doc-children">









<div class="doc doc-object doc-class">



<h2 id="models.zoo.deepaco.model.DeepACO" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">DeepACO</span>


<a href="#models.zoo.deepaco.model.DeepACO" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="language-python doc-signature highlight"><pre><span></span><code><span class="nf">DeepACO</span><span class="p">(</span>
    <span class="n">env</span><span class="p">:</span> <span class="n"><span title="rl4co.envs.common.base.RL4COEnvBase">RL4COEnvBase</span></span><span class="p">,</span>
    <span class="n">policy</span><span class="p">:</span> <span class="n"><span title="rl4co.models.zoo.deepaco.policy.DeepACOPolicy">DeepACOPolicy</span></span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">baseline</span><span class="p">:</span> <span class="n"><span title="rl4co.models.rl.reinforce.baselines.REINFORCEBaseline">REINFORCEBaseline</span></span> <span class="o">|</span> <span class="n"><span title="str">str</span></span> <span class="o">=</span> <span class="s2">&quot;no&quot;</span><span class="p">,</span>
    <span class="n">train_with_local_search</span><span class="p">:</span> <span class="n"><span title="bool">bool</span></span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">ls_reward_aug_W</span><span class="p">:</span> <span class="n"><span title="float">float</span></span> <span class="o">=</span> <span class="mf">0.95</span><span class="p">,</span>
    <span class="n">policy_kwargs</span><span class="p">:</span> <span class="n"><span title="dict">dict</span></span> <span class="o">=</span> <span class="p">{},</span>
    <span class="n">baseline_kwargs</span><span class="p">:</span> <span class="n"><span title="dict">dict</span></span> <span class="o">=</span> <span class="p">{},</span>
    <span class="o">**</span><span class="n">kwargs</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="rl4co.models.rl.REINFORCE">REINFORCE</span></code></p>



        <p>Implements DeepACO: <a href="https://arxiv.org/abs/2309.14032">https://arxiv.org/abs/2309.14032</a>.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>env</code></b>
              (<code><span title="rl4co.envs.common.base.RL4COEnvBase">RL4COEnvBase</span></code>)
          –
          <div class="doc-md-description">
            <p>Environment to use for the algorithm</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>policy</code></b>
              (<code><span title="rl4co.models.zoo.deepaco.policy.DeepACOPolicy">DeepACOPolicy</span> | None</code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>Policy to use for the algorithm</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>baseline</code></b>
              (<code><span title="rl4co.models.rl.reinforce.baselines.REINFORCEBaseline">REINFORCEBaseline</span> | <span title="str">str</span></code>, default:
                  <code>&#39;no&#39;</code>
)
          –
          <div class="doc-md-description">
            <p>REINFORCE baseline. Defaults to "no" because the shared baseline is manually implemented.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>train_with_local_search</code></b>
              (<code><span title="bool">bool</span></code>, default:
                  <code>True</code>
)
          –
          <div class="doc-md-description">
            <p>Whether to train with local search. Defaults to False.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>ls_reward_aug_W</code></b>
              (<code><span title="float">float</span></code>, default:
                  <code>0.95</code>
)
          –
          <div class="doc-md-description">
            <p>Coefficient to be used for the reward augmentation with the local search. Defaults to 0.95.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>policy_kwargs</code></b>
              (<code><span title="dict">dict</span></code>, default:
                  <code>{}</code>
)
          –
          <div class="doc-md-description">
            <p>Keyword arguments for policy</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>baseline_kwargs</code></b>
              (<code><span title="dict">dict</span></code>, default:
                  <code>{}</code>
)
          –
          <div class="doc-md-description">
            <p>Keyword arguments for baseline</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>**kwargs</code></b>
          –
          <div class="doc-md-description">
            <p>Keyword arguments passed to the superclass</p>
          </div>
        </li>
    </ul>












<p><span class="doc-section-title">Methods:</span></p>
    <ul>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" href="#models.zoo.deepaco.model.DeepACO.calculate_loss">calculate_loss</a></code></b>
            –
            <div class="doc-md-description">
              <p>Calculate loss for REINFORCE algorithm.</p>
            </div>
          </li>
    </ul>



                  <details class="mkdocstrings-source">
                    <summary>Source code in <code>rl4co/models/zoo/deepaco/model.py</code></summary>
                    <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">env</span><span class="p">:</span> <span class="n">RL4COEnvBase</span><span class="p">,</span>
    <span class="n">policy</span><span class="p">:</span> <span class="n">DeepACOPolicy</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">baseline</span><span class="p">:</span> <span class="n">REINFORCEBaseline</span> <span class="o">|</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;no&quot;</span><span class="p">,</span>  <span class="c1"># Shared baseline is manually implemented</span>
    <span class="n">train_with_local_search</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">ls_reward_aug_W</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.95</span><span class="p">,</span>
    <span class="n">policy_kwargs</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{},</span>
    <span class="n">baseline_kwargs</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{},</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="p">):</span>
    <span class="k">if</span> <span class="n">policy</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">policy</span> <span class="o">=</span> <span class="n">DeepACOPolicy</span><span class="p">(</span>
            <span class="n">env_name</span><span class="o">=</span><span class="n">env</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">train_with_local_search</span><span class="o">=</span><span class="n">train_with_local_search</span><span class="p">,</span> <span class="o">**</span><span class="n">policy_kwargs</span>
        <span class="p">)</span>

    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">env</span><span class="p">,</span> <span class="n">policy</span><span class="p">,</span> <span class="n">baseline</span><span class="p">,</span> <span class="n">baseline_kwargs</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">train_with_local_search</span> <span class="o">=</span> <span class="n">train_with_local_search</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">ls_reward_aug_W</span> <span class="o">=</span> <span class="n">ls_reward_aug_W</span>
</code></pre></div></td></tr></table></div>
                  </details>



<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h3 id="models.zoo.deepaco.model.DeepACO.calculate_loss" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">calculate_loss</span>


<a href="#models.zoo.deepaco.model.DeepACO.calculate_loss" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span class="nf">calculate_loss</span><span class="p">(</span>
    <span class="n">td</span><span class="p">:</span> <span class="n"><span title="tensordict.TensorDict">TensorDict</span></span><span class="p">,</span>
    <span class="n">batch</span><span class="p">:</span> <span class="n"><span title="tensordict.TensorDict">TensorDict</span></span><span class="p">,</span>
    <span class="n">policy_out</span><span class="p">:</span> <span class="n"><span title="dict">dict</span></span><span class="p">,</span>
    <span class="n">reward</span><span class="p">:</span> <span class="n"><span title="torch.Tensor">Tensor</span></span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">log_likelihood</span><span class="p">:</span> <span class="n"><span title="torch.Tensor">Tensor</span></span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Calculate loss for REINFORCE algorithm.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>td</code></b>
              (<code><span title="tensordict.TensorDict">TensorDict</span></code>)
          –
          <div class="doc-md-description">
            <p>TensorDict containing the current state of the environment</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>batch</code></b>
              (<code><span title="tensordict.TensorDict">TensorDict</span></code>)
          –
          <div class="doc-md-description">
            <p>Batch of data. This is used to get the extra loss terms, e.g., REINFORCE baseline</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>policy_out</code></b>
              (<code><span title="dict">dict</span></code>)
          –
          <div class="doc-md-description">
            <p>Output of the policy network</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>reward</code></b>
              (<code><span title="torch.Tensor">Tensor</span> | None</code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>Reward tensor. If None, it is taken from <code>policy_out</code></p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>log_likelihood</code></b>
              (<code><span title="torch.Tensor">Tensor</span> | None</code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>Log-likelihood tensor. If None, it is taken from <code>policy_out</code></p>
          </div>
        </li>
    </ul>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>rl4co/models/zoo/deepaco/model.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">calculate_loss</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">td</span><span class="p">:</span> <span class="n">TensorDict</span><span class="p">,</span>
    <span class="n">batch</span><span class="p">:</span> <span class="n">TensorDict</span><span class="p">,</span>
    <span class="n">policy_out</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
    <span class="n">reward</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">log_likelihood</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Calculate loss for REINFORCE algorithm.</span>

<span class="sd">    Args:</span>
<span class="sd">        td: TensorDict containing the current state of the environment</span>
<span class="sd">        batch: Batch of data. This is used to get the extra loss terms, e.g., REINFORCE baseline</span>
<span class="sd">        policy_out: Output of the policy network</span>
<span class="sd">        reward: Reward tensor. If None, it is taken from `policy_out`</span>
<span class="sd">        log_likelihood: Log-likelihood tensor. If None, it is taken from `policy_out`</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">reward</span> <span class="o">=</span> <span class="n">policy_out</span><span class="p">[</span><span class="s2">&quot;reward&quot;</span><span class="p">]</span>
    <span class="n">advantage</span> <span class="o">=</span> <span class="n">reward</span> <span class="o">-</span> <span class="n">reward</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">keepdim</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># Shared baseline</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">train_with_local_search</span><span class="p">:</span>
        <span class="n">ls_reward</span> <span class="o">=</span> <span class="n">policy_out</span><span class="p">[</span><span class="s2">&quot;ls_reward&quot;</span><span class="p">]</span>
        <span class="n">ls_advantage</span> <span class="o">=</span> <span class="n">ls_reward</span> <span class="o">-</span> <span class="n">ls_reward</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">keepdim</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># Shared baseline</span>
        <span class="n">weighted_advantage</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">advantage</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">ls_reward_aug_W</span><span class="p">)</span> <span class="o">+</span> <span class="n">ls_advantage</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">ls_reward_aug_W</span>
        <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">weighted_advantage</span> <span class="o">=</span> <span class="n">advantage</span>

    <span class="k">return</span> <span class="o">-</span><span class="p">(</span><span class="n">weighted_advantage</span> <span class="o">*</span> <span class="n">policy_out</span><span class="p">[</span><span class="s2">&quot;log_likelihood&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>

<div class="doc doc-object doc-module">




    <div class="doc doc-contents first">










<p><span class="doc-section-title">Classes:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          <b><code><a class="autorefs autorefs-internal" href="#models.zoo.deepaco.policy.DeepACOPolicy">DeepACOPolicy</a></code></b>
          –
          <div class="doc-md-description">
            <p>Implememts DeepACO policy based on :class:<code>NonAutoregressivePolicy</code>. Introduced by Ye et al. (2023): <a href="https://arxiv.org/abs/2309.14032">https://arxiv.org/abs/2309.14032</a>.</p>
          </div>
        </li>
    </ul>







<div class="doc doc-children">









<div class="doc doc-object doc-class">



<h2 id="models.zoo.deepaco.policy.DeepACOPolicy" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">DeepACOPolicy</span>


<a href="#models.zoo.deepaco.policy.DeepACOPolicy" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="language-python doc-signature highlight"><pre><span></span><code><span class="nf">DeepACOPolicy</span><span class="p">(</span>
    <span class="n">encoder</span><span class="p">:</span> <span class="n"><span title="rl4co.models.common.constructive.nonautoregressive.NonAutoregressiveEncoder">NonAutoregressiveEncoder</span></span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">env_name</span><span class="p">:</span> <span class="n"><span title="str">str</span></span> <span class="o">=</span> <span class="s2">&quot;tsp&quot;</span><span class="p">,</span>
    <span class="n">temperature</span><span class="p">:</span> <span class="n"><span title="float">float</span></span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
    <span class="n">top_p</span><span class="p">:</span> <span class="n"><span title="float">float</span></span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span>
    <span class="n">top_k</span><span class="p">:</span> <span class="n"><span title="int">int</span></span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="n">aco_class</span><span class="p">:</span> <span class="n"><span title="type">type</span></span><span class="p">[</span><span class="n"><span title="rl4co.models.zoo.deepaco.antsystem.AntSystem">AntSystem</span></span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">aco_kwargs</span><span class="p">:</span> <span class="n"><span title="dict">dict</span></span> <span class="o">=</span> <span class="p">{},</span>
    <span class="n">train_with_local_search</span><span class="p">:</span> <span class="n"><span title="bool">bool</span></span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">n_ants</span><span class="p">:</span> <span class="n"><span title="int">int</span></span> <span class="o">|</span> <span class="n"><span title="dict">dict</span></span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">n_iterations</span><span class="p">:</span> <span class="n"><span title="int">int</span></span> <span class="o">|</span> <span class="n"><span title="dict">dict</span></span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">start_node</span><span class="p">:</span> <span class="n"><span title="int">int</span></span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">multistart</span><span class="p">:</span> <span class="n"><span title="bool">bool</span></span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">k_sparse</span><span class="p">:</span> <span class="n"><span title="int">int</span></span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">**</span><span class="n">encoder_kwargs</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="rl4co.models.common.constructive.nonautoregressive.NonAutoregressivePolicy">NonAutoregressivePolicy</span></code></p>



        <p>Implememts DeepACO policy based on :class:<code>NonAutoregressivePolicy</code>. Introduced by Ye et al. (2023): <a href="https://arxiv.org/abs/2309.14032">https://arxiv.org/abs/2309.14032</a>.
This policy uses a Non-Autoregressive Graph Neural Network to generate heatmaps,
which are then used to run Ant Colony Optimization (ACO) to construct solutions.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>encoder</code></b>
              (<code><span title="rl4co.models.common.constructive.nonautoregressive.NonAutoregressiveEncoder">NonAutoregressiveEncoder</span> | None</code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>Encoder module. Can be passed by sub-classes</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>env_name</code></b>
              (<code><span title="str">str</span></code>, default:
                  <code>&#39;tsp&#39;</code>
)
          –
          <div class="doc-md-description">
            <p>Name of the environment used to initialize embeddings</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>temperature</code></b>
              (<code><span title="float">float</span></code>, default:
                  <code>1.0</code>
)
          –
          <div class="doc-md-description">
            <p>Temperature for the softmax during decoding. Defaults to 1.0.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>aco_class</code></b>
              (<code><span title="type">type</span>[<span title="rl4co.models.zoo.deepaco.antsystem.AntSystem">AntSystem</span>] | None</code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>Class representing the ACO algorithm to be used. Defaults to :class:<code>AntSystem</code>.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>aco_kwargs</code></b>
              (<code><span title="dict">dict</span></code>, default:
                  <code>{}</code>
)
          –
          <div class="doc-md-description">
            <p>Additional arguments to be passed to the ACO algorithm.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>train_with_local_search</code></b>
              (<code><span title="bool">bool</span></code>, default:
                  <code>False</code>
)
          –
          <div class="doc-md-description">
            <p>Whether to train with local search. Defaults to False.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>n_ants</code></b>
              (<code><span title="int">int</span> | <span title="dict">dict</span> | None</code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>Number of ants to be used in the ACO algorithm. Can be an integer or dictionary. Defaults to 20.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>n_iterations</code></b>
              (<code><span title="int">int</span> | <span title="dict">dict</span> | None</code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>Number of iterations to run the ACO algorithm. Can be an integer or dictionary. Defaults to <code>dict(train=1, val=20, test=100)</code>.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>encoder_kwargs</code></b>
          –
          <div class="doc-md-description">
            <p>Additional arguments to be passed to the encoder.</p>
          </div>
        </li>
    </ul>












<p><span class="doc-section-title">Methods:</span></p>
    <ul>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" href="#models.zoo.deepaco.policy.DeepACOPolicy.forward">forward</a></code></b>
            –
            <div class="doc-md-description">
              <p>Forward method. During validation and testing, the policy runs the ACO algorithm to construct solutions.</p>
            </div>
          </li>
    </ul>



                  <details class="mkdocstrings-source">
                    <summary>Source code in <code>rl4co/models/zoo/deepaco/policy.py</code></summary>
                    <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span>
<span class="normal">93</span>
<span class="normal">94</span>
<span class="normal">95</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">encoder</span><span class="p">:</span> <span class="n">NonAutoregressiveEncoder</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">env_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;tsp&quot;</span><span class="p">,</span>
    <span class="n">temperature</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
    <span class="n">top_p</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span>
    <span class="n">top_k</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="n">aco_class</span><span class="p">:</span> <span class="nb">type</span><span class="p">[</span><span class="n">AntSystem</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">aco_kwargs</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{},</span>
    <span class="n">train_with_local_search</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">n_ants</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">n_iterations</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">start_node</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">multistart</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">k_sparse</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">**</span><span class="n">encoder_kwargs</span><span class="p">,</span>
<span class="p">):</span>
    <span class="k">if</span> <span class="n">encoder</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">encoder_kwargs</span><span class="p">[</span><span class="s2">&quot;k_sparse&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">k_sparse</span>
        <span class="n">encoder</span> <span class="o">=</span> <span class="n">NARGNNEncoder</span><span class="p">(</span><span class="n">env_name</span><span class="o">=</span><span class="n">env_name</span><span class="p">,</span> <span class="o">**</span><span class="n">encoder_kwargs</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">decode_type</span> <span class="o">=</span> <span class="s2">&quot;multistart_sampling&quot;</span> <span class="k">if</span> <span class="n">env_name</span> <span class="o">==</span> <span class="s2">&quot;tsp&quot;</span> <span class="ow">or</span> <span class="n">multistart</span> <span class="k">else</span> <span class="s2">&quot;sampling&quot;</span>

    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
        <span class="n">encoder</span><span class="o">=</span><span class="n">encoder</span><span class="p">,</span>
        <span class="n">env_name</span><span class="o">=</span><span class="n">env_name</span><span class="p">,</span>
        <span class="n">temperature</span><span class="o">=</span><span class="n">temperature</span><span class="p">,</span>
        <span class="n">train_decode_type</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">decode_type</span><span class="p">,</span>
        <span class="n">val_decode_type</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">decode_type</span><span class="p">,</span>
        <span class="n">test_decode_type</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">decode_type</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">default_decoding_kwargs</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">default_decoding_kwargs</span><span class="p">[</span><span class="s2">&quot;select_best&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">if</span> <span class="n">k_sparse</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">default_decoding_kwargs</span><span class="p">[</span><span class="s2">&quot;top_k&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">k_sparse</span> <span class="o">+</span> <span class="p">(</span>
            <span class="mi">0</span> <span class="k">if</span> <span class="n">env_name</span> <span class="o">==</span> <span class="s2">&quot;tsp&quot;</span> <span class="k">else</span> <span class="mi">1</span>
        <span class="p">)</span>  <span class="c1"># 1 for depot</span>
    <span class="k">if</span> <span class="s2">&quot;multistart&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">decode_type</span><span class="p">:</span>
        <span class="n">select_start_nodes_fn</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">select_start_node_fn</span><span class="p">,</span> <span class="n">start_node</span><span class="o">=</span><span class="n">start_node</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">default_decoding_kwargs</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
            <span class="p">{</span><span class="s2">&quot;multistart&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s2">&quot;select_start_nodes_fn&quot;</span><span class="p">:</span> <span class="n">select_start_nodes_fn</span><span class="p">}</span>
        <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">default_decoding_kwargs</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;multisample&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>

    <span class="c1"># For now, top_p and top_k are only used to filter logits (not passed to decoder)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">top_p</span> <span class="o">=</span> <span class="n">top_p</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">top_k</span> <span class="o">=</span> <span class="n">top_k</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">aco_class</span> <span class="o">=</span> <span class="n">AntSystem</span> <span class="k">if</span> <span class="n">aco_class</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">aco_class</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">aco_kwargs</span> <span class="o">=</span> <span class="n">aco_kwargs</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">train_with_local_search</span> <span class="o">=</span> <span class="n">train_with_local_search</span>
    <span class="k">if</span> <span class="n">train_with_local_search</span><span class="p">:</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">aco_kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;use_local_search&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">n_ants</span> <span class="o">=</span> <span class="n">merge_with_defaults</span><span class="p">(</span><span class="n">n_ants</span><span class="p">,</span> <span class="n">train</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">val</span><span class="o">=</span><span class="mi">48</span><span class="p">,</span> <span class="n">test</span><span class="o">=</span><span class="mi">48</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">n_iterations</span> <span class="o">=</span> <span class="n">merge_with_defaults</span><span class="p">(</span><span class="n">n_iterations</span><span class="p">,</span> <span class="n">train</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">val</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">test</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
                  </details>



<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h3 id="models.zoo.deepaco.policy.DeepACOPolicy.forward" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">forward</span>


<a href="#models.zoo.deepaco.policy.DeepACOPolicy.forward" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span class="nf">forward</span><span class="p">(</span>
    <span class="n">td_initial</span><span class="p">:</span> <span class="n"><span title="tensordict.TensorDict">TensorDict</span></span><span class="p">,</span>
    <span class="n">env</span><span class="p">:</span> <span class="n"><span title="str">str</span></span> <span class="o">|</span> <span class="n"><span title="rl4co.envs.RL4COEnvBase">RL4COEnvBase</span></span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">phase</span><span class="p">:</span> <span class="n"><span title="str">str</span></span> <span class="o">=</span> <span class="s2">&quot;train&quot;</span><span class="p">,</span>
    <span class="n">return_actions</span><span class="p">:</span> <span class="n"><span title="bool">bool</span></span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">return_hidden</span><span class="p">:</span> <span class="n"><span title="bool">bool</span></span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">actions</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="o">**</span><span class="n">decoding_kwargs</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Forward method. During validation and testing, the policy runs the ACO algorithm to construct solutions.
See :class:<code>NonAutoregressivePolicy</code> for more details during the training phase.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>rl4co/models/zoo/deepaco/policy.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">forward</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">td_initial</span><span class="p">:</span> <span class="n">TensorDict</span><span class="p">,</span>
    <span class="n">env</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">RL4COEnvBase</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">phase</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;train&quot;</span><span class="p">,</span>
    <span class="n">return_actions</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">return_hidden</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">actions</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="o">**</span><span class="n">decoding_kwargs</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Forward method. During validation and testing, the policy runs the ACO algorithm to construct solutions.</span>
<span class="sd">    See :class:`NonAutoregressivePolicy` for more details during the training phase.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">n_ants</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_ants</span><span class="p">[</span><span class="n">phase</span><span class="p">]</span>

    <span class="n">decoding_kwargs</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">default_decoding_kwargs</span><span class="p">)</span>
    <span class="n">decoding_kwargs</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
        <span class="p">{</span><span class="s2">&quot;num_starts&quot;</span><span class="p">:</span> <span class="n">n_ants</span><span class="p">}</span> <span class="k">if</span> <span class="s2">&quot;multistart&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">decode_type</span> <span class="k">else</span> <span class="p">{</span><span class="s2">&quot;num_samples&quot;</span><span class="p">:</span> <span class="n">n_ants</span><span class="p">}</span>
    <span class="p">)</span>

    <span class="c1"># Instantiate environment if needed</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">phase</span> <span class="o">!=</span> <span class="s2">&quot;train&quot;</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">train_with_local_search</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span>
        <span class="n">env</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">env</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span>
    <span class="p">):</span>
        <span class="n">env_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">env_name</span> <span class="k">if</span> <span class="n">env</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">env</span>
        <span class="n">env</span> <span class="o">=</span> <span class="n">get_env</span><span class="p">(</span><span class="n">env_name</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">env</span><span class="p">,</span> <span class="n">RL4COEnvBase</span><span class="p">),</span> <span class="s2">&quot;env must be an instance of RL4COEnvBase&quot;</span>

    <span class="k">if</span> <span class="n">phase</span> <span class="o">==</span> <span class="s2">&quot;train&quot;</span><span class="p">:</span>
        <span class="c1">#  we just use the constructive policy</span>
        <span class="n">outdict</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">forward</span><span class="p">(</span>
            <span class="n">td_initial</span><span class="p">,</span>
            <span class="n">env</span><span class="p">,</span>
            <span class="n">phase</span><span class="o">=</span><span class="n">phase</span><span class="p">,</span>
            <span class="n">calc_reward</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">return_actions</span><span class="o">=</span><span class="n">return_actions</span><span class="p">,</span>
            <span class="n">return_hidden</span><span class="o">=</span><span class="n">return_hidden</span><span class="p">,</span>
            <span class="n">actions</span><span class="o">=</span><span class="n">actions</span><span class="p">,</span>
            <span class="o">**</span><span class="n">decoding_kwargs</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="n">outdict</span><span class="p">[</span><span class="s2">&quot;reward&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">unbatchify</span><span class="p">(</span><span class="n">outdict</span><span class="p">[</span><span class="s2">&quot;reward&quot;</span><span class="p">],</span> <span class="n">n_ants</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">train_with_local_search</span><span class="p">:</span>
            <span class="n">heatmap</span> <span class="o">=</span> <span class="n">outdict</span><span class="p">[</span><span class="s2">&quot;hidden&quot;</span><span class="p">]</span>
            <span class="c1"># TODO: Refactor this so that we don&#39;t need to use the aco object</span>
            <span class="n">aco</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">aco_class</span><span class="p">(</span><span class="n">heatmap</span><span class="p">,</span> <span class="n">n_ants</span><span class="o">=</span><span class="n">n_ants</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">aco_kwargs</span><span class="p">)</span>
            <span class="n">_</span><span class="p">,</span> <span class="n">ls_reward</span> <span class="o">=</span> <span class="n">aco</span><span class="o">.</span><span class="n">local_search</span><span class="p">(</span>
                <span class="n">batchify</span><span class="p">(</span><span class="n">td_initial</span><span class="p">,</span> <span class="n">n_ants</span><span class="p">),</span> <span class="n">env</span><span class="p">,</span> <span class="n">outdict</span><span class="p">[</span><span class="s2">&quot;actions&quot;</span><span class="p">],</span> <span class="n">decoding_kwargs</span>
            <span class="p">)</span>
            <span class="n">outdict</span><span class="p">[</span><span class="s2">&quot;ls_reward&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">unbatchify</span><span class="p">(</span><span class="n">ls_reward</span><span class="p">,</span> <span class="n">n_ants</span><span class="p">)</span>

        <span class="n">outdict</span><span class="p">[</span><span class="s2">&quot;log_likelihood&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">unbatchify</span><span class="p">(</span><span class="n">outdict</span><span class="p">[</span><span class="s2">&quot;log_likelihood&quot;</span><span class="p">],</span> <span class="n">n_ants</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">outdict</span>

    <span class="n">heatmap</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">encoder</span><span class="p">(</span><span class="n">td_initial</span><span class="p">)</span>
    <span class="n">heatmap</span> <span class="o">/=</span> <span class="bp">self</span><span class="o">.</span><span class="n">temperature</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">top_k</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">top_k</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">top_k</span><span class="p">,</span> <span class="n">heatmap</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>  <span class="c1"># safety check</span>
        <span class="n">heatmap</span> <span class="o">=</span> <span class="n">modify_logits_for_top_k_filtering</span><span class="p">(</span><span class="n">heatmap</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">top_k</span><span class="p">)</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">top_p</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">top_p</span> <span class="o">&lt;=</span> <span class="mf">1.0</span><span class="p">,</span> <span class="s2">&quot;top-p should be in (0, 1].&quot;</span>
        <span class="n">heatmap</span> <span class="o">=</span> <span class="n">modify_logits_for_top_p_filtering</span><span class="p">(</span><span class="n">heatmap</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">top_p</span><span class="p">)</span>

    <span class="n">aco</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">aco_class</span><span class="p">(</span><span class="n">heatmap</span><span class="p">,</span> <span class="n">n_ants</span><span class="o">=</span><span class="n">n_ants</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">aco_kwargs</span><span class="p">)</span>
    <span class="n">actions</span><span class="p">,</span> <span class="n">iter_rewards</span> <span class="o">=</span> <span class="n">aco</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">td_initial</span><span class="p">,</span> <span class="n">env</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_iterations</span><span class="p">[</span><span class="n">phase</span><span class="p">],</span> <span class="n">decoding_kwargs</span><span class="p">)</span>

    <span class="n">out</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;reward&quot;</span><span class="p">:</span> <span class="n">iter_rewards</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">n_iterations</span><span class="p">[</span><span class="n">phase</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]}</span>
    <span class="n">out</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="sa">f</span><span class="s2">&quot;reward_</span><span class="si">{</span><span class="n">i</span><span class="si">:</span><span class="s2">03d</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">:</span> <span class="n">iter_rewards</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_iterations</span><span class="p">[</span><span class="n">phase</span><span class="p">])})</span>
    <span class="k">if</span> <span class="n">return_actions</span><span class="p">:</span>
        <span class="n">out</span><span class="p">[</span><span class="s2">&quot;actions&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">actions</span>

    <span class="k">return</span> <span class="n">out</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div><h2 id="nar-gnn">NAR-GNN<a class="headerlink" href="#nar-gnn" title="Permanent link">&para;</a></h2>


<div class="doc doc-object doc-module">




    <div class="doc doc-contents first">










<p><span class="doc-section-title">Classes:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          <b><code><a class="autorefs autorefs-internal" href="#models.zoo.nargnn.policy.NARGNNPolicy">NARGNNPolicy</a></code></b>
          –
          <div class="doc-md-description">
            <p>Base Non-autoregressive policy for NCO construction methods.</p>
          </div>
        </li>
    </ul>







<div class="doc doc-children">









<div class="doc doc-object doc-class">



<h2 id="models.zoo.nargnn.policy.NARGNNPolicy" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">NARGNNPolicy</span>


<a href="#models.zoo.nargnn.policy.NARGNNPolicy" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="language-python doc-signature highlight"><pre><span></span><code><span class="nf">NARGNNPolicy</span><span class="p">(</span>
    <span class="n">encoder</span><span class="p">:</span> <span class="n"><span title="rl4co.models.common.constructive.nonautoregressive.NonAutoregressiveEncoder">NonAutoregressiveEncoder</span></span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">decoder</span><span class="p">:</span> <span class="n"><span title="rl4co.models.common.constructive.nonautoregressive.NonAutoregressiveDecoder">NonAutoregressiveDecoder</span></span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">embed_dim</span><span class="p">:</span> <span class="n"><span title="int">int</span></span> <span class="o">=</span> <span class="mi">64</span><span class="p">,</span>
    <span class="n">env_name</span><span class="p">:</span> <span class="n"><span title="str">str</span></span> <span class="o">=</span> <span class="s2">&quot;tsp&quot;</span><span class="p">,</span>
    <span class="n">init_embedding</span><span class="p">:</span> <span class="n"><span title="torch.nn.Module">Module</span></span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">edge_embedding</span><span class="p">:</span> <span class="n"><span title="torch.nn.Module">Module</span></span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">graph_network</span><span class="p">:</span> <span class="n"><span title="torch.nn.Module">Module</span></span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">heatmap_generator</span><span class="p">:</span> <span class="n"><span title="torch.nn.Module">Module</span></span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">num_layers_heatmap_generator</span><span class="p">:</span> <span class="n"><span title="int">int</span></span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span>
    <span class="n">num_layers_graph_encoder</span><span class="p">:</span> <span class="n"><span title="int">int</span></span> <span class="o">=</span> <span class="mi">15</span><span class="p">,</span>
    <span class="n">act_fn</span><span class="o">=</span><span class="s2">&quot;silu&quot;</span><span class="p">,</span>
    <span class="n">agg_fn</span><span class="o">=</span><span class="s2">&quot;mean&quot;</span><span class="p">,</span>
    <span class="n">linear_bias</span><span class="p">:</span> <span class="n"><span title="bool">bool</span></span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">train_decode_type</span><span class="p">:</span> <span class="n"><span title="str">str</span></span> <span class="o">=</span> <span class="s2">&quot;multistart_sampling&quot;</span><span class="p">,</span>
    <span class="n">val_decode_type</span><span class="p">:</span> <span class="n"><span title="str">str</span></span> <span class="o">=</span> <span class="s2">&quot;multistart_greedy&quot;</span><span class="p">,</span>
    <span class="n">test_decode_type</span><span class="p">:</span> <span class="n"><span title="str">str</span></span> <span class="o">=</span> <span class="s2">&quot;multistart_greedy&quot;</span><span class="p">,</span>
    <span class="o">**</span><span class="n">constructive_policy_kw</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="rl4co.models.common.constructive.nonautoregressive.NonAutoregressivePolicy">NonAutoregressivePolicy</span></code></p>



        <p>Base Non-autoregressive policy for NCO construction methods.
This creates a heatmap of NxN for N nodes (i.e., heuristic) that models the probability to go from one node to another for all nodes.</p>


<details class="the-policy-performs-the-following-steps" open>
  <summary>The policy performs the following steps</summary>
  <ol>
<li>Encode the environment initial state into node embeddings</li>
<li>Decode (non-autoregressively) to construct the solution to the NCO problem</li>
</ol>
</details>

<details class="warning" open>
  <summary>Warning</summary>
  <p>The effectiveness of the non-autoregressive approach can vary significantly across different problem types and configurations.
It may require careful tuning of the model architecture and decoding strategy to achieve competitive results.</p>
</details>

<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>encoder</code></b>
              (<code><span title="rl4co.models.common.constructive.nonautoregressive.NonAutoregressiveEncoder">NonAutoregressiveEncoder</span> | None</code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>Encoder module. Can be passed by sub-classes</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>decoder</code></b>
              (<code><span title="rl4co.models.common.constructive.nonautoregressive.NonAutoregressiveDecoder">NonAutoregressiveDecoder</span> | None</code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>Decoder module. Note that this moule defaults to the non-autoregressive decoder</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>embed_dim</code></b>
              (<code><span title="int">int</span></code>, default:
                  <code>64</code>
)
          –
          <div class="doc-md-description">
            <p>Dimension of the embeddings</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>env_name</code></b>
              (<code><span title="str">str</span></code>, default:
                  <code>&#39;tsp&#39;</code>
)
          –
          <div class="doc-md-description">
            <p>Name of the environment used to initialize embeddings</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>init_embedding</code></b>
              (<code><span title="torch.nn.Module">Module</span> | None</code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>Model to use for the initial embedding. If None, use the default embedding for the environment</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>edge_embedding</code></b>
              (<code><span title="torch.nn.Module">Module</span> | None</code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>Model to use for the edge embedding. If None, use the default embedding for the environment</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>graph_network</code></b>
              (<code><span title="torch.nn.Module">Module</span> | None</code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>Model to use for the graph network. If None, use the default embedding for the environment</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>heatmap_generator</code></b>
              (<code><span title="torch.nn.Module">Module</span> | None</code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>Model to use for the heatmap generator. If None, use the default embedding for the environment</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>num_layers_heatmap_generator</code></b>
              (<code><span title="int">int</span></code>, default:
                  <code>5</code>
)
          –
          <div class="doc-md-description">
            <p>Number of layers in the heatmap generator</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>num_layers_graph_encoder</code></b>
              (<code><span title="int">int</span></code>, default:
                  <code>15</code>
)
          –
          <div class="doc-md-description">
            <p>Number of layers in the graph encoder</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>act_fn</code></b>
          –
          <div class="doc-md-description">
            <p>Activation function to use in the encoder</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>agg_fn</code></b>
          –
          <div class="doc-md-description">
            <p>Aggregation function to use in the encoder</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>linear_bias</code></b>
              (<code><span title="bool">bool</span></code>, default:
                  <code>True</code>
)
          –
          <div class="doc-md-description">
            <p>Whether to use bias in the encoder</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>train_decode_type</code></b>
              (<code><span title="str">str</span></code>, default:
                  <code>&#39;multistart_sampling&#39;</code>
)
          –
          <div class="doc-md-description">
            <p>Type of decoding during training</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>val_decode_type</code></b>
              (<code><span title="str">str</span></code>, default:
                  <code>&#39;multistart_greedy&#39;</code>
)
          –
          <div class="doc-md-description">
            <p>Type of decoding during validation</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>test_decode_type</code></b>
              (<code><span title="str">str</span></code>, default:
                  <code>&#39;multistart_greedy&#39;</code>
)
          –
          <div class="doc-md-description">
            <p>Type of decoding during testing</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>**constructive_policy_kw</code></b>
          –
          <div class="doc-md-description">
            <p>Unused keyword arguments</p>
          </div>
        </li>
    </ul>













                  <details class="mkdocstrings-source">
                    <summary>Source code in <code>rl4co/models/zoo/nargnn/policy.py</code></summary>
                    <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">encoder</span><span class="p">:</span> <span class="n">NonAutoregressiveEncoder</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">decoder</span><span class="p">:</span> <span class="n">NonAutoregressiveDecoder</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">embed_dim</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">64</span><span class="p">,</span>
    <span class="n">env_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;tsp&quot;</span><span class="p">,</span>
    <span class="n">init_embedding</span><span class="p">:</span> <span class="n">nn</span><span class="o">.</span><span class="n">Module</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">edge_embedding</span><span class="p">:</span> <span class="n">nn</span><span class="o">.</span><span class="n">Module</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">graph_network</span><span class="p">:</span> <span class="n">nn</span><span class="o">.</span><span class="n">Module</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">heatmap_generator</span><span class="p">:</span> <span class="n">nn</span><span class="o">.</span><span class="n">Module</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">num_layers_heatmap_generator</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span>
    <span class="n">num_layers_graph_encoder</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">15</span><span class="p">,</span>
    <span class="n">act_fn</span><span class="o">=</span><span class="s2">&quot;silu&quot;</span><span class="p">,</span>
    <span class="n">agg_fn</span><span class="o">=</span><span class="s2">&quot;mean&quot;</span><span class="p">,</span>
    <span class="n">linear_bias</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">train_decode_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;multistart_sampling&quot;</span><span class="p">,</span>
    <span class="n">val_decode_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;multistart_greedy&quot;</span><span class="p">,</span>
    <span class="n">test_decode_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;multistart_greedy&quot;</span><span class="p">,</span>
    <span class="o">**</span><span class="n">constructive_policy_kw</span><span class="p">,</span>
<span class="p">):</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">constructive_policy_kw</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unused kwargs: </span><span class="si">{</span><span class="n">constructive_policy_kw</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">encoder</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">encoder</span> <span class="o">=</span> <span class="n">NARGNNEncoder</span><span class="p">(</span>
            <span class="n">embed_dim</span><span class="o">=</span><span class="n">embed_dim</span><span class="p">,</span>
            <span class="n">env_name</span><span class="o">=</span><span class="n">env_name</span><span class="p">,</span>
            <span class="n">init_embedding</span><span class="o">=</span><span class="n">init_embedding</span><span class="p">,</span>
            <span class="n">edge_embedding</span><span class="o">=</span><span class="n">edge_embedding</span><span class="p">,</span>
            <span class="n">graph_network</span><span class="o">=</span><span class="n">graph_network</span><span class="p">,</span>
            <span class="n">heatmap_generator</span><span class="o">=</span><span class="n">heatmap_generator</span><span class="p">,</span>
            <span class="n">num_layers_heatmap_generator</span><span class="o">=</span><span class="n">num_layers_heatmap_generator</span><span class="p">,</span>
            <span class="n">num_layers_graph_encoder</span><span class="o">=</span><span class="n">num_layers_graph_encoder</span><span class="p">,</span>
            <span class="n">act_fn</span><span class="o">=</span><span class="n">act_fn</span><span class="p">,</span>
            <span class="n">agg_fn</span><span class="o">=</span><span class="n">agg_fn</span><span class="p">,</span>
            <span class="n">linear_bias</span><span class="o">=</span><span class="n">linear_bias</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="c1"># The decoder generates logits given the current td and heatmap</span>
    <span class="k">if</span> <span class="n">decoder</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">decoder</span> <span class="o">=</span> <span class="n">NonAutoregressiveDecoder</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># check if the decoder has trainable parameters</span>
        <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">requires_grad</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">decoder</span><span class="o">.</span><span class="n">parameters</span><span class="p">()):</span>
            <span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
                <span class="s2">&quot;The decoder contains trainable parameters. This should not happen in a non-autoregressive policy.&quot;</span>
            <span class="p">)</span>

    <span class="c1"># Pass to constructive policy</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
        <span class="n">encoder</span><span class="o">=</span><span class="n">encoder</span><span class="p">,</span>
        <span class="n">decoder</span><span class="o">=</span><span class="n">decoder</span><span class="p">,</span>
        <span class="n">env_name</span><span class="o">=</span><span class="n">env_name</span><span class="p">,</span>
        <span class="n">train_decode_type</span><span class="o">=</span><span class="n">train_decode_type</span><span class="p">,</span>
        <span class="n">val_decode_type</span><span class="o">=</span><span class="n">val_decode_type</span><span class="p">,</span>
        <span class="n">test_decode_type</span><span class="o">=</span><span class="n">test_decode_type</span><span class="p">,</span>
        <span class="o">**</span><span class="n">constructive_policy_kw</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
                  </details>



<div class="doc doc-children">












  </div>

    </div>

</div>




  </div>

    </div>

</div>

<div class="doc doc-object doc-module">




    <div class="doc doc-contents first">










<p><span class="doc-section-title">Classes:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          <b><code><a class="autorefs autorefs-internal" href="#models.zoo.nargnn.encoder.EdgeHeatmapGenerator">EdgeHeatmapGenerator</a></code></b>
          –
          <div class="doc-md-description">
            <p>MLP for converting edge embeddings to heatmaps.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><a class="autorefs autorefs-internal" href="#models.zoo.nargnn.encoder.NARGNNEncoder">NARGNNEncoder</a></code></b>
          –
          <div class="doc-md-description">
            <p>Anisotropic Graph Neural Network encoder with edge-gating mechanism as in Joshi et al. (2022), and used in DeepACO (Ye et al., 2023).</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><a class="autorefs autorefs-internal" href="#models.zoo.nargnn.encoder.NARGNNNodeEncoder">NARGNNNodeEncoder</a></code></b>
          –
          <div class="doc-md-description">
            <p>In this case, we just use the node embeddings from the graph</p>
          </div>
        </li>
    </ul>







<div class="doc doc-children">









<div class="doc doc-object doc-class">



<h2 id="models.zoo.nargnn.encoder.EdgeHeatmapGenerator" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">EdgeHeatmapGenerator</span>


<a href="#models.zoo.nargnn.encoder.EdgeHeatmapGenerator" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="language-python doc-signature highlight"><pre><span></span><code><span class="nf">EdgeHeatmapGenerator</span><span class="p">(</span>
    <span class="n">embed_dim</span><span class="p">:</span> <span class="n"><span title="int">int</span></span><span class="p">,</span>
    <span class="n">num_layers</span><span class="p">:</span> <span class="n"><span title="int">int</span></span><span class="p">,</span>
    <span class="n">act_fn</span><span class="p">:</span> <span class="n"><span title="str">str</span></span> <span class="o">|</span> <span class="n"><span title="collections.abc.Callable">Callable</span></span> <span class="o">=</span> <span class="s2">&quot;silu&quot;</span><span class="p">,</span>
    <span class="n">linear_bias</span><span class="p">:</span> <span class="n"><span title="bool">bool</span></span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">undirected_graph</span><span class="p">:</span> <span class="n"><span title="bool">bool</span></span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="torch.nn.Module">Module</span></code></p>



        <p>MLP for converting edge embeddings to heatmaps.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>embed_dim</code></b>
              (<code><span title="int">int</span></code>)
          –
          <div class="doc-md-description">
            <p>Dimension of the embeddings</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>num_layers</code></b>
              (<code><span title="int">int</span></code>)
          –
          <div class="doc-md-description">
            <p>The number of linear layers in the network.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>act_fn</code></b>
              (<code><span title="str">str</span> | <span title="collections.abc.Callable">Callable</span></code>, default:
                  <code>&#39;silu&#39;</code>
)
          –
          <div class="doc-md-description">
            <p>Activation function. Defaults to "silu".</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>linear_bias</code></b>
              (<code><span title="bool">bool</span></code>, default:
                  <code>True</code>
)
          –
          <div class="doc-md-description">
            <p>Use bias in linear layers. Defaults to True.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>undirected_graph</code></b>
              (<code><span title="bool">bool</span></code>, default:
                  <code>True</code>
)
          –
          <div class="doc-md-description">
            <p>Whether the graph is undirected. Defaults to True.</p>
          </div>
        </li>
    </ul>













                  <details class="mkdocstrings-source">
                    <summary>Source code in <code>rl4co/models/zoo/nargnn/encoder.py</code></summary>
                    <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">embed_dim</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">num_layers</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">act_fn</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Callable</span> <span class="o">=</span> <span class="s2">&quot;silu&quot;</span><span class="p">,</span>
    <span class="n">linear_bias</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">undirected_graph</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">linears</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">ModuleList</span><span class="p">(</span>
        <span class="p">[</span><span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="n">embed_dim</span><span class="p">,</span> <span class="n">embed_dim</span><span class="p">,</span> <span class="n">bias</span><span class="o">=</span><span class="n">linear_bias</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_layers</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)]</span>
    <span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">output</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="n">embed_dim</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">bias</span><span class="o">=</span><span class="n">linear_bias</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">act</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">functional</span><span class="p">,</span> <span class="n">act_fn</span><span class="p">)</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">act_fn</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="k">else</span> <span class="n">act_fn</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">undirected_graph</span> <span class="o">=</span> <span class="n">undirected_graph</span>
</code></pre></div></td></tr></table></div>
                  </details>



<div class="doc doc-children">












  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="models.zoo.nargnn.encoder.NARGNNEncoder" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">NARGNNEncoder</span>


<a href="#models.zoo.nargnn.encoder.NARGNNEncoder" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="language-python doc-signature highlight"><pre><span></span><code><span class="nf">NARGNNEncoder</span><span class="p">(</span>
    <span class="n">embed_dim</span><span class="p">:</span> <span class="n"><span title="int">int</span></span> <span class="o">=</span> <span class="mi">64</span><span class="p">,</span>
    <span class="n">env_name</span><span class="p">:</span> <span class="n"><span title="str">str</span></span> <span class="o">=</span> <span class="s2">&quot;tsp&quot;</span><span class="p">,</span>
    <span class="n">init_embedding</span><span class="p">:</span> <span class="n"><span title="torch.nn.Module">Module</span></span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">edge_embedding</span><span class="p">:</span> <span class="n"><span title="torch.nn.Module">Module</span></span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">graph_network</span><span class="p">:</span> <span class="n"><span title="torch.nn.Module">Module</span></span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">heatmap_generator</span><span class="p">:</span> <span class="n"><span title="torch.nn.Module">Module</span></span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">num_layers_heatmap_generator</span><span class="p">:</span> <span class="n"><span title="int">int</span></span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span>
    <span class="n">num_layers_graph_encoder</span><span class="p">:</span> <span class="n"><span title="int">int</span></span> <span class="o">=</span> <span class="mi">15</span><span class="p">,</span>
    <span class="n">act_fn</span><span class="o">=</span><span class="s2">&quot;silu&quot;</span><span class="p">,</span>
    <span class="n">agg_fn</span><span class="o">=</span><span class="s2">&quot;mean&quot;</span><span class="p">,</span>
    <span class="n">linear_bias</span><span class="p">:</span> <span class="n"><span title="bool">bool</span></span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">k_sparse</span><span class="p">:</span> <span class="n"><span title="int">int</span></span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="rl4co.models.common.constructive.nonautoregressive.NonAutoregressiveEncoder">NonAutoregressiveEncoder</span></code></p>



        <p>Anisotropic Graph Neural Network encoder with edge-gating mechanism as in Joshi et al. (2022), and used in DeepACO (Ye et al., 2023).
This creates a heatmap of NxN for N nodes (i.e., heuristic) that models the probability to go from one node to another for all nodes.
This model utilizes a multi-layer perceptron (MLP) approach to predict edge attributes directly from the input graph features,
which are then transformed into a heatmap representation to facilitate the decoding of the solution. The decoding process
is managed by a specified strategy which could vary from simple greedy selection to more complex sampling methods.</p>


<details class="tip" open>
  <summary>Tip</summary>
  <p>This decoder's performance heavily relies on the ability of the MLP to capture the dependencies between different
parts of the solution without the iterative refinement provided by autoregressive models. It is particularly useful
in scenarios where the solution space can be effectively explored in a parallelized manner or when the solution components
are largely independent.</p>
</details>

<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>embed_dim</code></b>
              (<code><span title="int">int</span></code>, default:
                  <code>64</code>
)
          –
          <div class="doc-md-description">
            <p>Dimension of the node embeddings</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>env_name</code></b>
              (<code><span title="str">str</span></code>, default:
                  <code>&#39;tsp&#39;</code>
)
          –
          <div class="doc-md-description">
            <p>Name of the environment used to initialize embeddings</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>num_layers</code></b>
          –
          <div class="doc-md-description">
            <p>Number of layers in the encoder</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>init_embedding</code></b>
              (<code><span title="torch.nn.Module">Module</span> | None</code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>Model to use for the initial embedding. If None, use the default embedding for the environment</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>edge_embedding</code></b>
              (<code><span title="torch.nn.Module">Module</span> | None</code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>Model to use for the edge embedding. If None, use the default embedding for the environment</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>graph_network</code></b>
              (<code><span title="torch.nn.Module">Module</span> | None</code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>Model to use for the graph network. If None, use the default network for the environment</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>heatmap_generator</code></b>
              (<code><span title="torch.nn.Module">Module</span> | None</code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>Model to use for the heatmap generator. If None, use the default network for the environment</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>num_layers_heatmap_generator</code></b>
              (<code><span title="int">int</span></code>, default:
                  <code>5</code>
)
          –
          <div class="doc-md-description">
            <p>Number of layers in the heatmap generator</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>num_layers_graph_encoder</code></b>
              (<code><span title="int">int</span></code>, default:
                  <code>15</code>
)
          –
          <div class="doc-md-description">
            <p>Number of layers in the graph encoder</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>act_fn</code></b>
          –
          <div class="doc-md-description">
            <p>The activation function to use in each GNNLayer, see <a href="https://pytorch.org/docs/stable/nn.functional.html#non-linear-activation-functions">https://pytorch.org/docs/stable/nn.functional.html#non-linear-activation-functions</a> for available options. Defaults to 'silu'.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>agg_fn</code></b>
          –
          <div class="doc-md-description">
            <p>The aggregation function to use in each GNNLayer for pooling features. Options: 'add', 'mean', 'max'. Defaults to 'mean'.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>linear_bias</code></b>
              (<code><span title="bool">bool</span></code>, default:
                  <code>True</code>
)
          –
          <div class="doc-md-description">
            <p>Use bias in linear layers. Defaults to True.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>k_sparse</code></b>
              (<code><span title="int">int</span> | None</code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>Number of edges to keep for each node. Defaults to None.</p>
          </div>
        </li>
    </ul>












<p><span class="doc-section-title">Methods:</span></p>
    <ul>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" href="#models.zoo.nargnn.encoder.NARGNNEncoder.forward">forward</a></code></b>
            –
            <div class="doc-md-description">
              <p>Forward pass of the encoder.</p>
            </div>
          </li>
    </ul>



                  <details class="mkdocstrings-source">
                    <summary>Source code in <code>rl4co/models/zoo/nargnn/encoder.py</code></summary>
                    <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">embed_dim</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">64</span><span class="p">,</span>
    <span class="n">env_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;tsp&quot;</span><span class="p">,</span>
    <span class="c1"># TODO: pass network</span>
    <span class="n">init_embedding</span><span class="p">:</span> <span class="n">nn</span><span class="o">.</span><span class="n">Module</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">edge_embedding</span><span class="p">:</span> <span class="n">nn</span><span class="o">.</span><span class="n">Module</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">graph_network</span><span class="p">:</span> <span class="n">nn</span><span class="o">.</span><span class="n">Module</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">heatmap_generator</span><span class="p">:</span> <span class="n">nn</span><span class="o">.</span><span class="n">Module</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">num_layers_heatmap_generator</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span>
    <span class="n">num_layers_graph_encoder</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">15</span><span class="p">,</span>
    <span class="n">act_fn</span><span class="o">=</span><span class="s2">&quot;silu&quot;</span><span class="p">,</span>
    <span class="n">agg_fn</span><span class="o">=</span><span class="s2">&quot;mean&quot;</span><span class="p">,</span>
    <span class="n">linear_bias</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">k_sparse</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">):</span>
    <span class="nb">super</span><span class="p">(</span><span class="n">NonAutoregressiveEncoder</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">env_name</span> <span class="o">=</span> <span class="n">env_name</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">init_embedding</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">env_init_embedding</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">env_name</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;embed_dim&quot;</span><span class="p">:</span> <span class="n">embed_dim</span><span class="p">})</span>
        <span class="k">if</span> <span class="n">init_embedding</span> <span class="ow">is</span> <span class="kc">None</span>
        <span class="k">else</span> <span class="n">init_embedding</span>
    <span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">edge_embedding</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">env_edge_embedding</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">env_name</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;embed_dim&quot;</span><span class="p">:</span> <span class="n">embed_dim</span><span class="p">,</span> <span class="s2">&quot;k_sparse&quot;</span><span class="p">:</span> <span class="n">k_sparse</span><span class="p">})</span>
        <span class="k">if</span> <span class="n">edge_embedding</span> <span class="ow">is</span> <span class="kc">None</span>
        <span class="k">else</span> <span class="n">edge_embedding</span>
    <span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">graph_network</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">GNNEncoder</span><span class="p">(</span>
            <span class="n">embed_dim</span><span class="o">=</span><span class="n">embed_dim</span><span class="p">,</span>
            <span class="n">num_layers</span><span class="o">=</span><span class="n">num_layers_graph_encoder</span><span class="p">,</span>
            <span class="n">act_fn</span><span class="o">=</span><span class="n">act_fn</span><span class="p">,</span>
            <span class="n">agg_fn</span><span class="o">=</span><span class="n">agg_fn</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">graph_network</span> <span class="ow">is</span> <span class="kc">None</span>
        <span class="k">else</span> <span class="n">graph_network</span>
    <span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">heatmap_generator</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">EdgeHeatmapGenerator</span><span class="p">(</span>
            <span class="n">embed_dim</span><span class="o">=</span><span class="n">embed_dim</span><span class="p">,</span>
            <span class="n">num_layers</span><span class="o">=</span><span class="n">num_layers_heatmap_generator</span><span class="p">,</span>
            <span class="n">linear_bias</span><span class="o">=</span><span class="n">linear_bias</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">heatmap_generator</span> <span class="ow">is</span> <span class="kc">None</span>
        <span class="k">else</span> <span class="n">heatmap_generator</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
                  </details>



<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h3 id="models.zoo.nargnn.encoder.NARGNNEncoder.forward" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">forward</span>


<a href="#models.zoo.nargnn.encoder.NARGNNEncoder.forward" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span class="nf">forward</span><span class="p">(</span><span class="n">td</span><span class="p">:</span> <span class="n"><span title="tensordict.TensorDict">TensorDict</span></span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Forward pass of the encoder.
Transform the input TensorDict into the latent representation.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>rl4co/models/zoo/nargnn/encoder.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">td</span><span class="p">:</span> <span class="n">TensorDict</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Forward pass of the encoder.</span>
<span class="sd">    Transform the input TensorDict into the latent representation.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Transfer to embedding space</span>
    <span class="n">node_embed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">init_embedding</span><span class="p">(</span><span class="n">td</span><span class="p">)</span>
    <span class="n">graph</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">edge_embedding</span><span class="p">(</span><span class="n">td</span><span class="p">,</span> <span class="n">node_embed</span><span class="p">)</span>

    <span class="c1"># Process embedding into graph</span>
    <span class="c1"># TODO: standardize?</span>
    <span class="n">graph</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">graph</span><span class="o">.</span><span class="n">edge_attr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph_network</span><span class="p">(</span><span class="n">graph</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">graph</span><span class="o">.</span><span class="n">edge_index</span><span class="p">,</span> <span class="n">graph</span><span class="o">.</span><span class="n">edge_attr</span><span class="p">)</span>

    <span class="c1"># Generate heatmap logits</span>
    <span class="n">heatmap_logits</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">heatmap_generator</span><span class="p">(</span><span class="n">graph</span><span class="p">)</span>

    <span class="c1"># Return latent representation (i.e. heatmap logits) and initial embeddings</span>
    <span class="k">return</span> <span class="n">heatmap_logits</span><span class="p">,</span> <span class="n">node_embed</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="models.zoo.nargnn.encoder.NARGNNNodeEncoder" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">NARGNNNodeEncoder</span>


<a href="#models.zoo.nargnn.encoder.NARGNNNodeEncoder" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="language-python doc-signature highlight"><pre><span></span><code><span class="nf">NARGNNNodeEncoder</span><span class="p">(</span>
    <span class="n">embed_dim</span><span class="p">:</span> <span class="n"><span title="int">int</span></span> <span class="o">=</span> <span class="mi">64</span><span class="p">,</span>
    <span class="n">env_name</span><span class="p">:</span> <span class="n"><span title="str">str</span></span> <span class="o">=</span> <span class="s2">&quot;tsp&quot;</span><span class="p">,</span>
    <span class="n">init_embedding</span><span class="p">:</span> <span class="n"><span title="torch.nn.Module">Module</span></span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">edge_embedding</span><span class="p">:</span> <span class="n"><span title="torch.nn.Module">Module</span></span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">graph_network</span><span class="p">:</span> <span class="n"><span title="torch.nn.Module">Module</span></span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">heatmap_generator</span><span class="p">:</span> <span class="n"><span title="torch.nn.Module">Module</span></span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">num_layers_heatmap_generator</span><span class="p">:</span> <span class="n"><span title="int">int</span></span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span>
    <span class="n">num_layers_graph_encoder</span><span class="p">:</span> <span class="n"><span title="int">int</span></span> <span class="o">=</span> <span class="mi">15</span><span class="p">,</span>
    <span class="n">act_fn</span><span class="o">=</span><span class="s2">&quot;silu&quot;</span><span class="p">,</span>
    <span class="n">agg_fn</span><span class="o">=</span><span class="s2">&quot;mean&quot;</span><span class="p">,</span>
    <span class="n">linear_bias</span><span class="p">:</span> <span class="n"><span title="bool">bool</span></span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">k_sparse</span><span class="p">:</span> <span class="n"><span title="int">int</span></span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" href="#models.zoo.nargnn.encoder.NARGNNEncoder">NARGNNEncoder</a></code></p>



        <p>In this case, we just use the node embeddings from the graph
without transforming them into a heatmap.</p>












<p><span class="doc-section-title">Methods:</span></p>
    <ul>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" href="#models.zoo.nargnn.encoder.NARGNNNodeEncoder.forward">forward</a></code></b>
            –
            <div class="doc-md-description">
              <p>Forward pass of the encoder.</p>
            </div>
          </li>
    </ul>



                  <details class="mkdocstrings-source">
                    <summary>Source code in <code>rl4co/models/zoo/nargnn/encoder.py</code></summary>
                    <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">embed_dim</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">64</span><span class="p">,</span>
    <span class="n">env_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;tsp&quot;</span><span class="p">,</span>
    <span class="c1"># TODO: pass network</span>
    <span class="n">init_embedding</span><span class="p">:</span> <span class="n">nn</span><span class="o">.</span><span class="n">Module</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">edge_embedding</span><span class="p">:</span> <span class="n">nn</span><span class="o">.</span><span class="n">Module</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">graph_network</span><span class="p">:</span> <span class="n">nn</span><span class="o">.</span><span class="n">Module</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">heatmap_generator</span><span class="p">:</span> <span class="n">nn</span><span class="o">.</span><span class="n">Module</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">num_layers_heatmap_generator</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span>
    <span class="n">num_layers_graph_encoder</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">15</span><span class="p">,</span>
    <span class="n">act_fn</span><span class="o">=</span><span class="s2">&quot;silu&quot;</span><span class="p">,</span>
    <span class="n">agg_fn</span><span class="o">=</span><span class="s2">&quot;mean&quot;</span><span class="p">,</span>
    <span class="n">linear_bias</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">k_sparse</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">):</span>
    <span class="nb">super</span><span class="p">(</span><span class="n">NonAutoregressiveEncoder</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">env_name</span> <span class="o">=</span> <span class="n">env_name</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">init_embedding</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">env_init_embedding</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">env_name</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;embed_dim&quot;</span><span class="p">:</span> <span class="n">embed_dim</span><span class="p">})</span>
        <span class="k">if</span> <span class="n">init_embedding</span> <span class="ow">is</span> <span class="kc">None</span>
        <span class="k">else</span> <span class="n">init_embedding</span>
    <span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">edge_embedding</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">env_edge_embedding</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">env_name</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;embed_dim&quot;</span><span class="p">:</span> <span class="n">embed_dim</span><span class="p">,</span> <span class="s2">&quot;k_sparse&quot;</span><span class="p">:</span> <span class="n">k_sparse</span><span class="p">})</span>
        <span class="k">if</span> <span class="n">edge_embedding</span> <span class="ow">is</span> <span class="kc">None</span>
        <span class="k">else</span> <span class="n">edge_embedding</span>
    <span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">graph_network</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">GNNEncoder</span><span class="p">(</span>
            <span class="n">embed_dim</span><span class="o">=</span><span class="n">embed_dim</span><span class="p">,</span>
            <span class="n">num_layers</span><span class="o">=</span><span class="n">num_layers_graph_encoder</span><span class="p">,</span>
            <span class="n">act_fn</span><span class="o">=</span><span class="n">act_fn</span><span class="p">,</span>
            <span class="n">agg_fn</span><span class="o">=</span><span class="n">agg_fn</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">graph_network</span> <span class="ow">is</span> <span class="kc">None</span>
        <span class="k">else</span> <span class="n">graph_network</span>
    <span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">heatmap_generator</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">EdgeHeatmapGenerator</span><span class="p">(</span>
            <span class="n">embed_dim</span><span class="o">=</span><span class="n">embed_dim</span><span class="p">,</span>
            <span class="n">num_layers</span><span class="o">=</span><span class="n">num_layers_heatmap_generator</span><span class="p">,</span>
            <span class="n">linear_bias</span><span class="o">=</span><span class="n">linear_bias</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">heatmap_generator</span> <span class="ow">is</span> <span class="kc">None</span>
        <span class="k">else</span> <span class="n">heatmap_generator</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
                  </details>



<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h3 id="models.zoo.nargnn.encoder.NARGNNNodeEncoder.forward" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">forward</span>


<a href="#models.zoo.nargnn.encoder.NARGNNNodeEncoder.forward" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span class="nf">forward</span><span class="p">(</span><span class="n">td</span><span class="p">:</span> <span class="n"><span title="tensordict.TensorDict">TensorDict</span></span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Forward pass of the encoder.
Transform the input TensorDict into the latent representation.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>rl4co/models/zoo/nargnn/encoder.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">td</span><span class="p">:</span> <span class="n">TensorDict</span><span class="p">):</span>
    <span class="c1"># Transfer to embedding space</span>
    <span class="n">node_embed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">init_embedding</span><span class="p">(</span><span class="n">td</span><span class="p">)</span>
    <span class="n">graph</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">edge_embedding</span><span class="p">(</span><span class="n">td</span><span class="p">,</span> <span class="n">node_embed</span><span class="p">)</span>

    <span class="c1"># Process embedding into graph</span>
    <span class="c1"># TODO: standardize?</span>
    <span class="n">graph</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">graph</span><span class="o">.</span><span class="n">edge_attr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph_network</span><span class="p">(</span><span class="n">graph</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">graph</span><span class="o">.</span><span class="n">edge_index</span><span class="p">,</span> <span class="n">graph</span><span class="o">.</span><span class="n">edge_attr</span><span class="p">)</span>

    <span class="n">proc_embeds</span> <span class="o">=</span> <span class="n">graph</span><span class="o">.</span><span class="n">x</span>
    <span class="n">batch_size</span> <span class="o">=</span> <span class="n">node_embed</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="c1"># reshape proc_embeds from [bs*n, h] to [bs, n, h]</span>
    <span class="n">proc_embeds</span> <span class="o">=</span> <span class="n">proc_embeds</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">batch_size</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">proc_embeds</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">proc_embeds</span><span class="p">,</span> <span class="n">node_embed</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>












                

              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Made with ❤️ by <a href="https://github.com/ai4co">AI4CO</a> contributors
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
      <div class="md-progress" data-md-component="progress" role="progressbar"></div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../../../../..", "features": ["announce.dismiss", "content.code.copy", "content.code.annotate", "content.code.select", "content.tabs.link", "content.tooltips", "navigation.expand", "navigation.instant", "navigation.instant.prefetch", "navigation.instant.preview", "navigation.instant.progress", "navigation.indexes", "navigation.path", "navigation.sections", "navigation.top", "navigation.tracking", "navigation.tabs", "search.suggest", "search.highlight", "search.share", "toc.follow"], "search": "../../../../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"default": "stable"}}</script>
    
    
      <script src="../../../../../assets/javascripts/bundle.79ae519e.min.js"></script>
      
        <script src="../../../../js/katex.js"></script>
      
        <script src="../../../../js/particles.min.js"></script>
      
        <script src="https://unpkg.com/katex@0/dist/katex.min.js"></script>
      
        <script src="https://unpkg.com/katex@0/dist/contrib/auto-render.min.js"></script>
      
    
  </body>
</html>