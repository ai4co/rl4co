
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Official documentation for RL4CO">
      
      
      
        <link rel="canonical" href="https://ai4co.github.io/rl4co/docs/content/api/envs/routing/">
      
      
        <link rel="prev" href="../base/">
      
      
        <link rel="next" href="../scheduling/">
      
      
        
      
      
      <link rel="icon" href="../../../../assets/figs/rl4co-logo.svg">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.1">
    
    
      
        <title>Routing Problems - RL4CO</title>
      
    
    
      <link rel="stylesheet" href="../../../../../assets/stylesheets/main.484c7ddc.min.css">
      
        
        <link rel="stylesheet" href="../../../../../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Noto+Sans:300,300i,400,400i,700,700i%7CFira+Code:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Noto Sans";--md-code-font:"Fira Code"}</style>
      
    
    
      <link rel="stylesheet" href="../../../../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../../../stylesheets/extra.css">
    
      <link rel="stylesheet" href="../../../../stylesheets/mkdocstrings.css">
    
      <link rel="stylesheet" href="https://unpkg.com/katex@0/dist/katex.min.css">
    
    <script>__md_scope=new URL("../../../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#routing-problems" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../../../.." title="RL4CO" class="md-header__button md-logo" aria-label="RL4CO" data-md-component="logo">
      
  <img src="../../../../assets/figs/rl4co-logo.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            RL4CO
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Routing Problems
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9zM20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12zm-9.15 3.96h2.3L12 9z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="custom" data-md-color-accent="custom"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="custom" data-md-color-accent="custom"  aria-label="Switch to system preference"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Switch to system preference" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/ai4co/rl4co/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    ai4co/rl4co
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../../.." class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../start/installation/" class="md-tabs__link">
          
  
  
    
  
  Getting Started

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../intro/intro/" class="md-tabs__link">
          
  
  
    
  
  Overview

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../../examples/1-quickstart/" class="md-tabs__link">
          
  
  
    
  
  Tutorials

        </a>
      </li>
    
  

    
  

      
        
  
  
  
    
  
  
    
    
      
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../base/" class="md-tabs__link">
          
  
  
    
  
  API Reference

        </a>
      </li>
    
  

    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../general/contribute/" class="md-tabs__link">
          
  
  
    
  
  About

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../../.." title="RL4CO" class="md-nav__button md-logo" aria-label="RL4CO" data-md-component="logo">
      
  <img src="../../../../assets/figs/rl4co-logo.svg" alt="logo">

    </a>
    RL4CO
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/ai4co/rl4co/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    ai4co/rl4co
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Home
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Getting Started
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Getting Started
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../start/installation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Installation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../examples/1-quickstart/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    RL4CO Quickstart Notebook
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../start/hydra/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Training with Hydra
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Overview
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../intro/intro/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Introduction
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../intro/environments/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Environments
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../intro/policies/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Policies
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../intro/rl/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    RL Algorithms
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Tutorials
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Tutorials
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4_1" >
        
          
          <label class="md-nav__link" for="__nav_4_1" id="__nav_4_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Main
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1">
            <span class="md-nav__icon md-icon"></span>
            
  
    Main
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../examples/1-quickstart/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    RL4CO Quickstart Notebook
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../examples/2-full-training/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Training: Checkpoints, Logging, and Callbacks
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../examples/3-creating-new-env-model/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    New Environment: Creating and Modeling
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4_2" >
        
          
          <label class="md-nav__link" for="__nav_4_2" id="__nav_4_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Modeling
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Modeling
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../examples/modeling/1-decoding-strategies/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    RL4CO Decoding Strategies Notebook
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../examples/modeling/2-transductive-methods/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Transductive Methods
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../examples/modeling/3-change-encoder/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Encoder Customization
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4_3" >
        
          
          <label class="md-nav__link" for="__nav_4_3" id="__nav_4_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Advanced
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Advanced
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../examples/advanced/1-hydra-config/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Hydra Configuration
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../examples/advanced/3-local-search/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Local Search
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../examples/other/3-data-generator-distributions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Generating data in RL4CO
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4_4" >
        
          
          <label class="md-nav__link" for="__nav_4_4" id="__nav_4_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Routing
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Routing
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../examples/other/1-mtvrp/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    MTVRP: Multi-task VRP environment
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../examples/datasets/1-test-on-tsplib/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Testing Model on TSPLib
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../examples/datasets/2-test-on-cvrplib/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Testing Model on VRPLib
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4_5" >
        
          
          <label class="md-nav__link" for="__nav_4_5" id="__nav_4_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Scheduling
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    Scheduling
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../examples/other/2-scheduling/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Solving the Flexible Job-Shop Scheduling Problem (FJSP)
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" checked>
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    API Reference
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    API Reference
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1" checked>
        
          
          <label class="md-nav__link" for="__nav_5_1" id="__nav_5_1_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Environments
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5_1">
            <span class="md-nav__icon md-icon"></span>
            
  
    Environments
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../base/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Base Classes
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    Routing Problems
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    Routing Problems
  

    
  </span>
  
  

      </a>
      
        

  

<nav class="md-nav md-nav--secondary" aria-label="Page contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Page contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#asymmetric-traveling-salesman-problem-atsp" class="md-nav__link">
    <span class="md-ellipsis">
      
        Asymmetric Traveling Salesman Problem (ATSP)
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#envs.routing.atsp.env.ATSPEnv" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;ATSPEnv
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#envs.routing.atsp.generator.ATSPGenerator" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;ATSPGenerator
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#capacitated-vehicle-routing-problem-cvrp" class="md-nav__link">
    <span class="md-ellipsis">
      
        Capacitated Vehicle Routing Problem (CVRP)
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#envs.routing.cvrp.env.CVRPEnv" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;CVRPEnv
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" CVRPEnv">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#envs.routing.cvrp.env.CVRPEnv.check_solution_validity" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;check_solution_validity
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#envs.routing.cvrp.env.CVRPEnv.load_data" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;load_data
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#envs.routing.cvrp.env.CVRPEnv.replace_selected_actions" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;replace_selected_actions
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#envs.routing.cvrp.generator.CVRPGenerator" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;CVRPGenerator
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#multiple-traveling-salesman-problem-mtsp" class="md-nav__link">
    <span class="md-ellipsis">
      
        Multiple Traveling Salesman Problem (mTSP)
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#envs.routing.mtsp.env.MTSPEnv" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;MTSPEnv
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#envs.routing.mtsp.generator.MTSPGenerator" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;MTSPGenerator
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#orienteering-problem-op" class="md-nav__link">
    <span class="md-ellipsis">
      
        Orienteering Problem (OP)
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#envs.routing.op.env.OPEnv" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;OPEnv
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" OPEnv">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#envs.routing.op.env.OPEnv.get_action_mask" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_action_mask
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#envs.routing.op.env.OPEnv.check_solution_validity" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;check_solution_validity
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#envs.routing.op.generator.OPGenerator" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;OPGenerator
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pickup-and-delivery-problem-pdp" class="md-nav__link">
    <span class="md-ellipsis">
      
        Pickup and Delivery Problem (PDP)
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#envs.routing.pdp.env.PDPEnv" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;PDPEnv
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" PDPEnv">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#envs.routing.pdp.env.PDPEnv.get_num_starts" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_num_starts
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#envs.routing.pdp.env.PDPEnv.select_start_nodes" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;select_start_nodes
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#envs.routing.pdp.generator.PDPGenerator" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;PDPGenerator
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prize-collecting-traveling-salesman-problem-pctsp" class="md-nav__link">
    <span class="md-ellipsis">
      
        Prize Collecting Traveling Salesman Problem (PCTSP)
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#envs.routing.pctsp.env.PCTSPEnv" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;PCTSPEnv
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" PCTSPEnv">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#envs.routing.pctsp.env.PCTSPEnv.get_action_mask" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_action_mask
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#envs.routing.pctsp.env.PCTSPEnv.check_solution_validity" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;check_solution_validity
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#envs.routing.pctsp.generator.PCTSPGenerator" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;PCTSPGenerator
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#split-delivery-vehicle-routing-problem-sdvrp" class="md-nav__link">
    <span class="md-ellipsis">
      
        Split Delivery Vehicle Routing Problem (SDVRP)
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#envs.routing.sdvrp.env.SDVRPEnv" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;SDVRPEnv
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" SDVRPEnv">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#envs.routing.sdvrp.env.SDVRPEnv.check_solution_validity" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;check_solution_validity
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#stochastic-prize-collecting-traveling-salesman-problem-spctsp" class="md-nav__link">
    <span class="md-ellipsis">
      
        Stochastic Prize Collecting Traveling Salesman Problem (SPCTSP)
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#envs.routing.spctsp.env.SPCTSPEnv" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;SPCTSPEnv
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#traveling-salesman-problem-tsp" class="md-nav__link">
    <span class="md-ellipsis">
      
        Traveling Salesman Problem (TSP)
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#envs.routing.tsp.env.TSPEnv" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;TSPEnv
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" TSPEnv">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#envs.routing.tsp.env.TSPEnv.check_solution_validity" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;check_solution_validity
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#envs.routing.tsp.env.TSPEnv.replace_selected_actions" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;replace_selected_actions
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#envs.routing.tsp.generator.TSPGenerator" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;TSPGenerator
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#multi-task-vehicle-routing-problem-mtvrp" class="md-nav__link">
    <span class="md-ellipsis">
      
        Multi-Task Vehicle Routing Problem (MTVRP)
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#envs.routing.mtvrp.env.MTVRPEnv" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;MTVRPEnv
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" MTVRPEnv">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#envs.routing.mtvrp.env.MTVRPEnv.load_data" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;load_data
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#envs.routing.mtvrp.env.MTVRPEnv.render" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;render
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#envs.routing.mtvrp.env.MTVRPEnv.select_start_nodes" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;select_start_nodes
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#envs.routing.mtvrp.env.MTVRPEnv.solve" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;solve
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#envs.routing.mtvrp.env.MTVRPEnv.check_variants" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;check_variants
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#envs.routing.mtvrp.generator.MTVRPGenerator" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;MTVRPGenerator
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" MTVRPGenerator">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#envs.routing.mtvrp.generator.MTVRPGenerator.subsample_problems" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;subsample_problems
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#envs.routing.mtvrp.generator.MTVRPGenerator.generate_locations" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;generate_locations
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#envs.routing.mtvrp.generator.MTVRPGenerator.generate_demands" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;generate_demands
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#envs.routing.mtvrp.generator.MTVRPGenerator.generate_time_windows" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;generate_time_windows
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#envs.routing.mtvrp.generator.MTVRPGenerator.generate_distance_limit" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;generate_distance_limit
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#envs.routing.mtvrp.generator.MTVRPGenerator.generate_open_route" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;generate_open_route
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#envs.routing.mtvrp.generator.MTVRPGenerator.generate_speed" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;generate_speed
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../scheduling/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Scheduling Problems
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../eda/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    EDA Problems
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Graph Problems
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5_2" >
        
          
          <label class="md-nav__link" for="__nav_5_2" id="__nav_5_2_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Networks
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Networks
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../networks/base_policies/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Policy Base Classes
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../networks/nn/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Neural Network Modules
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../networks/env_embeddings/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Environment Embeddings
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5_3" >
        
          
          <label class="md-nav__link" for="__nav_5_3" id="__nav_5_3_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    RL Algorithms
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    RL Algorithms
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../rl/base/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Base Classes
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../rl/reinforce/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    REINFORCE
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../rl/ppo/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    PPO
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../rl/a2c/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    A2C
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5_4" >
        
          
          <label class="md-nav__link" for="__nav_5_4" id="__nav_5_4_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Zoo
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Zoo
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../zoo/constructive_ar/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Constructive AR Methods
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../zoo/constructive_nar/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Constructive NAR Methods
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../zoo/improvement/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Improvement Methods
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../zoo/transductive/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Transductive Methods
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5_5" >
        
          
          <label class="md-nav__link" for="__nav_5_5" id="__nav_5_5_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Additional APIs
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    Additional APIs
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tasks/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Train and Evaluation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../decoding/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Decoding Strategies
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Data
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    About
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            
  
    About
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../general/contribute/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Contributing to RL4CO
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../general/faq/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    FAQ
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../general/paper/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Paper and Citation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../general/licensing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    License and Usage
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../general/ai4co/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Join AI4CO
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  

<nav class="md-nav md-nav--secondary" aria-label="Page contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Page contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#asymmetric-traveling-salesman-problem-atsp" class="md-nav__link">
    <span class="md-ellipsis">
      
        Asymmetric Traveling Salesman Problem (ATSP)
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#envs.routing.atsp.env.ATSPEnv" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;ATSPEnv
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#envs.routing.atsp.generator.ATSPGenerator" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;ATSPGenerator
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#capacitated-vehicle-routing-problem-cvrp" class="md-nav__link">
    <span class="md-ellipsis">
      
        Capacitated Vehicle Routing Problem (CVRP)
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#envs.routing.cvrp.env.CVRPEnv" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;CVRPEnv
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" CVRPEnv">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#envs.routing.cvrp.env.CVRPEnv.check_solution_validity" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;check_solution_validity
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#envs.routing.cvrp.env.CVRPEnv.load_data" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;load_data
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#envs.routing.cvrp.env.CVRPEnv.replace_selected_actions" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;replace_selected_actions
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#envs.routing.cvrp.generator.CVRPGenerator" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;CVRPGenerator
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#multiple-traveling-salesman-problem-mtsp" class="md-nav__link">
    <span class="md-ellipsis">
      
        Multiple Traveling Salesman Problem (mTSP)
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#envs.routing.mtsp.env.MTSPEnv" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;MTSPEnv
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#envs.routing.mtsp.generator.MTSPGenerator" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;MTSPGenerator
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#orienteering-problem-op" class="md-nav__link">
    <span class="md-ellipsis">
      
        Orienteering Problem (OP)
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#envs.routing.op.env.OPEnv" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;OPEnv
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" OPEnv">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#envs.routing.op.env.OPEnv.get_action_mask" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_action_mask
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#envs.routing.op.env.OPEnv.check_solution_validity" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;check_solution_validity
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#envs.routing.op.generator.OPGenerator" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;OPGenerator
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pickup-and-delivery-problem-pdp" class="md-nav__link">
    <span class="md-ellipsis">
      
        Pickup and Delivery Problem (PDP)
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#envs.routing.pdp.env.PDPEnv" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;PDPEnv
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" PDPEnv">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#envs.routing.pdp.env.PDPEnv.get_num_starts" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_num_starts
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#envs.routing.pdp.env.PDPEnv.select_start_nodes" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;select_start_nodes
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#envs.routing.pdp.generator.PDPGenerator" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;PDPGenerator
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prize-collecting-traveling-salesman-problem-pctsp" class="md-nav__link">
    <span class="md-ellipsis">
      
        Prize Collecting Traveling Salesman Problem (PCTSP)
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#envs.routing.pctsp.env.PCTSPEnv" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;PCTSPEnv
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" PCTSPEnv">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#envs.routing.pctsp.env.PCTSPEnv.get_action_mask" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_action_mask
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#envs.routing.pctsp.env.PCTSPEnv.check_solution_validity" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;check_solution_validity
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#envs.routing.pctsp.generator.PCTSPGenerator" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;PCTSPGenerator
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#split-delivery-vehicle-routing-problem-sdvrp" class="md-nav__link">
    <span class="md-ellipsis">
      
        Split Delivery Vehicle Routing Problem (SDVRP)
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#envs.routing.sdvrp.env.SDVRPEnv" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;SDVRPEnv
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" SDVRPEnv">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#envs.routing.sdvrp.env.SDVRPEnv.check_solution_validity" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;check_solution_validity
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#stochastic-prize-collecting-traveling-salesman-problem-spctsp" class="md-nav__link">
    <span class="md-ellipsis">
      
        Stochastic Prize Collecting Traveling Salesman Problem (SPCTSP)
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#envs.routing.spctsp.env.SPCTSPEnv" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;SPCTSPEnv
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#traveling-salesman-problem-tsp" class="md-nav__link">
    <span class="md-ellipsis">
      
        Traveling Salesman Problem (TSP)
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#envs.routing.tsp.env.TSPEnv" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;TSPEnv
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" TSPEnv">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#envs.routing.tsp.env.TSPEnv.check_solution_validity" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;check_solution_validity
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#envs.routing.tsp.env.TSPEnv.replace_selected_actions" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;replace_selected_actions
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#envs.routing.tsp.generator.TSPGenerator" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;TSPGenerator
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#multi-task-vehicle-routing-problem-mtvrp" class="md-nav__link">
    <span class="md-ellipsis">
      
        Multi-Task Vehicle Routing Problem (MTVRP)
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#envs.routing.mtvrp.env.MTVRPEnv" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;MTVRPEnv
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" MTVRPEnv">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#envs.routing.mtvrp.env.MTVRPEnv.load_data" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;load_data
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#envs.routing.mtvrp.env.MTVRPEnv.render" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;render
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#envs.routing.mtvrp.env.MTVRPEnv.select_start_nodes" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;select_start_nodes
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#envs.routing.mtvrp.env.MTVRPEnv.solve" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;solve
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#envs.routing.mtvrp.env.MTVRPEnv.check_variants" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;check_variants
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#envs.routing.mtvrp.generator.MTVRPGenerator" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;MTVRPGenerator
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" MTVRPGenerator">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#envs.routing.mtvrp.generator.MTVRPGenerator.subsample_problems" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;subsample_problems
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#envs.routing.mtvrp.generator.MTVRPGenerator.generate_locations" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;generate_locations
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#envs.routing.mtvrp.generator.MTVRPGenerator.generate_demands" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;generate_demands
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#envs.routing.mtvrp.generator.MTVRPGenerator.generate_time_windows" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;generate_time_windows
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#envs.routing.mtvrp.generator.MTVRPGenerator.generate_distance_limit" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;generate_distance_limit
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#envs.routing.mtvrp.generator.MTVRPGenerator.generate_open_route" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;generate_open_route
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#envs.routing.mtvrp.generator.MTVRPGenerator.generate_speed" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;generate_speed
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
                



  


  <nav class="md-path" aria-label="Navigation" >
    <ol class="md-path__list">
      
        
  
  
    <li class="md-path__item">
      <a href="../../../../.." class="md-path__link">
        
  <span class="md-ellipsis">
    Home
  </span>

      </a>
    </li>
  

      
      
        
  
  
    
    
      
  
  
    
    
      <li class="md-path__item">
        <a href="../base/" class="md-path__link">
          
  <span class="md-ellipsis">
    API Reference
  </span>

        </a>
      </li>
    
  

    
  

      
        
  
  
    
    
      <li class="md-path__item">
        <a href="../base/" class="md-path__link">
          
  <span class="md-ellipsis">
    Environments
  </span>

        </a>
      </li>
    
  

      
    </ol>
  </nav>

              
              <article class="md-content__inner md-typeset">
                


                  


  
  


<h1 id="routing-problems">Routing Problems<a class="headerlink" href="#routing-problems" title="Permanent link">&para;</a></h1>
<p>See also the <a href="#Multi-Task-Vehicle-Routing-Problem-(MTVRP)">Multi-Task VRP</a> at the bottom of this page, that includes 16 variants!</p>
<h2 id="asymmetric-traveling-salesman-problem-atsp">Asymmetric Traveling Salesman Problem (ATSP)<a class="headerlink" href="#asymmetric-traveling-salesman-problem-atsp" title="Permanent link">&para;</a></h2>


<div class="doc doc-object doc-class">



<h2 id="envs.routing.atsp.env.ATSPEnv" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">ATSPEnv</span>


<a href="#envs.routing.atsp.env.ATSPEnv" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="language-python doc-signature highlight"><pre><span></span><code><span class="nf">ATSPEnv</span><span class="p">(</span>
    <span class="n">generator</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-internal" href="#envs.routing.atsp.generator.ATSPGenerator">ATSPGenerator</a></span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">generator_params</span><span class="p">:</span> <span class="n"><span title="dict">dict</span></span> <span class="o">=</span> <span class="p">{},</span>
    <span class="o">**</span><span class="n">kwargs</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents first">
            <p class="doc doc-class-bases">
              Bases: <code><span title="rl4co.envs.common.base.RL4COEnvBase">RL4COEnvBase</span></code></p>



        <p>Asymmetric Traveling Salesman Problem (ATSP) environment
At each step, the agent chooses a customer to visit. The reward is 0 unless the agent visits all the customers.
In that case, the reward is (-)length of the path: maximizing the reward is equivalent to minimizing the path length.
Unlike the TSP, the distance matrix is asymmetric, i.e., the distance from A to B is not necessarily the same as the distance from B to A.</p>


<details class="observations" open>
  <summary>Observations</summary>
  <ul>
<li>distance matrix between customers</li>
<li>the current customer</li>
<li>the first customer (for calculating the reward)</li>
<li>the remaining unvisited customers</li>
</ul>
</details>

<details class="constraints" open>
  <summary>Constraints</summary>
  <ul>
<li>the tour starts and ends at the same customer.</li>
<li>each customer must be visited exactly once.</li>
</ul>
</details>

<details class="finish-condition" open>
  <summary>Finish Condition</summary>
  <ul>
<li>the agent has visited all customers.</li>
</ul>
</details>

<details class="reward" open>
  <summary>Reward</summary>
  <ul>
<li>(minus) the negative length of the path.</li>
</ul>
</details>

<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>generator</code></b>
              (<code><a class="autorefs autorefs-internal" href="#envs.routing.atsp.generator.ATSPGenerator">ATSPGenerator</a></code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>ATSPGenerator instance as the data generator</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>generator_params</code></b>
              (<code><span title="dict">dict</span></code>, default:
                  <code>{}</code>
)
          –
          <div class="doc-md-description">
            <p>parameters for the generator</p>
          </div>
        </li>
    </ul>













                  <details class="mkdocstrings-source">
                    <summary>Source code in <code>rl4co/envs/routing/atsp/env.py</code></summary>
                    <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">generator</span><span class="p">:</span> <span class="n">ATSPGenerator</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">generator_params</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{},</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="p">):</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">generator</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">generator</span> <span class="o">=</span> <span class="n">ATSPGenerator</span><span class="p">(</span><span class="o">**</span><span class="n">generator_params</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">generator</span> <span class="o">=</span> <span class="n">generator</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_make_spec</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">generator</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
                  </details>



<div class="doc doc-children">












  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="envs.routing.atsp.generator.ATSPGenerator" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">ATSPGenerator</span>


<a href="#envs.routing.atsp.generator.ATSPGenerator" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="language-python doc-signature highlight"><pre><span></span><code><span class="nf">ATSPGenerator</span><span class="p">(</span>
    <span class="n">num_loc</span><span class="p">:</span> <span class="n"><span title="int">int</span></span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
    <span class="n">min_dist</span><span class="p">:</span> <span class="n"><span title="float">float</span></span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span>
    <span class="n">max_dist</span><span class="p">:</span> <span class="n"><span title="float">float</span></span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
    <span class="n">dist_distribution</span><span class="p">:</span> <span class="p">(</span>
        <span class="n"><span title="int">int</span></span> <span class="o">|</span> <span class="n"><span title="float">float</span></span> <span class="o">|</span> <span class="n"><span title="str">str</span></span> <span class="o">|</span> <span class="n"><span title="type">type</span></span> <span class="o">|</span> <span class="n"><span title="collections.abc.Callable">Callable</span></span>
    <span class="p">)</span> <span class="o">=</span> <span class="n"><span title="torch.distributions.Uniform">Uniform</span></span><span class="p">,</span>
    <span class="n">tmat_class</span><span class="p">:</span> <span class="n"><span title="bool">bool</span></span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents first">
            <p class="doc doc-class-bases">
              Bases: <code><span title="rl4co.envs.common.utils.Generator">Generator</span></code></p>



        <p>Data generator for the Asymmetric Travelling Salesman Problem (ATSP)
Generate distance matrices inspired by the reference MatNet (Kwon et al., 2021)
We satifsy the triangle inequality (TMAT class) in a batch</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>num_loc</code></b>
              (<code><span title="int">int</span></code>, default:
                  <code>10</code>
)
          –
          <div class="doc-md-description">
            <p>number of locations (customers) in the TSP</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>min_dist</code></b>
              (<code><span title="float">float</span></code>, default:
                  <code>0.0</code>
)
          –
          <div class="doc-md-description">
            <p>minimum value for the distance between nodes</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>max_dist</code></b>
              (<code><span title="float">float</span></code>, default:
                  <code>1.0</code>
)
          –
          <div class="doc-md-description">
            <p>maximum value for the distance between nodes</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>dist_distribution</code></b>
              (<code><span title="int">int</span> | <span title="float">float</span> | <span title="str">str</span> | <span title="type">type</span> | <span title="collections.abc.Callable">Callable</span></code>, default:
                  <code><span title="torch.distributions.Uniform">Uniform</span></code>
)
          –
          <div class="doc-md-description">
            <p>distribution for the distance between nodes</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>tmat_class</code></b>
              (<code><span title="bool">bool</span></code>, default:
                  <code>True</code>
)
          –
          <div class="doc-md-description">
            <p>whether to generate a class of distance matrix</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          –
          <div class="doc-md-description">
            <p>A TensorDict with the following keys:
locs [batch_size, num_loc, 2]: locations of each customer</p>
          </div>
        </li>
    </ul>













                  <details class="mkdocstrings-source">
                    <summary>Source code in <code>rl4co/envs/routing/atsp/generator.py</code></summary>
                    <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">num_loc</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
    <span class="n">min_dist</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span>
    <span class="n">max_dist</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
    <span class="n">dist_distribution</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">type</span> <span class="o">|</span> <span class="n">Callable</span> <span class="o">=</span> <span class="n">Uniform</span><span class="p">,</span>
    <span class="n">tmat_class</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">num_loc</span> <span class="o">=</span> <span class="n">num_loc</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">min_dist</span> <span class="o">=</span> <span class="n">min_dist</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">max_dist</span> <span class="o">=</span> <span class="n">max_dist</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">tmat_class</span> <span class="o">=</span> <span class="n">tmat_class</span>

    <span class="c1"># Distance distribution</span>
    <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;dist_sampler&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dist_sampler</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;dist_sampler&quot;</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dist_sampler</span> <span class="o">=</span> <span class="n">get_sampler</span><span class="p">(</span><span class="s2">&quot;dist&quot;</span><span class="p">,</span> <span class="n">dist_distribution</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
                  </details>



<div class="doc doc-children">












  </div>

    </div>

</div><h2 id="capacitated-vehicle-routing-problem-cvrp">Capacitated Vehicle Routing Problem (CVRP)<a class="headerlink" href="#capacitated-vehicle-routing-problem-cvrp" title="Permanent link">&para;</a></h2>


<div class="doc doc-object doc-class">



<h2 id="envs.routing.cvrp.env.CVRPEnv" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">CVRPEnv</span>


<a href="#envs.routing.cvrp.env.CVRPEnv" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="language-python doc-signature highlight"><pre><span></span><code><span class="nf">CVRPEnv</span><span class="p">(</span>
    <span class="n">generator</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-internal" href="#envs.routing.cvrp.generator.CVRPGenerator">CVRPGenerator</a></span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">generator_params</span><span class="p">:</span> <span class="n"><span title="dict">dict</span></span> <span class="o">=</span> <span class="p">{},</span>
    <span class="o">**</span><span class="n">kwargs</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents first">
            <p class="doc doc-class-bases">
              Bases: <code><span title="rl4co.envs.common.base.RL4COEnvBase">RL4COEnvBase</span></code></p>



        <p>Capacitated Vehicle Routing Problem (CVRP) environment.
At each step, the agent chooses a customer to visit depending on the current location and the remaining capacity.
When the agent visits a customer, the remaining capacity is updated. If the remaining capacity is not enough to
visit any customer, the agent must go back to the depot. The reward is 0 unless the agent visits all the cities.
In that case, the reward is (-)length of the path: maximizing the reward is equivalent to minimizing the path length.</p>


<details class="observations" open>
  <summary>Observations</summary>
  <ul>
<li>location of the depot.</li>
<li>locations and demand of each customer.</li>
<li>current location of the vehicle.</li>
<li>the remaining customer of the vehicle,</li>
</ul>
</details>

<details class="constraints" open>
  <summary>Constraints</summary>
  <ul>
<li>the tour starts and ends at the depot.</li>
<li>each customer must be visited exactly once.</li>
<li>the vehicle cannot visit customers exceed the remaining capacity.</li>
<li>the vehicle can return to the depot to refill the capacity.</li>
</ul>
</details>

<details class="finish-condition" open>
  <summary>Finish Condition</summary>
  <ul>
<li>the vehicle has visited all customers and returned to the depot.</li>
</ul>
</details>

<details class="reward" open>
  <summary>Reward</summary>
  <ul>
<li>(minus) the negative length of the path.</li>
</ul>
</details>

<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>generator</code></b>
              (<code><a class="autorefs autorefs-internal" href="#envs.routing.cvrp.generator.CVRPGenerator">CVRPGenerator</a></code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>CVRPGenerator instance as the data generator</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>generator_params</code></b>
              (<code><span title="dict">dict</span></code>, default:
                  <code>{}</code>
)
          –
          <div class="doc-md-description">
            <p>parameters for the generator</p>
          </div>
        </li>
    </ul>












<p><span class="doc-section-title">Methods:</span></p>
    <ul>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" href="#envs.routing.cvrp.env.CVRPEnv.check_solution_validity">check_solution_validity</a></code></b>
            –
            <div class="doc-md-description">
              <p>Check that solution is valid: nodes are not visited twice except depot and capacity is not exceeded</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" href="#envs.routing.cvrp.env.CVRPEnv.load_data">load_data</a></code></b>
            –
            <div class="doc-md-description">
              <p>Dataset loading from file</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" href="#envs.routing.cvrp.env.CVRPEnv.replace_selected_actions">replace_selected_actions</a></code></b>
            –
            <div class="doc-md-description">
              <p>Replace selected current actions with updated actions based on <code>selection_mask</code>.</p>
            </div>
          </li>
    </ul>



                  <details class="mkdocstrings-source">
                    <summary>Source code in <code>rl4co/envs/routing/cvrp/env.py</code></summary>
                    <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">generator</span><span class="p">:</span> <span class="n">CVRPGenerator</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">generator_params</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{},</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="p">):</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">generator</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">generator</span> <span class="o">=</span> <span class="n">CVRPGenerator</span><span class="p">(</span><span class="o">**</span><span class="n">generator_params</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">generator</span> <span class="o">=</span> <span class="n">generator</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_make_spec</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">generator</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
                  </details>



<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h3 id="envs.routing.cvrp.env.CVRPEnv.check_solution_validity" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">check_solution_validity</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#envs.routing.cvrp.env.CVRPEnv.check_solution_validity" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span class="nf">check_solution_validity</span><span class="p">(</span><span class="n">td</span><span class="p">:</span> <span class="n"><span title="tensordict.tensordict.TensorDict">TensorDict</span></span><span class="p">,</span> <span class="n">actions</span><span class="p">:</span> <span class="n"><span title="torch.Tensor">Tensor</span></span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Check that solution is valid: nodes are not visited twice except depot and capacity is not exceeded</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>rl4co/envs/routing/cvrp/env.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">check_solution_validity</span><span class="p">(</span><span class="n">td</span><span class="p">:</span> <span class="n">TensorDict</span><span class="p">,</span> <span class="n">actions</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Check that solution is valid: nodes are not visited twice except depot and capacity is not exceeded&quot;&quot;&quot;</span>
    <span class="c1"># Check if tour is valid, i.e. contain 0 to n-1</span>
    <span class="n">batch_size</span><span class="p">,</span> <span class="n">graph_size</span> <span class="o">=</span> <span class="n">td</span><span class="p">[</span><span class="s2">&quot;demand&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">size</span><span class="p">()</span>
    <span class="n">sorted_pi</span> <span class="o">=</span> <span class="n">actions</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

    <span class="c1"># Sorting it should give all zeros at front and then 1...n</span>
    <span class="k">assert</span> <span class="p">(</span>
        <span class="n">torch</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">graph_size</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">out</span><span class="o">=</span><span class="n">sorted_pi</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">new</span><span class="p">())</span>
        <span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="o">.</span><span class="n">expand</span><span class="p">(</span><span class="n">batch_size</span><span class="p">,</span> <span class="n">graph_size</span><span class="p">)</span>
        <span class="o">==</span> <span class="n">sorted_pi</span><span class="p">[:,</span> <span class="o">-</span><span class="n">graph_size</span><span class="p">:]</span>
    <span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">()</span> <span class="ow">and</span> <span class="p">(</span><span class="n">sorted_pi</span><span class="p">[:,</span> <span class="p">:</span><span class="o">-</span><span class="n">graph_size</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">(),</span> <span class="s2">&quot;Invalid tour&quot;</span>

    <span class="c1"># Visiting depot resets capacity so we add demand = -capacity (we make sure it does not become negative)</span>
    <span class="n">demand_with_depot</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">((</span><span class="o">-</span><span class="n">td</span><span class="p">[</span><span class="s2">&quot;vehicle_capacity&quot;</span><span class="p">],</span> <span class="n">td</span><span class="p">[</span><span class="s2">&quot;demand&quot;</span><span class="p">]),</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">d</span> <span class="o">=</span> <span class="n">demand_with_depot</span><span class="o">.</span><span class="n">gather</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">actions</span><span class="p">)</span>

    <span class="n">used_cap</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">td</span><span class="p">[</span><span class="s2">&quot;demand&quot;</span><span class="p">][:,</span> <span class="mi">0</span><span class="p">])</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">actions</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="mi">1</span><span class="p">)):</span>
        <span class="n">used_cap</span> <span class="o">+=</span> <span class="n">d</span><span class="p">[</span>
            <span class="p">:,</span> <span class="n">i</span>
        <span class="p">]</span>  <span class="c1"># This will reset/make capacity negative if i == 0, e.g. depot visited</span>
        <span class="c1"># Cannot use less than 0</span>
        <span class="n">used_cap</span><span class="p">[</span><span class="n">used_cap</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">assert</span> <span class="p">(</span><span class="n">used_cap</span> <span class="o">&lt;=</span> <span class="n">td</span><span class="p">[</span><span class="s2">&quot;vehicle_capacity&quot;</span><span class="p">][:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mf">1e-5</span><span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">(),</span> <span class="p">(</span>
            <span class="s2">&quot;Used more than capacity&quot;</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="envs.routing.cvrp.env.CVRPEnv.load_data" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">load_data</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#envs.routing.cvrp.env.CVRPEnv.load_data" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span class="nf">load_data</span><span class="p">(</span><span class="n">fpath</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="p">[])</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Dataset loading from file
Normalize demand by capacity to be in [0, 1]</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>rl4co/envs/routing/cvrp/env.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">load_data</span><span class="p">(</span><span class="n">fpath</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="p">[]):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Dataset loading from file</span>
<span class="sd">    Normalize demand by capacity to be in [0, 1]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">td_load</span> <span class="o">=</span> <span class="n">load_npz_to_tensordict</span><span class="p">(</span><span class="n">fpath</span><span class="p">)</span>
    <span class="n">td_load</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;demand&quot;</span><span class="p">,</span> <span class="n">td_load</span><span class="p">[</span><span class="s2">&quot;demand&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="n">td_load</span><span class="p">[</span><span class="s2">&quot;capacity&quot;</span><span class="p">][:,</span> <span class="kc">None</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">td_load</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="envs.routing.cvrp.env.CVRPEnv.replace_selected_actions" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">replace_selected_actions</span>


<a href="#envs.routing.cvrp.env.CVRPEnv.replace_selected_actions" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span class="nf">replace_selected_actions</span><span class="p">(</span>
    <span class="n">cur_actions</span><span class="p">:</span> <span class="n"><span title="torch.Tensor">Tensor</span></span><span class="p">,</span>
    <span class="n">new_actions</span><span class="p">:</span> <span class="n"><span title="torch.Tensor">Tensor</span></span><span class="p">,</span>
    <span class="n">selection_mask</span><span class="p">:</span> <span class="n"><span title="torch.Tensor">Tensor</span></span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="torch.Tensor">Tensor</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Replace selected current actions with updated actions based on <code>selection_mask</code>.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>rl4co/envs/routing/cvrp/env.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">replace_selected_actions</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">cur_actions</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span>
    <span class="n">new_actions</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span>
    <span class="n">selection_mask</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Replace selected current actions with updated actions based on `selection_mask`.</span>

<span class="sd">    Args:</span>
<span class="sd">        cur_actions [batch_size, num_loc]</span>
<span class="sd">        new_actions [batch_size, num_loc]</span>
<span class="sd">        selection_mask [batch_size,]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">diff_length</span> <span class="o">=</span> <span class="n">cur_actions</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">new_actions</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">diff_length</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">new_actions</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">functional</span><span class="o">.</span><span class="n">pad</span><span class="p">(</span>
            <span class="n">new_actions</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">diff_length</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;constant&quot;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">0</span>
        <span class="p">)</span>
    <span class="k">elif</span> <span class="n">diff_length</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">cur_actions</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">functional</span><span class="o">.</span><span class="n">pad</span><span class="p">(</span>
            <span class="n">cur_actions</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="n">diff_length</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;constant&quot;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">0</span>
        <span class="p">)</span>
    <span class="n">cur_actions</span><span class="p">[</span><span class="n">selection_mask</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_actions</span><span class="p">[</span><span class="n">selection_mask</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">cur_actions</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="envs.routing.cvrp.generator.CVRPGenerator" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">CVRPGenerator</span>


<a href="#envs.routing.cvrp.generator.CVRPGenerator" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="language-python doc-signature highlight"><pre><span></span><code><span class="nf">CVRPGenerator</span><span class="p">(</span>
    <span class="n">num_loc</span><span class="p">:</span> <span class="n"><span title="int">int</span></span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span>
    <span class="n">min_loc</span><span class="p">:</span> <span class="n"><span title="float">float</span></span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span>
    <span class="n">max_loc</span><span class="p">:</span> <span class="n"><span title="float">float</span></span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
    <span class="n">loc_distribution</span><span class="p">:</span> <span class="p">(</span>
        <span class="n"><span title="int">int</span></span> <span class="o">|</span> <span class="n"><span title="float">float</span></span> <span class="o">|</span> <span class="n"><span title="str">str</span></span> <span class="o">|</span> <span class="n"><span title="type">type</span></span> <span class="o">|</span> <span class="n"><span title="collections.abc.Callable">Callable</span></span>
    <span class="p">)</span> <span class="o">=</span> <span class="n"><span title="torch.distributions.Uniform">Uniform</span></span><span class="p">,</span>
    <span class="n">depot_distribution</span><span class="p">:</span> <span class="p">(</span>
        <span class="n"><span title="int">int</span></span> <span class="o">|</span> <span class="n"><span title="float">float</span></span> <span class="o">|</span> <span class="n"><span title="str">str</span></span> <span class="o">|</span> <span class="n"><span title="type">type</span></span> <span class="o">|</span> <span class="n"><span title="collections.abc.Callable">Callable</span></span>
    <span class="p">)</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">min_demand</span><span class="p">:</span> <span class="n"><span title="int">int</span></span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">max_demand</span><span class="p">:</span> <span class="n"><span title="int">int</span></span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
    <span class="n">demand_distribution</span><span class="p">:</span> <span class="p">(</span>
        <span class="n"><span title="int">int</span></span> <span class="o">|</span> <span class="n"><span title="float">float</span></span> <span class="o">|</span> <span class="n"><span title="type">type</span></span> <span class="o">|</span> <span class="n"><span title="collections.abc.Callable">Callable</span></span>
    <span class="p">)</span> <span class="o">=</span> <span class="n"><span title="torch.distributions.Uniform">Uniform</span></span><span class="p">,</span>
    <span class="n">vehicle_capacity</span><span class="p">:</span> <span class="n"><span title="float">float</span></span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
    <span class="n">capacity</span><span class="p">:</span> <span class="n"><span title="float">float</span></span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents first">
            <p class="doc doc-class-bases">
              Bases: <code><span title="rl4co.envs.common.utils.Generator">Generator</span></code></p>



        <p>Data generator for the Capacitated Vehicle Routing Problem (CVRP).</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>num_loc</code></b>
              (<code><span title="int">int</span></code>, default:
                  <code>20</code>
)
          –
          <div class="doc-md-description">
            <p>number of locations (cities) in the VRP, without the depot. (e.g. 10 means 10 locs + 1 depot)</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>min_loc</code></b>
              (<code><span title="float">float</span></code>, default:
                  <code>0.0</code>
)
          –
          <div class="doc-md-description">
            <p>minimum value for the location coordinates</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>max_loc</code></b>
              (<code><span title="float">float</span></code>, default:
                  <code>1.0</code>
)
          –
          <div class="doc-md-description">
            <p>maximum value for the location coordinates</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>loc_distribution</code></b>
              (<code><span title="int">int</span> | <span title="float">float</span> | <span title="str">str</span> | <span title="type">type</span> | <span title="collections.abc.Callable">Callable</span></code>, default:
                  <code><span title="torch.distributions.Uniform">Uniform</span></code>
)
          –
          <div class="doc-md-description">
            <p>distribution for the location coordinates</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>depot_distribution</code></b>
              (<code><span title="int">int</span> | <span title="float">float</span> | <span title="str">str</span> | <span title="type">type</span> | <span title="collections.abc.Callable">Callable</span></code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>distribution for the depot location. If None, sample the depot from the locations</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>min_demand</code></b>
              (<code><span title="int">int</span></code>, default:
                  <code>1</code>
)
          –
          <div class="doc-md-description">
            <p>minimum value for the demand of each customer</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>max_demand</code></b>
              (<code><span title="int">int</span></code>, default:
                  <code>10</code>
)
          –
          <div class="doc-md-description">
            <p>maximum value for the demand of each customer</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>demand_distribution</code></b>
              (<code><span title="int">int</span> | <span title="float">float</span> | <span title="type">type</span> | <span title="collections.abc.Callable">Callable</span></code>, default:
                  <code><span title="torch.distributions.Uniform">Uniform</span></code>
)
          –
          <div class="doc-md-description">
            <p>distribution for the demand of each customer</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>capacity</code></b>
              (<code><span title="float">float</span></code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>capacity of the vehicle</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          –
          <div class="doc-md-description">
            <p>A TensorDict with the following keys:
locs [batch_size, num_loc, 2]: locations of each customer
depot [batch_size, 2]: location of the depot
demand [batch_size, num_loc]: demand of each customer
capacity [batch_size]: capacity of the vehicle</p>
          </div>
        </li>
    </ul>













                  <details class="mkdocstrings-source">
                    <summary>Source code in <code>rl4co/envs/routing/cvrp/generator.py</code></summary>
                    <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">num_loc</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span>
    <span class="n">min_loc</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span>
    <span class="n">max_loc</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
    <span class="n">loc_distribution</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">type</span> <span class="o">|</span> <span class="n">Callable</span> <span class="o">=</span> <span class="n">Uniform</span><span class="p">,</span>
    <span class="n">depot_distribution</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">type</span> <span class="o">|</span> <span class="n">Callable</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">min_demand</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">max_demand</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
    <span class="n">demand_distribution</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">type</span> <span class="o">|</span> <span class="n">Callable</span> <span class="o">=</span> <span class="n">Uniform</span><span class="p">,</span>
    <span class="n">vehicle_capacity</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
    <span class="n">capacity</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">num_loc</span> <span class="o">=</span> <span class="n">num_loc</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">min_loc</span> <span class="o">=</span> <span class="n">min_loc</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">max_loc</span> <span class="o">=</span> <span class="n">max_loc</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">min_demand</span> <span class="o">=</span> <span class="n">min_demand</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">max_demand</span> <span class="o">=</span> <span class="n">max_demand</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">vehicle_capacity</span> <span class="o">=</span> <span class="n">vehicle_capacity</span>

    <span class="c1"># Location distribution</span>
    <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;loc_sampler&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">loc_sampler</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;loc_sampler&quot;</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">loc_sampler</span> <span class="o">=</span> <span class="n">get_sampler</span><span class="p">(</span><span class="s2">&quot;loc&quot;</span><span class="p">,</span> <span class="n">loc_distribution</span><span class="p">,</span> <span class="n">min_loc</span><span class="p">,</span> <span class="n">max_loc</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="c1"># Depot distribution</span>
    <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;depot_sampler&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">depot_sampler</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;depot_sampler&quot;</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">depot_sampler</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">get_sampler</span><span class="p">(</span><span class="s2">&quot;depot&quot;</span><span class="p">,</span> <span class="n">depot_distribution</span><span class="p">,</span> <span class="n">min_loc</span><span class="p">,</span> <span class="n">max_loc</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">depot_distribution</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
            <span class="k">else</span> <span class="kc">None</span>
        <span class="p">)</span>

    <span class="c1"># Demand distribution</span>
    <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;demand_sampler&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">demand_sampler</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;demand_sampler&quot;</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">demand_sampler</span> <span class="o">=</span> <span class="n">get_sampler</span><span class="p">(</span>
            <span class="s2">&quot;demand&quot;</span><span class="p">,</span> <span class="n">demand_distribution</span><span class="p">,</span> <span class="n">min_demand</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">max_demand</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
        <span class="p">)</span>

    <span class="c1"># Capacity</span>
    <span class="k">if</span> <span class="n">capacity</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># If not provided, use the default capacity from Kool et al. 2019</span>
        <span class="n">capacity</span> <span class="o">=</span> <span class="n">CAPACITIES</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">num_loc</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="k">if</span> <span class="p">(</span>
        <span class="n">capacity</span> <span class="ow">is</span> <span class="kc">None</span>
    <span class="p">):</span>  <span class="c1"># If not in the table keys, find the closest number of nodes as the key</span>
        <span class="n">closest_num_loc</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">CAPACITIES</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">abs</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">num_loc</span><span class="p">))</span>
        <span class="n">capacity</span> <span class="o">=</span> <span class="n">CAPACITIES</span><span class="p">[</span><span class="n">closest_num_loc</span><span class="p">]</span>
        <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;The capacity capacity for </span><span class="si">{</span><span class="n">num_loc</span><span class="si">}</span><span class="s2"> locations is not defined. Using the closest capacity: </span><span class="si">{</span><span class="n">capacity</span><span class="si">}</span><span class="se">\</span>
<span class="s2">                with </span><span class="si">{</span><span class="n">closest_num_loc</span><span class="si">}</span><span class="s2"> locations.&quot;</span>
        <span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">capacity</span> <span class="o">=</span> <span class="n">capacity</span>
</code></pre></div></td></tr></table></div>
                  </details>



<div class="doc doc-children">












  </div>

    </div>

</div><h2 id="multiple-traveling-salesman-problem-mtsp">Multiple Traveling Salesman Problem (mTSP)<a class="headerlink" href="#multiple-traveling-salesman-problem-mtsp" title="Permanent link">&para;</a></h2>


<div class="doc doc-object doc-class">



<h2 id="envs.routing.mtsp.env.MTSPEnv" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">MTSPEnv</span>


<a href="#envs.routing.mtsp.env.MTSPEnv" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="language-python doc-signature highlight"><pre><span></span><code><span class="nf">MTSPEnv</span><span class="p">(</span>
    <span class="n">generator</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-internal" href="#envs.routing.mtsp.generator.MTSPGenerator">MTSPGenerator</a></span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">generator_params</span><span class="p">:</span> <span class="n"><span title="dict">dict</span></span> <span class="o">=</span> <span class="p">{},</span>
    <span class="n">cost_type</span><span class="p">:</span> <span class="n"><span title="str">str</span></span> <span class="o">=</span> <span class="s2">&quot;minmax&quot;</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents first">
            <p class="doc doc-class-bases">
              Bases: <code><span title="rl4co.envs.common.base.RL4COEnvBase">RL4COEnvBase</span></code></p>



        <p>Multiple Traveling Salesman Problem environment
At each step, an agent chooses to visit a city. A maximum of <code>num_agents</code> agents can be employed to visit the cities.
The cost can be defined in two ways:</p>
<div class="language-text highlight"><pre><span></span><code>- `minmax`: (default) the reward is the maximum of the path lengths of all the agents
- `sum`: the cost is the sum of the path lengths of all the agents
</code></pre></div>
<p>Reward is - cost, so the goal is to maximize the reward (minimize the cost).</p>


<details class="observations" open>
  <summary>Observations</summary>
  <ul>
<li>locations of the depot and each customer.</li>
<li>number of agents.</li>
<li>the current agent index.</li>
<li>the current location of the vehicle.</li>
</ul>
</details>

<details class="constrains" open>
  <summary>Constrains</summary>
  <ul>
<li>each agent's tour starts and ends at the depot.</li>
<li>each customer must be visited exactly once.</li>
</ul>
</details>

<details class="finish-condition" open>
  <summary>Finish condition</summary>
  <ul>
<li>all customers are visited and all agents back to the depot.</li>
</ul>
</details>

<details class="reward" open>
  <summary>Reward</summary>
  <p>There are two ways to calculate the cost (-reward):</p>
<ul>
<li><code>minmax</code>: (default) the cost is the maximum of the path lengths of all the agents.</li>
<li><code>sum</code>: the cost is the sum of the path lengths of all the agents.</li>
</ul>
</details>

<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>cost_type</code></b>
              (<code><span title="str">str</span></code>, default:
                  <code>&#39;minmax&#39;</code>
)
          –
          <div class="doc-md-description">
            <p>type of cost to use, either <code>minmax</code> or <code>sum</code></p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>generator</code></b>
              (<code><a class="autorefs autorefs-internal" href="#envs.routing.mtsp.generator.MTSPGenerator">MTSPGenerator</a></code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>MTSPGenerator instance as the data generator</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>generator_params</code></b>
              (<code><span title="dict">dict</span></code>, default:
                  <code>{}</code>
)
          –
          <div class="doc-md-description">
            <p>parameters for the generator</p>
          </div>
        </li>
    </ul>













                  <details class="mkdocstrings-source">
                    <summary>Source code in <code>rl4co/envs/routing/mtsp/env.py</code></summary>
                    <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">generator</span><span class="p">:</span> <span class="n">MTSPGenerator</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">generator_params</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{},</span>
    <span class="n">cost_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;minmax&quot;</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="p">):</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">generator</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">generator</span> <span class="o">=</span> <span class="n">MTSPGenerator</span><span class="p">(</span><span class="o">**</span><span class="n">generator_params</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">generator</span> <span class="o">=</span> <span class="n">generator</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">cost_type</span> <span class="o">=</span> <span class="n">cost_type</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_make_spec</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">generator</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
                  </details>



<div class="doc doc-children">












  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="envs.routing.mtsp.generator.MTSPGenerator" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">MTSPGenerator</span>


<a href="#envs.routing.mtsp.generator.MTSPGenerator" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="language-python doc-signature highlight"><pre><span></span><code><span class="nf">MTSPGenerator</span><span class="p">(</span>
    <span class="n">num_loc</span><span class="p">:</span> <span class="n"><span title="int">int</span></span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span>
    <span class="n">min_loc</span><span class="p">:</span> <span class="n"><span title="float">float</span></span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span>
    <span class="n">max_loc</span><span class="p">:</span> <span class="n"><span title="float">float</span></span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
    <span class="n">loc_distribution</span><span class="p">:</span> <span class="p">(</span>
        <span class="n"><span title="int">int</span></span> <span class="o">|</span> <span class="n"><span title="float">float</span></span> <span class="o">|</span> <span class="n"><span title="str">str</span></span> <span class="o">|</span> <span class="n"><span title="type">type</span></span> <span class="o">|</span> <span class="n"><span title="collections.abc.Callable">Callable</span></span>
    <span class="p">)</span> <span class="o">=</span> <span class="n"><span title="torch.distributions.Uniform">Uniform</span></span><span class="p">,</span>
    <span class="n">min_num_agents</span><span class="p">:</span> <span class="n"><span title="int">int</span></span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span>
    <span class="n">max_num_agents</span><span class="p">:</span> <span class="n"><span title="int">int</span></span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents first">
            <p class="doc doc-class-bases">
              Bases: <code><span title="rl4co.envs.common.utils.Generator">Generator</span></code></p>



        <p>Data generator for the Multiple Travelling Salesman Problem (mTSP).</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>num_loc</code></b>
              (<code><span title="int">int</span></code>, default:
                  <code>20</code>
)
          –
          <div class="doc-md-description">
            <p>number of locations (customers) in the TSP</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>min_loc</code></b>
              (<code><span title="float">float</span></code>, default:
                  <code>0.0</code>
)
          –
          <div class="doc-md-description">
            <p>minimum value for the location coordinates</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>max_loc</code></b>
              (<code><span title="float">float</span></code>, default:
                  <code>1.0</code>
)
          –
          <div class="doc-md-description">
            <p>maximum value for the location coordinates</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>loc_distribution</code></b>
              (<code><span title="int">int</span> | <span title="float">float</span> | <span title="str">str</span> | <span title="type">type</span> | <span title="collections.abc.Callable">Callable</span></code>, default:
                  <code><span title="torch.distributions.Uniform">Uniform</span></code>
)
          –
          <div class="doc-md-description">
            <p>distribution for the location coordinates</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>min_num_agents</code></b>
              (<code><span title="int">int</span></code>, default:
                  <code>5</code>
)
          –
          <div class="doc-md-description">
            <p>minimum number of agents (vehicles), include</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>max_num_agents</code></b>
              (<code><span title="int">int</span></code>, default:
                  <code>5</code>
)
          –
          <div class="doc-md-description">
            <p>maximum number of agents (vehicles), include</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          –
          <div class="doc-md-description">
            <p>A TensorDict with the following keys:
locs [batch_size, num_loc, 2]: locations of each customer
num_agents [batch_size]: number of agents (vehicles)</p>
          </div>
        </li>
    </ul>













                  <details class="mkdocstrings-source">
                    <summary>Source code in <code>rl4co/envs/routing/mtsp/generator.py</code></summary>
                    <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">num_loc</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span>
    <span class="n">min_loc</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span>
    <span class="n">max_loc</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
    <span class="n">loc_distribution</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">type</span> <span class="o">|</span> <span class="n">Callable</span> <span class="o">=</span> <span class="n">Uniform</span><span class="p">,</span>
    <span class="n">min_num_agents</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span>
    <span class="n">max_num_agents</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">num_loc</span> <span class="o">=</span> <span class="n">num_loc</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">min_loc</span> <span class="o">=</span> <span class="n">min_loc</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">max_loc</span> <span class="o">=</span> <span class="n">max_loc</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">min_num_agents</span> <span class="o">=</span> <span class="n">min_num_agents</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">max_num_agents</span> <span class="o">=</span> <span class="n">max_num_agents</span>

    <span class="c1"># Location distribution</span>
    <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;loc_sampler&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">loc_sampler</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;loc_sampler&quot;</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">loc_sampler</span> <span class="o">=</span> <span class="n">get_sampler</span><span class="p">(</span><span class="s2">&quot;loc&quot;</span><span class="p">,</span> <span class="n">loc_distribution</span><span class="p">,</span> <span class="n">min_loc</span><span class="p">,</span> <span class="n">max_loc</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
                  </details>



<div class="doc doc-children">












  </div>

    </div>

</div><h2 id="orienteering-problem-op">Orienteering Problem (OP)<a class="headerlink" href="#orienteering-problem-op" title="Permanent link">&para;</a></h2>


<div class="doc doc-object doc-class">



<h2 id="envs.routing.op.env.OPEnv" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">OPEnv</span>


<a href="#envs.routing.op.env.OPEnv" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="language-python doc-signature highlight"><pre><span></span><code><span class="nf">OPEnv</span><span class="p">(</span>
    <span class="n">generator</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-internal" href="#envs.routing.op.generator.OPGenerator">OPGenerator</a></span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">generator_params</span><span class="p">:</span> <span class="n"><span title="dict">dict</span></span> <span class="o">=</span> <span class="p">{},</span>
    <span class="n">prize_type</span><span class="p">:</span> <span class="n"><span title="str">str</span></span> <span class="o">=</span> <span class="s2">&quot;dist&quot;</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents first">
            <p class="doc doc-class-bases">
              Bases: <code><span title="rl4co.envs.common.base.RL4COEnvBase">RL4COEnvBase</span></code></p>



        <p>Orienteering Problem (OP) environment.
At each step, the agent chooses a location to visit in order to maximize the collected prize.
The total length of the path must not exceed a given threshold.</p>


<details class="observations" open>
  <summary>Observations</summary>
  <ul>
<li>location of the depot</li>
<li>locations and prize of each customer</li>
<li>current location of the vehicle</li>
<li>current tour length</li>
<li>current total prize</li>
<li>the remaining length of the path</li>
</ul>
</details>

<details class="constraints" open>
  <summary>Constraints</summary>
  <ul>
<li>the tour starts and ends at the depot</li>
<li>not all customers need to be visited</li>
<li>the vehicle cannot visit customers exceed the remaining length of the path</li>
</ul>
</details>

<details class="finish-condition" open>
  <summary>Finish Condition</summary>
  <ul>
<li>the vehicle back to the depot</li>
</ul>
</details>

<details class="reward" open>
  <summary>Reward</summary>
  <ul>
<li>the sum of the prizes of visited nodes</li>
</ul>
</details>

<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>generator</code></b>
              (<code><a class="autorefs autorefs-internal" href="#envs.routing.op.generator.OPGenerator">OPGenerator</a></code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>OPGenerator instance as the data generator</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>generator_params</code></b>
              (<code><span title="dict">dict</span></code>, default:
                  <code>{}</code>
)
          –
          <div class="doc-md-description">
            <p>parameters for the generator</p>
          </div>
        </li>
    </ul>












<p><span class="doc-section-title">Methods:</span></p>
    <ul>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" href="#envs.routing.op.env.OPEnv.get_action_mask">get_action_mask</a></code></b>
            –
            <div class="doc-md-description">
              <p>Get action mask with 1 = feasible action, 0 = infeasible action.</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" href="#envs.routing.op.env.OPEnv.check_solution_validity">check_solution_validity</a></code></b>
            –
            <div class="doc-md-description">
              <p>Check that solution is valid: nodes are not visited twice except depot and capacity is not exceeded.</p>
            </div>
          </li>
    </ul>



                  <details class="mkdocstrings-source">
                    <summary>Source code in <code>rl4co/envs/routing/op/env.py</code></summary>
                    <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">generator</span><span class="p">:</span> <span class="n">OPGenerator</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">generator_params</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{},</span>
    <span class="n">prize_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;dist&quot;</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="p">):</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">generator</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">generator</span> <span class="o">=</span> <span class="n">OPGenerator</span><span class="p">(</span><span class="o">**</span><span class="n">generator_params</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">generator</span> <span class="o">=</span> <span class="n">generator</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">prize_type</span> <span class="o">=</span> <span class="n">prize_type</span>
    <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">prize_type</span> <span class="ow">in</span> <span class="p">[</span>
        <span class="s2">&quot;dist&quot;</span><span class="p">,</span>
        <span class="s2">&quot;unif&quot;</span><span class="p">,</span>
        <span class="s2">&quot;const&quot;</span><span class="p">,</span>
    <span class="p">],</span> <span class="sa">f</span><span class="s2">&quot;Invalid prize_type: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">prize_type</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_make_spec</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">generator</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
                  </details>



<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h3 id="envs.routing.op.env.OPEnv.get_action_mask" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">get_action_mask</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#envs.routing.op.env.OPEnv.get_action_mask" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span class="nf">get_action_mask</span><span class="p">(</span><span class="n">td</span><span class="p">:</span> <span class="n"><span title="tensordict.tensordict.TensorDict">TensorDict</span></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="torch.Tensor">Tensor</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Get action mask with 1 = feasible action, 0 = infeasible action.
Cannot visit if already visited, if depot has been visited, or if the length exceeds the maximum length.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>rl4co/envs/routing/op/env.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">get_action_mask</span><span class="p">(</span><span class="n">td</span><span class="p">:</span> <span class="n">TensorDict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get action mask with 1 = feasible action, 0 = infeasible action.</span>
<span class="sd">    Cannot visit if already visited, if depot has been visited, or if the length exceeds the maximum length.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">current_loc</span> <span class="o">=</span> <span class="n">gather_by_index</span><span class="p">(</span><span class="n">td</span><span class="p">[</span><span class="s2">&quot;locs&quot;</span><span class="p">],</span> <span class="n">td</span><span class="p">[</span><span class="s2">&quot;current_node&quot;</span><span class="p">])[</span><span class="o">...</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="p">:]</span>
    <span class="n">exceeds_length</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">td</span><span class="p">[</span><span class="s2">&quot;tour_length&quot;</span><span class="p">][</span><span class="o">...</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="n">td</span><span class="p">[</span><span class="s2">&quot;locs&quot;</span><span class="p">]</span> <span class="o">-</span> <span class="n">current_loc</span><span class="p">)</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">dim</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
        <span class="o">&gt;</span> <span class="n">td</span><span class="p">[</span><span class="s2">&quot;max_length&quot;</span><span class="p">]</span>
    <span class="p">)</span>
    <span class="n">mask</span> <span class="o">=</span> <span class="n">td</span><span class="p">[</span><span class="s2">&quot;visited&quot;</span><span class="p">]</span> <span class="o">|</span> <span class="n">td</span><span class="p">[</span><span class="s2">&quot;visited&quot;</span><span class="p">][</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">]</span> <span class="o">|</span> <span class="n">exceeds_length</span>

    <span class="n">action_mask</span> <span class="o">=</span> <span class="o">~</span><span class="n">mask</span>  <span class="c1"># 1 = feasible action, 0 = infeasible action</span>

    <span class="c1"># Depot can always be visited: we do not hardcode knowledge that this is strictly suboptimal if other options are available</span>
    <span class="n">action_mask</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="n">action_mask</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="envs.routing.op.env.OPEnv.check_solution_validity" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">check_solution_validity</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#envs.routing.op.env.OPEnv.check_solution_validity" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span class="nf">check_solution_validity</span><span class="p">(</span>
    <span class="n">td</span><span class="p">:</span> <span class="n"><span title="tensordict.tensordict.TensorDict">TensorDict</span></span><span class="p">,</span>
    <span class="n">actions</span><span class="p">:</span> <span class="n"><span title="torch.Tensor">Tensor</span></span><span class="p">,</span>
    <span class="n">add_distance_to_depot</span><span class="p">:</span> <span class="n"><span title="bool">bool</span></span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Check that solution is valid: nodes are not visited twice except depot and capacity is not exceeded.
If <code>add_distance_to_depot</code> if True, then the distance to the depot is added to max length since by default, the max length is
modified in the reset function to account for the distance to the depot.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>rl4co/envs/routing/op/env.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">check_solution_validity</span><span class="p">(</span>
    <span class="n">td</span><span class="p">:</span> <span class="n">TensorDict</span><span class="p">,</span> <span class="n">actions</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">add_distance_to_depot</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Check that solution is valid: nodes are not visited twice except depot and capacity is not exceeded.</span>
<span class="sd">    If `add_distance_to_depot` if True, then the distance to the depot is added to max length since by default, the max length is</span>
<span class="sd">    modified in the reset function to account for the distance to the depot.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Check that tours are valid, i.e. contain 0 to n -1</span>
    <span class="n">sorted_actions</span> <span class="o">=</span> <span class="n">actions</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="c1"># Make sure each node visited once at most (except for depot)</span>
    <span class="k">assert</span> <span class="p">(</span>
        <span class="p">(</span><span class="n">sorted_actions</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">:]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">sorted_actions</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">:]</span> <span class="o">&gt;</span> <span class="n">sorted_actions</span><span class="p">[:,</span> <span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
    <span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">(),</span> <span class="s2">&quot;Duplicates&quot;</span>

    <span class="c1"># Gather locations in order of tour and get the length of tours</span>
    <span class="n">locs_ordered</span> <span class="o">=</span> <span class="n">gather_by_index</span><span class="p">(</span><span class="n">td</span><span class="p">[</span><span class="s2">&quot;locs&quot;</span><span class="p">],</span> <span class="n">actions</span><span class="p">)</span>
    <span class="n">length</span> <span class="o">=</span> <span class="n">get_tour_length</span><span class="p">(</span><span class="n">locs_ordered</span><span class="p">)</span>

    <span class="n">max_length</span> <span class="o">=</span> <span class="n">td</span><span class="p">[</span><span class="s2">&quot;max_length&quot;</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">add_distance_to_depot</span><span class="p">:</span>
        <span class="n">max_length</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">max_length</span> <span class="o">+</span> <span class="p">(</span><span class="n">td</span><span class="p">[</span><span class="s2">&quot;locs&quot;</span><span class="p">][</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span> <span class="o">-</span> <span class="n">td</span><span class="p">[</span><span class="s2">&quot;locs&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">dim</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="mf">1e-6</span>
        <span class="p">)</span>
    <span class="k">assert</span> <span class="p">(</span><span class="n">length</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">max_length</span> <span class="o">+</span> <span class="mf">1e-5</span><span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">(),</span> <span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;Max length exceeded by </span><span class="si">{</span><span class="p">(</span><span class="n">length</span><span class="p">[</span><span class="o">...</span><span class="p">,</span><span class="w"> </span><span class="kc">None</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">max_length</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="envs.routing.op.generator.OPGenerator" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">OPGenerator</span>


<a href="#envs.routing.op.generator.OPGenerator" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="language-python doc-signature highlight"><pre><span></span><code><span class="nf">OPGenerator</span><span class="p">(</span>
    <span class="n">num_loc</span><span class="p">:</span> <span class="n"><span title="int">int</span></span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span>
    <span class="n">min_loc</span><span class="p">:</span> <span class="n"><span title="float">float</span></span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span>
    <span class="n">max_loc</span><span class="p">:</span> <span class="n"><span title="float">float</span></span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
    <span class="n">loc_distribution</span><span class="p">:</span> <span class="p">(</span>
        <span class="n"><span title="int">int</span></span> <span class="o">|</span> <span class="n"><span title="float">float</span></span> <span class="o">|</span> <span class="n"><span title="str">str</span></span> <span class="o">|</span> <span class="n"><span title="type">type</span></span> <span class="o">|</span> <span class="n"><span title="collections.abc.Callable">Callable</span></span>
    <span class="p">)</span> <span class="o">=</span> <span class="n"><span title="torch.distributions.Uniform">Uniform</span></span><span class="p">,</span>
    <span class="n">depot_distribution</span><span class="p">:</span> <span class="p">(</span>
        <span class="n"><span title="int">int</span></span> <span class="o">|</span> <span class="n"><span title="float">float</span></span> <span class="o">|</span> <span class="n"><span title="str">str</span></span> <span class="o">|</span> <span class="n"><span title="type">type</span></span> <span class="o">|</span> <span class="n"><span title="collections.abc.Callable">Callable</span></span>
    <span class="p">)</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">min_prize</span><span class="p">:</span> <span class="n"><span title="float">float</span></span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
    <span class="n">max_prize</span><span class="p">:</span> <span class="n"><span title="float">float</span></span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
    <span class="n">prize_distribution</span><span class="p">:</span> <span class="p">(</span>
        <span class="n"><span title="int">int</span></span> <span class="o">|</span> <span class="n"><span title="float">float</span></span> <span class="o">|</span> <span class="n"><span title="type">type</span></span> <span class="o">|</span> <span class="n"><span title="collections.abc.Callable">Callable</span></span>
    <span class="p">)</span> <span class="o">=</span> <span class="n"><span title="torch.distributions.Uniform">Uniform</span></span><span class="p">,</span>
    <span class="n">prize_type</span><span class="p">:</span> <span class="n"><span title="str">str</span></span> <span class="o">=</span> <span class="s2">&quot;dist&quot;</span><span class="p">,</span>
    <span class="n">max_length</span><span class="p">:</span> <span class="n"><span title="float">float</span></span> <span class="o">|</span> <span class="n"><span title="torch.Tensor">Tensor</span></span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents first">
            <p class="doc doc-class-bases">
              Bases: <code><span title="rl4co.envs.common.utils.Generator">Generator</span></code></p>



        <p>Data generator for the Orienteering Problem (OP).</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>num_loc</code></b>
              (<code><span title="int">int</span></code>, default:
                  <code>20</code>
)
          –
          <div class="doc-md-description">
            <p>number of locations (customers) in the OP, without the depot. (e.g. 10 means 10 locs + 1 depot)</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>min_loc</code></b>
              (<code><span title="float">float</span></code>, default:
                  <code>0.0</code>
)
          –
          <div class="doc-md-description">
            <p>minimum value for the location coordinates</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>max_loc</code></b>
              (<code><span title="float">float</span></code>, default:
                  <code>1.0</code>
)
          –
          <div class="doc-md-description">
            <p>maximum value for the location coordinates</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>loc_distribution</code></b>
              (<code><span title="int">int</span> | <span title="float">float</span> | <span title="str">str</span> | <span title="type">type</span> | <span title="collections.abc.Callable">Callable</span></code>, default:
                  <code><span title="torch.distributions.Uniform">Uniform</span></code>
)
          –
          <div class="doc-md-description">
            <p>distribution for the location coordinates</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>depot_distribution</code></b>
              (<code><span title="int">int</span> | <span title="float">float</span> | <span title="str">str</span> | <span title="type">type</span> | <span title="collections.abc.Callable">Callable</span></code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>distribution for the depot location. If None, sample the depot from the locations</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>min_prize</code></b>
              (<code><span title="float">float</span></code>, default:
                  <code>1.0</code>
)
          –
          <div class="doc-md-description">
            <p>minimum value for the prize of each customer</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>max_prize</code></b>
              (<code><span title="float">float</span></code>, default:
                  <code>1.0</code>
)
          –
          <div class="doc-md-description">
            <p>maximum value for the prize of each customer</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>prize_distribution</code></b>
              (<code><span title="int">int</span> | <span title="float">float</span> | <span title="type">type</span> | <span title="collections.abc.Callable">Callable</span></code>, default:
                  <code><span title="torch.distributions.Uniform">Uniform</span></code>
)
          –
          <div class="doc-md-description">
            <p>distribution for the prize of each customer</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>max_length</code></b>
              (<code><span title="float">float</span> | <span title="torch.Tensor">Tensor</span></code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>maximum length of the path</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          –
          <div class="doc-md-description">
            <p>A TensorDict with the following keys:
locs [batch_size, num_loc, 2]: locations of each customer
depot [batch_size, 2]: location of the depot
prize [batch_size, num_loc]: prize of each customer
max_length [batch_size, 1]: maximum length of the path for each customer</p>
          </div>
        </li>
    </ul>













                  <details class="mkdocstrings-source">
                    <summary>Source code in <code>rl4co/envs/routing/op/generator.py</code></summary>
                    <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">num_loc</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span>
    <span class="n">min_loc</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span>
    <span class="n">max_loc</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
    <span class="n">loc_distribution</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">type</span> <span class="o">|</span> <span class="n">Callable</span> <span class="o">=</span> <span class="n">Uniform</span><span class="p">,</span>
    <span class="n">depot_distribution</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">type</span> <span class="o">|</span> <span class="n">Callable</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">min_prize</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
    <span class="n">max_prize</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
    <span class="n">prize_distribution</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">type</span> <span class="o">|</span> <span class="n">Callable</span> <span class="o">=</span> <span class="n">Uniform</span><span class="p">,</span>
    <span class="n">prize_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;dist&quot;</span><span class="p">,</span>
    <span class="n">max_length</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">num_loc</span> <span class="o">=</span> <span class="n">num_loc</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">min_loc</span> <span class="o">=</span> <span class="n">min_loc</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">max_loc</span> <span class="o">=</span> <span class="n">max_loc</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">min_prize</span> <span class="o">=</span> <span class="n">min_prize</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">max_prize</span> <span class="o">=</span> <span class="n">max_prize</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">prize_type</span> <span class="o">=</span> <span class="n">prize_type</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">max_length</span> <span class="o">=</span> <span class="n">max_length</span>

    <span class="c1"># Location distribution</span>
    <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;loc_sampler&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">loc_sampler</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;loc_sampler&quot;</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">loc_sampler</span> <span class="o">=</span> <span class="n">get_sampler</span><span class="p">(</span><span class="s2">&quot;loc&quot;</span><span class="p">,</span> <span class="n">loc_distribution</span><span class="p">,</span> <span class="n">min_loc</span><span class="p">,</span> <span class="n">max_loc</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="c1"># Depot distribution</span>
    <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;depot_sampler&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">depot_sampler</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;depot_sampler&quot;</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">depot_sampler</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">get_sampler</span><span class="p">(</span><span class="s2">&quot;depot&quot;</span><span class="p">,</span> <span class="n">depot_distribution</span><span class="p">,</span> <span class="n">min_loc</span><span class="p">,</span> <span class="n">max_loc</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">depot_distribution</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
            <span class="k">else</span> <span class="kc">None</span>
        <span class="p">)</span>

    <span class="c1"># Prize distribution</span>
    <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;prize_sampler&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">prize_sampler</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;prize_sampler&quot;</span><span class="p">]</span>
    <span class="k">elif</span> <span class="p">(</span>
        <span class="n">prize_distribution</span> <span class="o">==</span> <span class="s2">&quot;dist&quot;</span>
    <span class="p">):</span>  <span class="c1"># If prize_distribution is &#39;dist&#39;, then the prize is the distance from the depot</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">prize_sampler</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">prize_sampler</span> <span class="o">=</span> <span class="n">get_sampler</span><span class="p">(</span>
            <span class="s2">&quot;prize&quot;</span><span class="p">,</span> <span class="n">prize_distribution</span><span class="p">,</span> <span class="n">min_prize</span><span class="p">,</span> <span class="n">max_prize</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
        <span class="p">)</span>

    <span class="c1"># Max length</span>
    <span class="k">if</span> <span class="n">max_length</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">max_length</span> <span class="o">=</span> <span class="n">max_length</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">max_length</span> <span class="o">=</span> <span class="n">MAX_LENGTHS</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">num_loc</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_length</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">closest_num_loc</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">MAX_LENGTHS</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">abs</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">num_loc</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">max_length</span> <span class="o">=</span> <span class="n">MAX_LENGTHS</span><span class="p">[</span><span class="n">closest_num_loc</span><span class="p">]</span>
        <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;The max length for </span><span class="si">{</span><span class="n">num_loc</span><span class="si">}</span><span class="s2"> locations is not defined. Using the closest max length: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">max_length</span><span class="si">}</span><span class="se">\</span>
<span class="s2">                with </span><span class="si">{</span><span class="n">closest_num_loc</span><span class="si">}</span><span class="s2"> locations.&quot;</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
                  </details>



<div class="doc doc-children">












  </div>

    </div>

</div><h2 id="pickup-and-delivery-problem-pdp">Pickup and Delivery Problem (PDP)<a class="headerlink" href="#pickup-and-delivery-problem-pdp" title="Permanent link">&para;</a></h2>


<div class="doc doc-object doc-class">



<h2 id="envs.routing.pdp.env.PDPEnv" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">PDPEnv</span>


<a href="#envs.routing.pdp.env.PDPEnv" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="language-python doc-signature highlight"><pre><span></span><code><span class="nf">PDPEnv</span><span class="p">(</span>
    <span class="n">generator</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-internal" href="#envs.routing.pdp.generator.PDPGenerator">PDPGenerator</a></span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">generator_params</span><span class="p">:</span> <span class="n"><span title="dict">dict</span></span> <span class="o">=</span> <span class="p">{},</span>
    <span class="n">force_start_at_depot</span><span class="p">:</span> <span class="n"><span title="bool">bool</span></span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents first">
            <p class="doc doc-class-bases">
              Bases: <code><span title="rl4co.envs.common.base.RL4COEnvBase">RL4COEnvBase</span></code></p>



        <p>Pickup and Delivery Problem (PDP) environment.
The environment is made of num_loc + 1 locations (cities):</p>
<div class="language-text highlight"><pre><span></span><code>- 1 depot
- `num_loc` / 2 pickup locations
- `num_loc` / 2 delivery locations
</code></pre></div>
<p>The goal is to visit all the pickup and delivery locations in the shortest path possible starting from the depot
The conditions is that the agent must visit a pickup location before visiting its corresponding delivery location</p>


<details class="observations" open>
  <summary>Observations</summary>
  <ul>
<li>locations of the depot, pickup, and delivery locations</li>
<li>current location of the vehicle</li>
<li>the remaining locations to deliver</li>
<li>the visited locations</li>
<li>the current step</li>
</ul>
</details>

<details class="constraints" open>
  <summary>Constraints</summary>
  <ul>
<li>the tour starts and ends at the depot</li>
<li>each pickup location must be visited before its corresponding delivery location</li>
<li>the vehicle cannot visit the same location twice</li>
</ul>
</details>

<details class="finish-condition" open>
  <summary>Finish Condition</summary>
  <ul>
<li>the vehicle has visited all locations</li>
</ul>
</details>

<details class="reward" open>
  <summary>Reward</summary>
  <ul>
<li>(minus) the negative length of the path</li>
</ul>
</details>

<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>generator</code></b>
              (<code><a class="autorefs autorefs-internal" href="#envs.routing.pdp.generator.PDPGenerator">PDPGenerator</a></code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>PDPGenerator instance as the data generator</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>generator_params</code></b>
              (<code><span title="dict">dict</span></code>, default:
                  <code>{}</code>
)
          –
          <div class="doc-md-description">
            <p>parameters for the generator</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>force_start_at_depot</code></b>
              (<code><span title="bool">bool</span></code>, default:
                  <code>False</code>
)
          –
          <div class="doc-md-description">
            <p>whether to force the agent to start at the depot
If False (default), the agent won't consider the depot, which is added in the <code>get_reward</code> method
If True, the only valid action at the first step is to visit the depot (=0)</p>
          </div>
        </li>
    </ul>












<p><span class="doc-section-title">Methods:</span></p>
    <ul>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" href="#envs.routing.pdp.env.PDPEnv.get_num_starts">get_num_starts</a></code></b>
            –
            <div class="doc-md-description">
              <p>Only half of the nodes (i.e. pickup nodes) can be start nodes</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" href="#envs.routing.pdp.env.PDPEnv.select_start_nodes">select_start_nodes</a></code></b>
            –
            <div class="doc-md-description">
              <p>Only nodes from [1 : num_loc // 2 +1] (i.e. pickups) can be selected</p>
            </div>
          </li>
    </ul>



                  <details class="mkdocstrings-source">
                    <summary>Source code in <code>rl4co/envs/routing/pdp/env.py</code></summary>
                    <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">generator</span><span class="p">:</span> <span class="n">PDPGenerator</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">generator_params</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{},</span>
    <span class="n">force_start_at_depot</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="p">):</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">generator</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">generator</span> <span class="o">=</span> <span class="n">PDPGenerator</span><span class="p">(</span><span class="o">**</span><span class="n">generator_params</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">generator</span> <span class="o">=</span> <span class="n">generator</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">force_start_at_depot</span> <span class="o">=</span> <span class="n">force_start_at_depot</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_make_spec</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">generator</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
                  </details>



<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h3 id="envs.routing.pdp.env.PDPEnv.get_num_starts" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">get_num_starts</span>


<a href="#envs.routing.pdp.env.PDPEnv.get_num_starts" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span class="nf">get_num_starts</span><span class="p">(</span><span class="n">td</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Only half of the nodes (i.e. pickup nodes) can be start nodes</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>rl4co/envs/routing/pdp/env.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_num_starts</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">td</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Only half of the nodes (i.e. pickup nodes) can be start nodes&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">td</span><span class="p">[</span><span class="s2">&quot;locs&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="envs.routing.pdp.env.PDPEnv.select_start_nodes" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">select_start_nodes</span>


<a href="#envs.routing.pdp.env.PDPEnv.select_start_nodes" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span class="nf">select_start_nodes</span><span class="p">(</span><span class="n">td</span><span class="p">,</span> <span class="n">num_starts</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Only nodes from [1 : num_loc // 2 +1] (i.e. pickups) can be selected</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>rl4co/envs/routing/pdp/env.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">select_start_nodes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">td</span><span class="p">,</span> <span class="n">num_starts</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Only nodes from [1 : num_loc // 2 +1] (i.e. pickups) can be selected&quot;&quot;&quot;</span>
    <span class="n">num_possible_starts</span> <span class="o">=</span> <span class="p">(</span><span class="n">td</span><span class="p">[</span><span class="s2">&quot;locs&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span>
    <span class="n">selected</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">torch</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">num_starts</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">td</span><span class="o">.</span><span class="n">device</span><span class="p">)</span><span class="o">.</span><span class="n">repeat_interleave</span><span class="p">(</span><span class="n">td</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="o">%</span> <span class="n">num_possible_starts</span>
        <span class="o">+</span> <span class="mi">1</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">selected</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="envs.routing.pdp.generator.PDPGenerator" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">PDPGenerator</span>


<a href="#envs.routing.pdp.generator.PDPGenerator" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="language-python doc-signature highlight"><pre><span></span><code><span class="nf">PDPGenerator</span><span class="p">(</span>
    <span class="n">num_loc</span><span class="p">:</span> <span class="n"><span title="int">int</span></span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span>
    <span class="n">min_loc</span><span class="p">:</span> <span class="n"><span title="float">float</span></span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span>
    <span class="n">max_loc</span><span class="p">:</span> <span class="n"><span title="float">float</span></span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
    <span class="n">init_sol_type</span><span class="p">:</span> <span class="n"><span title="str">str</span></span> <span class="o">=</span> <span class="s2">&quot;random&quot;</span><span class="p">,</span>
    <span class="n">loc_distribution</span><span class="p">:</span> <span class="p">(</span>
        <span class="n"><span title="int">int</span></span> <span class="o">|</span> <span class="n"><span title="float">float</span></span> <span class="o">|</span> <span class="n"><span title="str">str</span></span> <span class="o">|</span> <span class="n"><span title="type">type</span></span> <span class="o">|</span> <span class="n"><span title="collections.abc.Callable">Callable</span></span>
    <span class="p">)</span> <span class="o">=</span> <span class="n"><span title="torch.distributions.Uniform">Uniform</span></span><span class="p">,</span>
    <span class="n">depot_distribution</span><span class="p">:</span> <span class="p">(</span>
        <span class="n"><span title="int">int</span></span> <span class="o">|</span> <span class="n"><span title="float">float</span></span> <span class="o">|</span> <span class="n"><span title="str">str</span></span> <span class="o">|</span> <span class="n"><span title="type">type</span></span> <span class="o">|</span> <span class="n"><span title="collections.abc.Callable">Callable</span></span>
    <span class="p">)</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents first">
            <p class="doc doc-class-bases">
              Bases: <code><span title="rl4co.envs.common.utils.Generator">Generator</span></code></p>



        <p>Data generator for the Pickup and Delivery Problem (PDP).
Args:
    num_loc: number of locations (customers) in the PDP, without the depot. (e.g. 10 means 10 locs + 1 depot)</p>
<div class="language-text highlight"><pre><span></span><code>    - 1 depot
    - `num_loc` / 2 pickup locations
    - `num_loc` / 2 delivery locations
min_loc: minimum value for the location coordinates
max_loc: maximum value for the location coordinates
init_sol_type: the method type used for generating initial solutions (random or greedy)
loc_distribution: distribution for the location coordinates
depot_distribution: distribution for the depot location. If None, sample the depot from the locations
</code></pre></div>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          –
          <div class="doc-md-description">
            <p>A TensorDict with the following keys:
locs [batch_size, num_loc, 2]: locations of each customer
depot [batch_size, 2]: location of the depot</p>
          </div>
        </li>
    </ul>













                  <details class="mkdocstrings-source">
                    <summary>Source code in <code>rl4co/envs/routing/pdp/generator.py</code></summary>
                    <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">num_loc</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span>
    <span class="n">min_loc</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span>
    <span class="n">max_loc</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
    <span class="n">init_sol_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;random&quot;</span><span class="p">,</span>
    <span class="n">loc_distribution</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">type</span> <span class="o">|</span> <span class="n">Callable</span> <span class="o">=</span> <span class="n">Uniform</span><span class="p">,</span>
    <span class="n">depot_distribution</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">type</span> <span class="o">|</span> <span class="n">Callable</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">num_loc</span> <span class="o">=</span> <span class="n">num_loc</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">min_loc</span> <span class="o">=</span> <span class="n">min_loc</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">max_loc</span> <span class="o">=</span> <span class="n">max_loc</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">init_sol_type</span> <span class="o">=</span> <span class="n">init_sol_type</span>

    <span class="c1"># Number of locations must be even</span>
    <span class="k">if</span> <span class="n">num_loc</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Number of locations must be even. Adding 1 to the number of locations.&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">num_loc</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="c1"># Location distribution</span>
    <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;loc_sampler&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">loc_sampler</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;loc_sampler&quot;</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">loc_sampler</span> <span class="o">=</span> <span class="n">get_sampler</span><span class="p">(</span><span class="s2">&quot;loc&quot;</span><span class="p">,</span> <span class="n">loc_distribution</span><span class="p">,</span> <span class="n">min_loc</span><span class="p">,</span> <span class="n">max_loc</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="c1"># Depot distribution</span>
    <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;depot_sampler&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">depot_sampler</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;depot_sampler&quot;</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">depot_sampler</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">get_sampler</span><span class="p">(</span><span class="s2">&quot;depot&quot;</span><span class="p">,</span> <span class="n">depot_distribution</span><span class="p">,</span> <span class="n">min_loc</span><span class="p">,</span> <span class="n">max_loc</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">depot_distribution</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
            <span class="k">else</span> <span class="kc">None</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
                  </details>



<div class="doc doc-children">












  </div>

    </div>

</div><h2 id="prize-collecting-traveling-salesman-problem-pctsp">Prize Collecting Traveling Salesman Problem (PCTSP)<a class="headerlink" href="#prize-collecting-traveling-salesman-problem-pctsp" title="Permanent link">&para;</a></h2>


<div class="doc doc-object doc-class">



<h2 id="envs.routing.pctsp.env.PCTSPEnv" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">PCTSPEnv</span>


<a href="#envs.routing.pctsp.env.PCTSPEnv" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="language-python doc-signature highlight"><pre><span></span><code><span class="nf">PCTSPEnv</span><span class="p">(</span>
    <span class="n">generator</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-internal" href="#envs.routing.pctsp.generator.PCTSPGenerator">PCTSPGenerator</a></span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">generator_params</span><span class="p">:</span> <span class="n"><span title="dict">dict</span></span> <span class="o">=</span> <span class="p">{},</span>
    <span class="o">**</span><span class="n">kwargs</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents first">
            <p class="doc doc-class-bases">
              Bases: <code><span title="rl4co.envs.common.base.RL4COEnvBase">RL4COEnvBase</span></code></p>



        <p>Prize-collecting TSP (PCTSP) environment.
The goal is to collect as much prize as possible while minimizing the total travel cost.
The environment is stochastic, the prize is only revealed when the node is visited.</p>


<details class="observations" open>
  <summary>Observations</summary>
  <ul>
<li>locations of the nodes</li>
<li>prize and penalty of each node</li>
<li>current location of the vehicle</li>
<li>current total prize</li>
<li>current total penalty</li>
<li>visited nodes</li>
<li>prize required to visit a node</li>
<li>the current step</li>
</ul>
</details>

<details class="constraints" open>
  <summary>Constraints</summary>
  <ul>
<li>the tour starts and ends at the depot</li>
<li>the vehicle cannot visit nodes exceed the remaining prize</li>
</ul>
</details>

<details class="finish-condition" open>
  <summary>Finish Condition</summary>
  <ul>
<li>the vehicle back to the depot</li>
</ul>
</details>

<details class="reward" open>
  <summary>Reward</summary>
  <ul>
<li>the sum of the saved penalties</li>
</ul>
</details>

<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>generator</code></b>
              (<code><a class="autorefs autorefs-internal" href="#envs.routing.pctsp.generator.PCTSPGenerator">PCTSPGenerator</a></code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>OPGenerator instance as the data generator</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>generator_params</code></b>
              (<code><span title="dict">dict</span></code>, default:
                  <code>{}</code>
)
          –
          <div class="doc-md-description">
            <p>parameters for the generator</p>
          </div>
        </li>
    </ul>












<p><span class="doc-section-title">Methods:</span></p>
    <ul>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" href="#envs.routing.pctsp.env.PCTSPEnv.get_action_mask">get_action_mask</a></code></b>
            –
            <div class="doc-md-description">
              <p>Cannot visit depot if not yet collected 1 total prize and there are unvisited nodes</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" href="#envs.routing.pctsp.env.PCTSPEnv.check_solution_validity">check_solution_validity</a></code></b>
            –
            <div class="doc-md-description">
              <p>Check that the solution is valid, i.e. contains all nodes once at most, and either prize constraint is met or all nodes are visited</p>
            </div>
          </li>
    </ul>



                  <details class="mkdocstrings-source">
                    <summary>Source code in <code>rl4co/envs/routing/pctsp/env.py</code></summary>
                    <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">generator</span><span class="p">:</span> <span class="n">PCTSPGenerator</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">generator_params</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{},</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="p">):</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">generator</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">generator</span> <span class="o">=</span> <span class="n">PCTSPGenerator</span><span class="p">(</span><span class="o">**</span><span class="n">generator_params</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">generator</span> <span class="o">=</span> <span class="n">generator</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_make_spec</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">generator</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
                  </details>



<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h3 id="envs.routing.pctsp.env.PCTSPEnv.get_action_mask" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">get_action_mask</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#envs.routing.pctsp.env.PCTSPEnv.get_action_mask" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span class="nf">get_action_mask</span><span class="p">(</span><span class="n">td</span><span class="p">:</span> <span class="n"><span title="tensordict.tensordict.TensorDict">TensorDict</span></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="torch.Tensor">Tensor</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Cannot visit depot if not yet collected 1 total prize and there are unvisited nodes</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>rl4co/envs/routing/pctsp/env.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">get_action_mask</span><span class="p">(</span><span class="n">td</span><span class="p">:</span> <span class="n">TensorDict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Cannot visit depot if not yet collected 1 total prize and there are unvisited nodes&quot;&quot;&quot;</span>
    <span class="n">mask</span> <span class="o">=</span> <span class="n">td</span><span class="p">[</span><span class="s2">&quot;visited&quot;</span><span class="p">]</span> <span class="o">|</span> <span class="n">td</span><span class="p">[</span><span class="s2">&quot;visited&quot;</span><span class="p">][</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">mask</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">td</span><span class="p">[</span><span class="s2">&quot;cur_total_prize&quot;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mf">1.0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span>
        <span class="n">td</span><span class="p">[</span><span class="s2">&quot;visited&quot;</span><span class="p">][</span><span class="o">...</span><span class="p">,</span> <span class="mi">1</span><span class="p">:]</span><span class="o">.</span><span class="n">int</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">td</span><span class="p">[</span><span class="s2">&quot;visited&quot;</span><span class="p">][</span><span class="o">...</span><span class="p">,</span> <span class="mi">1</span><span class="p">:]</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="o">~</span><span class="p">(</span><span class="n">mask</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>  <span class="c1"># Invert mask, since 1 means feasible action</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="envs.routing.pctsp.env.PCTSPEnv.check_solution_validity" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">check_solution_validity</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#envs.routing.pctsp.env.PCTSPEnv.check_solution_validity" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span class="nf">check_solution_validity</span><span class="p">(</span>
    <span class="n">td</span><span class="p">:</span> <span class="n"><span title="tensordict.tensordict.TensorDict">TensorDict</span></span><span class="p">,</span> <span class="n">actions</span><span class="p">:</span> <span class="n"><span title="torch.Tensor">Tensor</span></span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Check that the solution is valid, i.e. contains all nodes once at most, and either prize constraint is met or all nodes are visited</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>rl4co/envs/routing/pctsp/env.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">check_solution_validity</span><span class="p">(</span><span class="n">td</span><span class="p">:</span> <span class="n">TensorDict</span><span class="p">,</span> <span class="n">actions</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Check that the solution is valid, i.e. contains all nodes once at most, and either prize constraint is met or all nodes are visited&quot;&quot;&quot;</span>

    <span class="c1"># Check that tours are valid, i.e. contain 0 to n -1</span>
    <span class="n">sorted_actions</span> <span class="o">=</span> <span class="n">actions</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

    <span class="c1"># Make sure each node visited once at most (except for depot)</span>
    <span class="k">assert</span> <span class="p">(</span>
        <span class="p">(</span><span class="n">sorted_actions</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">1</span><span class="p">:]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">sorted_actions</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">1</span><span class="p">:]</span> <span class="o">&gt;</span> <span class="n">sorted_actions</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
    <span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">(),</span> <span class="s2">&quot;Duplicates&quot;</span>

    <span class="n">prize</span> <span class="o">=</span> <span class="n">td</span><span class="p">[</span><span class="s2">&quot;real_prize&quot;</span><span class="p">][</span><span class="o">...</span><span class="p">,</span> <span class="mi">1</span><span class="p">:]</span>  <span class="c1"># Remove depot</span>
    <span class="n">prize_with_depot</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">((</span><span class="n">torch</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">prize</span><span class="p">[:,</span> <span class="p">:</span><span class="mi">1</span><span class="p">]),</span> <span class="n">prize</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">prize_with_depot</span><span class="o">.</span><span class="n">gather</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">actions</span><span class="p">)</span>

    <span class="c1"># Either prize constraint should be satisfied or all prizes should be visited</span>
    <span class="k">assert</span> <span class="p">(</span>
        <span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">1</span> <span class="o">-</span> <span class="mf">1e-5</span><span class="p">)</span>
        <span class="o">|</span> <span class="p">(</span>
            <span class="n">sorted_actions</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">sorted_actions</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">int</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="o">==</span> <span class="p">(</span><span class="n">td</span><span class="p">[</span><span class="s2">&quot;locs&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
        <span class="p">)</span>  <span class="c1"># no depot</span>
    <span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">(),</span> <span class="s2">&quot;Total prize does not satisfy min total prize&quot;</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="envs.routing.pctsp.generator.PCTSPGenerator" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">PCTSPGenerator</span>


<a href="#envs.routing.pctsp.generator.PCTSPGenerator" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="language-python doc-signature highlight"><pre><span></span><code><span class="nf">PCTSPGenerator</span><span class="p">(</span>
    <span class="n">num_loc</span><span class="p">:</span> <span class="n"><span title="int">int</span></span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span>
    <span class="n">min_loc</span><span class="p">:</span> <span class="n"><span title="float">float</span></span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span>
    <span class="n">max_loc</span><span class="p">:</span> <span class="n"><span title="float">float</span></span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
    <span class="n">loc_distribution</span><span class="p">:</span> <span class="p">(</span>
        <span class="n"><span title="int">int</span></span> <span class="o">|</span> <span class="n"><span title="float">float</span></span> <span class="o">|</span> <span class="n"><span title="str">str</span></span> <span class="o">|</span> <span class="n"><span title="type">type</span></span> <span class="o">|</span> <span class="n"><span title="collections.abc.Callable">Callable</span></span>
    <span class="p">)</span> <span class="o">=</span> <span class="n"><span title="torch.distributions.Uniform">Uniform</span></span><span class="p">,</span>
    <span class="n">depot_distribution</span><span class="p">:</span> <span class="p">(</span>
        <span class="n"><span title="int">int</span></span> <span class="o">|</span> <span class="n"><span title="float">float</span></span> <span class="o">|</span> <span class="n"><span title="str">str</span></span> <span class="o">|</span> <span class="n"><span title="type">type</span></span> <span class="o">|</span> <span class="n"><span title="collections.abc.Callable">Callable</span></span>
    <span class="p">)</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">penalty_factor</span><span class="p">:</span> <span class="n"><span title="float">float</span></span> <span class="o">=</span> <span class="mf">3.0</span><span class="p">,</span>
    <span class="n">prize_required</span><span class="p">:</span> <span class="n"><span title="float">float</span></span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents first">
            <p class="doc doc-class-bases">
              Bases: <code><span title="rl4co.envs.common.utils.Generator">Generator</span></code></p>



        <p>Data generator for the Prize-collecting Traveling Salesman Problem (PCTSP).</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>num_loc</code></b>
              (<code><span title="int">int</span></code>, default:
                  <code>20</code>
)
          –
          <div class="doc-md-description">
            <p>number of locations (customers) in the VRP, without the depot. (e.g. 10 means 10 locs + 1 depot)</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>min_loc</code></b>
              (<code><span title="float">float</span></code>, default:
                  <code>0.0</code>
)
          –
          <div class="doc-md-description">
            <p>minimum value for the location coordinates</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>max_loc</code></b>
              (<code><span title="float">float</span></code>, default:
                  <code>1.0</code>
)
          –
          <div class="doc-md-description">
            <p>maximum value for the location coordinates</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>loc_distribution</code></b>
              (<code><span title="int">int</span> | <span title="float">float</span> | <span title="str">str</span> | <span title="type">type</span> | <span title="collections.abc.Callable">Callable</span></code>, default:
                  <code><span title="torch.distributions.Uniform">Uniform</span></code>
)
          –
          <div class="doc-md-description">
            <p>distribution for the location coordinates</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>depot_distribution</code></b>
              (<code><span title="int">int</span> | <span title="float">float</span> | <span title="str">str</span> | <span title="type">type</span> | <span title="collections.abc.Callable">Callable</span></code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>distribution for the depot location. If None, sample the depot from the locations</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>min_demand</code></b>
          –
          <div class="doc-md-description">
            <p>minimum value for the demand of each customer</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>max_demand</code></b>
          –
          <div class="doc-md-description">
            <p>maximum value for the demand of each customer</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>demand_distribution</code></b>
          –
          <div class="doc-md-description">
            <p>distribution for the demand of each customer</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>capacity</code></b>
          –
          <div class="doc-md-description">
            <p>capacity of the vehicle</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          –
          <div class="doc-md-description">
            <p>A TensorDict with the following keys:
locs [batch_size, num_loc, 2]: locations of each city
depot [batch_size, 2]: location of the depot
demand [batch_size, num_loc]: demand of each customer
capacity [batch_size, 1]: capacity of the vehicle</p>
          </div>
        </li>
    </ul>













                  <details class="mkdocstrings-source">
                    <summary>Source code in <code>rl4co/envs/routing/pctsp/generator.py</code></summary>
                    <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">num_loc</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span>
    <span class="n">min_loc</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span>
    <span class="n">max_loc</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
    <span class="n">loc_distribution</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">type</span> <span class="o">|</span> <span class="n">Callable</span> <span class="o">=</span> <span class="n">Uniform</span><span class="p">,</span>
    <span class="n">depot_distribution</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">type</span> <span class="o">|</span> <span class="n">Callable</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">penalty_factor</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">3.0</span><span class="p">,</span>
    <span class="n">prize_required</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">num_loc</span> <span class="o">=</span> <span class="n">num_loc</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">min_loc</span> <span class="o">=</span> <span class="n">min_loc</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">max_loc</span> <span class="o">=</span> <span class="n">max_loc</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">penalty_fctor</span> <span class="o">=</span> <span class="n">penalty_factor</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">prize_required</span> <span class="o">=</span> <span class="n">prize_required</span>

    <span class="c1"># Location distribution</span>
    <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;loc_sampler&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">loc_sampler</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;loc_sampler&quot;</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">loc_sampler</span> <span class="o">=</span> <span class="n">get_sampler</span><span class="p">(</span><span class="s2">&quot;loc&quot;</span><span class="p">,</span> <span class="n">loc_distribution</span><span class="p">,</span> <span class="n">min_loc</span><span class="p">,</span> <span class="n">max_loc</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="c1"># Depot distribution</span>
    <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;depot_sampler&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">depot_sampler</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;depot_sampler&quot;</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">depot_sampler</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">get_sampler</span><span class="p">(</span><span class="s2">&quot;depot&quot;</span><span class="p">,</span> <span class="n">depot_distribution</span><span class="p">,</span> <span class="n">min_loc</span><span class="p">,</span> <span class="n">max_loc</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">depot_distribution</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
            <span class="k">else</span> <span class="kc">None</span>
        <span class="p">)</span>

    <span class="c1"># Prize distribution</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">deterministic_prize_sampler</span> <span class="o">=</span> <span class="n">get_sampler</span><span class="p">(</span>
        <span class="s2">&quot;deterministric_prize&quot;</span><span class="p">,</span> <span class="s2">&quot;uniform&quot;</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">4.0</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_loc</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
    <span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">stochastic_prize_sampler</span> <span class="o">=</span> <span class="n">get_sampler</span><span class="p">(</span>
        <span class="s2">&quot;stochastic_prize&quot;</span><span class="p">,</span> <span class="s2">&quot;uniform&quot;</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
    <span class="p">)</span>

    <span class="c1"># For the penalty to make sense it should be not too large (in which case all nodes will be visited) nor too small</span>
    <span class="c1"># so we want the objective term to be approximately equal to the length of the tour, which we estimate with half</span>
    <span class="c1"># of the nodes by half of the tour length (which is very rough but similar to op)</span>
    <span class="c1"># This means that the sum of penalties for all nodes will be approximately equal to the tour length (on average)</span>
    <span class="c1"># The expected total (uniform) penalty of half of the nodes (since approx half will be visited by the constraint)</span>
    <span class="c1"># is (n / 2) / 2 = n / 4 so divide by this means multiply by 4 / n,</span>
    <span class="c1"># However instead of 4 we use penalty_factor (3 works well) so we can make them larger or smaller</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">max_penalty</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;max_penalty&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_penalty</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># If not provided, use the default max penalty</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">max_penalty</span> <span class="o">=</span> <span class="n">MAX_LENGTHS</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">num_loc</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="k">if</span> <span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">max_penalty</span> <span class="ow">is</span> <span class="kc">None</span>
    <span class="p">):</span>  <span class="c1"># If not in the table keys, find the closest number of nodes as the key</span>
        <span class="n">closest_num_loc</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">MAX_LENGTHS</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">abs</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">num_loc</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">max_penalty</span> <span class="o">=</span> <span class="n">MAX_LENGTHS</span><span class="p">[</span><span class="n">closest_num_loc</span><span class="p">]</span>
        <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;The max penalty for </span><span class="si">{</span><span class="n">num_loc</span><span class="si">}</span><span class="s2"> locations is not defined. Using the closest max penalty: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">max_penalty</span><span class="si">}</span><span class="se">\</span>
<span class="s2">                with </span><span class="si">{</span><span class="n">closest_num_loc</span><span class="si">}</span><span class="s2"> locations.&quot;</span>
        <span class="p">)</span>

    <span class="c1"># Adjust as in Kool et al. (2019)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">max_penalty</span> <span class="o">*=</span> <span class="n">penalty_factor</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_loc</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">penalty_sampler</span> <span class="o">=</span> <span class="n">get_sampler</span><span class="p">(</span><span class="s2">&quot;penalty&quot;</span><span class="p">,</span> <span class="s2">&quot;uniform&quot;</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_penalty</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
                  </details>



<div class="doc doc-children">












  </div>

    </div>

</div><h2 id="split-delivery-vehicle-routing-problem-sdvrp">Split Delivery Vehicle Routing Problem (SDVRP)<a class="headerlink" href="#split-delivery-vehicle-routing-problem-sdvrp" title="Permanent link">&para;</a></h2>


<div class="doc doc-object doc-class">



<h2 id="envs.routing.sdvrp.env.SDVRPEnv" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">SDVRPEnv</span>


<a href="#envs.routing.sdvrp.env.SDVRPEnv" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="language-python doc-signature highlight"><pre><span></span><code><span class="nf">SDVRPEnv</span><span class="p">(</span>
    <span class="n">generator</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-internal" href="#envs.routing.cvrp.generator.CVRPGenerator">CVRPGenerator</a></span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">generator_params</span><span class="p">:</span> <span class="n"><span title="dict">dict</span></span> <span class="o">=</span> <span class="p">{},</span>
    <span class="o">**</span><span class="n">kwargs</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents first">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" href="#envs.routing.cvrp.env.CVRPEnv">CVRPEnv</a></code></p>



        <p>Split Delivery Vehicle Routing Problem (SDVRP) environment.
SDVRP is a generalization of CVRP, where nodes can be visited multiple times and a fraction of the demand can be met.
At each step, the agent chooses a customer to visit depending on the current location and the remaining capacity.
When the agent visits a customer, the remaining capacity is updated. If the remaining capacity is not enough to
visit any customer, the agent must go back to the depot. The reward is the -infinite unless the agent visits all the customers.
In that case, the reward is (-)length of the path: maximizing the reward is equivalent to minimizing the path length.</p>


<details class="observations" open>
  <summary>Observations</summary>
  <ul>
<li>location of the depot.</li>
<li>locations and demand/remaining demand of each customer</li>
<li>current location of the vehicle.</li>
<li>the remaining capacity of the vehicle.</li>
</ul>
</details>

<details class="constraints" open>
  <summary>Constraints</summary>
  <ul>
<li>the tour starts and ends at the depot.</li>
<li>each customer can be visited multiple times.</li>
<li>the vehicle cannot visit customers exceed the remaining capacity.</li>
<li>the vehicle can return to the depot to refill the capacity.</li>
</ul>
</details>

<details class="finish-condition" open>
  <summary>Finish Condition</summary>
  <ul>
<li>the vehicle has finished all customers demand and returned to the depot.</li>
</ul>
</details>

<details class="reward" open>
  <summary>Reward</summary>
  <ul>
<li>(minus) the negative length of the path.</li>
</ul>
</details>

<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>generator</code></b>
              (<code><a class="autorefs autorefs-internal" href="#envs.routing.cvrp.generator.CVRPGenerator">CVRPGenerator</a></code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>CVRPGenerator instance as the data generator</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>generator_params</code></b>
              (<code><span title="dict">dict</span></code>, default:
                  <code>{}</code>
)
          –
          <div class="doc-md-description">
            <p>parameters for the generator</p>
          </div>
        </li>
    </ul>












<p><span class="doc-section-title">Methods:</span></p>
    <ul>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" href="#envs.routing.sdvrp.env.SDVRPEnv.check_solution_validity">check_solution_validity</a></code></b>
            –
            <div class="doc-md-description">
              <p>Check that the solution is valid (all demand is satisfied)</p>
            </div>
          </li>
    </ul>



                  <details class="mkdocstrings-source">
                    <summary>Source code in <code>rl4co/envs/routing/sdvrp/env.py</code></summary>
                    <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">generator</span><span class="p">:</span> <span class="n">CVRPGenerator</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">generator_params</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{},</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="p">):</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">generator</span><span class="p">,</span> <span class="n">generator_params</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
                  </details>



<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h3 id="envs.routing.sdvrp.env.SDVRPEnv.check_solution_validity" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">check_solution_validity</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#envs.routing.sdvrp.env.SDVRPEnv.check_solution_validity" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span class="nf">check_solution_validity</span><span class="p">(</span>
    <span class="n">td</span><span class="p">:</span> <span class="n"><span title="tensordict.tensordict.TensorDict">TensorDict</span></span><span class="p">,</span> <span class="n">actions</span><span class="p">:</span> <span class="n"><span title="torch.Tensor">Tensor</span></span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Check that the solution is valid (all demand is satisfied)</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>rl4co/envs/routing/sdvrp/env.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">check_solution_validity</span><span class="p">(</span><span class="n">td</span><span class="p">:</span> <span class="n">TensorDict</span><span class="p">,</span> <span class="n">actions</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Check that the solution is valid (all demand is satisfied)&quot;&quot;&quot;</span>

    <span class="n">batch_size</span><span class="p">,</span> <span class="n">graph_size</span> <span class="o">=</span> <span class="n">td</span><span class="p">[</span><span class="s2">&quot;demand&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">size</span><span class="p">()</span>

    <span class="c1"># Each node can be visited multiple times, but we always deliver as much demand as possible</span>
    <span class="c1"># We check that at the end all demand has been satisfied</span>
    <span class="n">demands</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">((</span><span class="o">-</span><span class="n">td</span><span class="p">[</span><span class="s2">&quot;vehicle_capacity&quot;</span><span class="p">],</span> <span class="n">td</span><span class="p">[</span><span class="s2">&quot;demand&quot;</span><span class="p">]),</span> <span class="mi">1</span><span class="p">)</span>

    <span class="n">rng</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">batch_size</span><span class="p">,</span> <span class="n">out</span><span class="o">=</span><span class="n">demands</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">new</span><span class="p">()</span><span class="o">.</span><span class="n">long</span><span class="p">())</span>
    <span class="n">used_cap</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">td</span><span class="p">[</span><span class="s2">&quot;demand&quot;</span><span class="p">][</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
    <span class="n">a_prev</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">actions</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span>
        <span class="k">assert</span> <span class="n">a_prev</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="p">(</span><span class="n">demands</span><span class="p">[((</span><span class="n">a_prev</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">a</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)),</span> <span class="p">:]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">(),</span> <span class="p">(</span>
            <span class="s2">&quot;Cannot visit depot twice if any nonzero demand&quot;</span>
        <span class="p">)</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">demands</span><span class="p">[</span><span class="n">rng</span><span class="p">,</span> <span class="n">a</span><span class="p">],</span> <span class="n">td</span><span class="p">[</span><span class="s2">&quot;vehicle_capacity&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">used_cap</span><span class="p">)</span>
        <span class="n">demands</span><span class="p">[</span><span class="n">rng</span><span class="p">,</span> <span class="n">a</span><span class="p">]</span> <span class="o">-=</span> <span class="n">d</span>
        <span class="n">used_cap</span> <span class="o">+=</span> <span class="n">d</span>
        <span class="n">used_cap</span><span class="p">[</span><span class="n">a</span> <span class="o">==</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">a_prev</span> <span class="o">=</span> <span class="n">a</span>
    <span class="k">assert</span> <span class="p">(</span><span class="n">demands</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">(),</span> <span class="s2">&quot;All demand must be satisfied&quot;</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div><h2 id="stochastic-prize-collecting-traveling-salesman-problem-spctsp">Stochastic Prize Collecting Traveling Salesman Problem (SPCTSP)<a class="headerlink" href="#stochastic-prize-collecting-traveling-salesman-problem-spctsp" title="Permanent link">&para;</a></h2>


<div class="doc doc-object doc-class">



<h2 id="envs.routing.spctsp.env.SPCTSPEnv" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">SPCTSPEnv</span>


<a href="#envs.routing.spctsp.env.SPCTSPEnv" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="language-python doc-signature highlight"><pre><span></span><code><span class="nf">SPCTSPEnv</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents first">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" href="#envs.routing.pctsp.env.PCTSPEnv">PCTSPEnv</a></code></p>



        <p>Stochastic Prize Collecting Traveling Salesman Problem (SPCTSP) environment.</p>


<details class="note" open>
  <summary>Note</summary>
  <p>The only difference with deterministic PCTSP is that the prizes are stochastic
(i.e. the expected prize is not the same as the real prize).</p>
</details>












                  <details class="mkdocstrings-source">
                    <summary>Source code in <code>rl4co/envs/routing/spctsp/env.py</code></summary>
                    <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">19</span>
<span class="normal">20</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
                  </details>



<div class="doc doc-children">












  </div>

    </div>

</div><h2 id="traveling-salesman-problem-tsp">Traveling Salesman Problem (TSP)<a class="headerlink" href="#traveling-salesman-problem-tsp" title="Permanent link">&para;</a></h2>


<div class="doc doc-object doc-class">



<h2 id="envs.routing.tsp.env.TSPEnv" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">TSPEnv</span>


<a href="#envs.routing.tsp.env.TSPEnv" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="language-python doc-signature highlight"><pre><span></span><code><span class="nf">TSPEnv</span><span class="p">(</span>
    <span class="n">generator</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-internal" href="#envs.routing.tsp.generator.TSPGenerator">TSPGenerator</a></span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">generator_params</span><span class="p">:</span> <span class="n"><span title="dict">dict</span></span> <span class="o">=</span> <span class="p">{},</span>
    <span class="o">**</span><span class="n">kwargs</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents first">
            <p class="doc doc-class-bases">
              Bases: <code><span title="rl4co.envs.common.base.RL4COEnvBase">RL4COEnvBase</span></code></p>



        <p>Traveling Salesman Problem (TSP) environment
At each step, the agent chooses a city to visit. The reward is 0 unless the agent visits all the cities.
In that case, the reward is (-)length of the path: maximizing the reward is equivalent to minimizing the path length.</p>


<details class="observations" open>
  <summary>Observations</summary>
  <ul>
<li>locations of each customer.</li>
<li>the current location of the vehicle.</li>
</ul>
</details>

<details class="constraints" open>
  <summary>Constraints</summary>
  <ul>
<li>the tour must return to the starting customer.</li>
<li>each customer must be visited exactly once.</li>
</ul>
</details>

<details class="finish-condition" open>
  <summary>Finish condition</summary>
  <ul>
<li>the agent has visited all customers and returned to the starting customer.</li>
</ul>
</details>

<details class="reward" open>
  <summary>Reward</summary>
  <ul>
<li>(minus) the negative length of the path.</li>
</ul>
</details>

<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>generator</code></b>
              (<code><a class="autorefs autorefs-internal" href="#envs.routing.tsp.generator.TSPGenerator">TSPGenerator</a></code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>TSPGenerator instance as the data generator</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>generator_params</code></b>
              (<code><span title="dict">dict</span></code>, default:
                  <code>{}</code>
)
          –
          <div class="doc-md-description">
            <p>parameters for the generator</p>
          </div>
        </li>
    </ul>












<p><span class="doc-section-title">Methods:</span></p>
    <ul>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" href="#envs.routing.tsp.env.TSPEnv.check_solution_validity">check_solution_validity</a></code></b>
            –
            <div class="doc-md-description">
              <p>Check that solution is valid: nodes are visited exactly once</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" href="#envs.routing.tsp.env.TSPEnv.replace_selected_actions">replace_selected_actions</a></code></b>
            –
            <div class="doc-md-description">
              <p>Replace selected current actions with updated actions based on <code>selection_mask</code>.</p>
            </div>
          </li>
    </ul>



                  <details class="mkdocstrings-source">
                    <summary>Source code in <code>rl4co/envs/routing/tsp/env.py</code></summary>
                    <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">generator</span><span class="p">:</span> <span class="n">TSPGenerator</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">generator_params</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{},</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="p">):</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">generator</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">generator</span> <span class="o">=</span> <span class="n">TSPGenerator</span><span class="p">(</span><span class="o">**</span><span class="n">generator_params</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">generator</span> <span class="o">=</span> <span class="n">generator</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_make_spec</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">generator</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
                  </details>



<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h3 id="envs.routing.tsp.env.TSPEnv.check_solution_validity" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">check_solution_validity</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#envs.routing.tsp.env.TSPEnv.check_solution_validity" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span class="nf">check_solution_validity</span><span class="p">(</span>
    <span class="n">td</span><span class="p">:</span> <span class="n"><span title="tensordict.tensordict.TensorDict">TensorDict</span></span><span class="p">,</span> <span class="n">actions</span><span class="p">:</span> <span class="n"><span title="torch.Tensor">Tensor</span></span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Check that solution is valid: nodes are visited exactly once</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>rl4co/envs/routing/tsp/env.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">check_solution_validity</span><span class="p">(</span><span class="n">td</span><span class="p">:</span> <span class="n">TensorDict</span><span class="p">,</span> <span class="n">actions</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Check that solution is valid: nodes are visited exactly once&quot;&quot;&quot;</span>
    <span class="k">assert</span> <span class="p">(</span>
        <span class="n">torch</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">actions</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">out</span><span class="o">=</span><span class="n">actions</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">new</span><span class="p">())</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">expand_as</span><span class="p">(</span><span class="n">actions</span><span class="p">)</span>
        <span class="o">==</span> <span class="n">actions</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">(),</span> <span class="s2">&quot;Invalid tour&quot;</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="envs.routing.tsp.env.TSPEnv.replace_selected_actions" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">replace_selected_actions</span>


<a href="#envs.routing.tsp.env.TSPEnv.replace_selected_actions" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span class="nf">replace_selected_actions</span><span class="p">(</span>
    <span class="n">cur_actions</span><span class="p">:</span> <span class="n"><span title="torch.Tensor">Tensor</span></span><span class="p">,</span>
    <span class="n">new_actions</span><span class="p">:</span> <span class="n"><span title="torch.Tensor">Tensor</span></span><span class="p">,</span>
    <span class="n">selection_mask</span><span class="p">:</span> <span class="n"><span title="torch.Tensor">Tensor</span></span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="torch.Tensor">Tensor</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Replace selected current actions with updated actions based on <code>selection_mask</code>.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>rl4co/envs/routing/tsp/env.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">replace_selected_actions</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">cur_actions</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span>
    <span class="n">new_actions</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span>
    <span class="n">selection_mask</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Replace selected current actions with updated actions based on `selection_mask`.</span>

<span class="sd">    Args:</span>
<span class="sd">        cur_actions [batch_size, num_loc]</span>
<span class="sd">        new_actions [batch_size, num_loc]</span>
<span class="sd">        selection_mask [batch_size,]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">cur_actions</span><span class="p">[</span><span class="n">selection_mask</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_actions</span><span class="p">[</span><span class="n">selection_mask</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">cur_actions</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="envs.routing.tsp.generator.TSPGenerator" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">TSPGenerator</span>


<a href="#envs.routing.tsp.generator.TSPGenerator" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="language-python doc-signature highlight"><pre><span></span><code><span class="nf">TSPGenerator</span><span class="p">(</span>
    <span class="n">num_loc</span><span class="p">:</span> <span class="n"><span title="int">int</span></span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span>
    <span class="n">min_loc</span><span class="p">:</span> <span class="n"><span title="float">float</span></span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span>
    <span class="n">max_loc</span><span class="p">:</span> <span class="n"><span title="float">float</span></span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
    <span class="n">init_sol_type</span><span class="p">:</span> <span class="n"><span title="str">str</span></span> <span class="o">=</span> <span class="s2">&quot;random&quot;</span><span class="p">,</span>
    <span class="n">loc_distribution</span><span class="p">:</span> <span class="p">(</span>
        <span class="n"><span title="int">int</span></span> <span class="o">|</span> <span class="n"><span title="float">float</span></span> <span class="o">|</span> <span class="n"><span title="str">str</span></span> <span class="o">|</span> <span class="n"><span title="type">type</span></span> <span class="o">|</span> <span class="n"><span title="collections.abc.Callable">Callable</span></span>
    <span class="p">)</span> <span class="o">=</span> <span class="n"><span title="torch.distributions.Uniform">Uniform</span></span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents first">
            <p class="doc doc-class-bases">
              Bases: <code><span title="rl4co.envs.common.utils.Generator">Generator</span></code></p>



        <p>Data generator for the Travelling Salesman Problem (TSP).</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>num_loc</code></b>
              (<code><span title="int">int</span></code>, default:
                  <code>20</code>
)
          –
          <div class="doc-md-description">
            <p>number of locations (customers) in the TSP</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>min_loc</code></b>
              (<code><span title="float">float</span></code>, default:
                  <code>0.0</code>
)
          –
          <div class="doc-md-description">
            <p>minimum value for the location coordinates</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>max_loc</code></b>
              (<code><span title="float">float</span></code>, default:
                  <code>1.0</code>
)
          –
          <div class="doc-md-description">
            <p>maximum value for the location coordinates</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>init_sol_type</code></b>
              (<code><span title="str">str</span></code>, default:
                  <code>&#39;random&#39;</code>
)
          –
          <div class="doc-md-description">
            <p>the method type used for generating initial solutions (random or greedy)</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>loc_distribution</code></b>
              (<code><span title="int">int</span> | <span title="float">float</span> | <span title="str">str</span> | <span title="type">type</span> | <span title="collections.abc.Callable">Callable</span></code>, default:
                  <code><span title="torch.distributions.Uniform">Uniform</span></code>
)
          –
          <div class="doc-md-description">
            <p>distribution for the location coordinates</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          –
          <div class="doc-md-description">
            <p>A TensorDict with the following keys:
locs [batch_size, num_loc, 2]: locations of each customer</p>
          </div>
        </li>
    </ul>













                  <details class="mkdocstrings-source">
                    <summary>Source code in <code>rl4co/envs/routing/tsp/generator.py</code></summary>
                    <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">num_loc</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span>
    <span class="n">min_loc</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span>
    <span class="n">max_loc</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
    <span class="n">init_sol_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;random&quot;</span><span class="p">,</span>
    <span class="n">loc_distribution</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">type</span> <span class="o">|</span> <span class="n">Callable</span> <span class="o">=</span> <span class="n">Uniform</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">num_loc</span> <span class="o">=</span> <span class="n">num_loc</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">min_loc</span> <span class="o">=</span> <span class="n">min_loc</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">max_loc</span> <span class="o">=</span> <span class="n">max_loc</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">init_sol_type</span> <span class="o">=</span> <span class="n">init_sol_type</span>

    <span class="c1"># Location distribution</span>
    <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;loc_sampler&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">loc_sampler</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;loc_sampler&quot;</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">loc_sampler</span> <span class="o">=</span> <span class="n">get_sampler</span><span class="p">(</span><span class="s2">&quot;loc&quot;</span><span class="p">,</span> <span class="n">loc_distribution</span><span class="p">,</span> <span class="n">min_loc</span><span class="p">,</span> <span class="n">max_loc</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
                  </details>



<div class="doc doc-children">












  </div>

    </div>

</div><h2 id="multi-task-vehicle-routing-problem-mtvrp">Multi-Task Vehicle Routing Problem (MTVRP)<a class="headerlink" href="#multi-task-vehicle-routing-problem-mtvrp" title="Permanent link">&para;</a></h2>
<p><a name="Multi-Task-Vehicle-Routing-Problem-(MTVRP)"></a></p>


<div class="doc doc-object doc-class">



<h2 id="envs.routing.mtvrp.env.MTVRPEnv" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">MTVRPEnv</span>


<a href="#envs.routing.mtvrp.env.MTVRPEnv" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="language-python doc-signature highlight"><pre><span></span><code><span class="nf">MTVRPEnv</span><span class="p">(</span>
    <span class="n">generator</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-internal" href="#envs.routing.mtvrp.generator.MTVRPGenerator">MTVRPGenerator</a></span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">generator_params</span><span class="p">:</span> <span class="n"><span title="dict">dict</span></span> <span class="o">=</span> <span class="p">{},</span>
    <span class="n">check_solution</span><span class="p">:</span> <span class="n"><span title="bool">bool</span></span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents first">
            <p class="doc doc-class-bases">
              Bases: <code><span title="rl4co.envs.common.base.RL4COEnvBase">RL4COEnvBase</span></code></p>



        <p>MTVRPEnv is a Multi-Task VRP environment which can take any combination of the following constraints:</p>
<p>Features:</p>
<ul>
<li><em>Capacity (C)</em>
    - Each vehicle has a maximum capacity <span class="arithmatex">\(Q\)</span>, restricting the total load that can be in the vehicle at any point of the route.
    - The route must be planned such that the sum of demands and pickups for all customers visited does not exceed this capacity.</li>
<li><em>Time Windows (TW)</em>
    - Every node <span class="arithmatex">\(i\)</span> has an associated time window <span class="arithmatex">\([e_i, l_i]\)</span> during which service must commence.
    - Additionally, each node has a service time <span class="arithmatex">\(s_i\)</span>. Vehicles must reach node <span class="arithmatex">\(i\)</span> within its time window; early arrivals must wait at the node location until time <span class="arithmatex">\(e_i\)</span>.</li>
<li><em>Open Routes (O)</em>
    - Vehicles are not required to return to the depot after serving all customers.
    - Note that this does not need to be counted as a constraint since it can be modelled by setting zero costs on arcs returning to the depot <span class="arithmatex">\(c_{i0} = 0\)</span> from any customer <span class="arithmatex">\(i \in C\)</span>, and not counting the return arc as part of the route.</li>
<li><em>Backhauls (B)</em>
    - Backhauls generalize demand to also account for return shipments. Customers are either linehaul or backhaul customers.
    - Linehaul customers require delivery of a demand <span class="arithmatex">\(q_i &gt; 0\)</span> that needs to be transported from the depot to the customer, whereas backhaul customers need a pickup of an amount <span class="arithmatex">\(p_i &gt; 0\)</span> that is transported from the client back to the depot.
    - It is possible for vehicles to serve a combination of linehaul and backhaul customers in a single route, but then any linehaul customers must precede the backhaul customers in the route.</li>
<li><em>Duration Limits (L)</em>
    - Imposes a limit on the total travel duration (or length) of each route, ensuring a balanced workload across vehicles.</li>
</ul>
<p>The environment covers the following 16 variants depending on the data generation:</p>
<table>
<thead>
<tr>
<th style="text-align: left;">VRP Variant</th>
<th style="text-align: center;">Capacity (C)</th>
<th style="text-align: center;">Open Route (O)</th>
<th style="text-align: center;">Backhaul (B)</th>
<th style="text-align: center;">Duration Limit (L)</th>
<th style="text-align: center;">Time Window (TW)</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">CVRP</td>
<td style="text-align: center;">✔</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr>
<td style="text-align: left;">OVRP</td>
<td style="text-align: center;">✔</td>
<td style="text-align: center;">✔</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr>
<td style="text-align: left;">VRPB</td>
<td style="text-align: center;">✔</td>
<td style="text-align: center;"></td>
<td style="text-align: center;">✔</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr>
<td style="text-align: left;">VRPL</td>
<td style="text-align: center;">✔</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;">✔</td>
<td style="text-align: center;"></td>
</tr>
<tr>
<td style="text-align: left;">VRPTW</td>
<td style="text-align: center;">✔</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;">✔</td>
</tr>
<tr>
<td style="text-align: left;">OVRPTW</td>
<td style="text-align: center;">✔</td>
<td style="text-align: center;">✔</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;">✔</td>
</tr>
<tr>
<td style="text-align: left;">OVRPB</td>
<td style="text-align: center;">✔</td>
<td style="text-align: center;">✔</td>
<td style="text-align: center;">✔</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr>
<td style="text-align: left;">OVRPL</td>
<td style="text-align: center;">✔</td>
<td style="text-align: center;">✔</td>
<td style="text-align: center;"></td>
<td style="text-align: center;">✔</td>
<td style="text-align: center;"></td>
</tr>
<tr>
<td style="text-align: left;">VRPBL</td>
<td style="text-align: center;">✔</td>
<td style="text-align: center;"></td>
<td style="text-align: center;">✔</td>
<td style="text-align: center;">✔</td>
<td style="text-align: center;"></td>
</tr>
<tr>
<td style="text-align: left;">VRPBTW</td>
<td style="text-align: center;">✔</td>
<td style="text-align: center;"></td>
<td style="text-align: center;">✔</td>
<td style="text-align: center;"></td>
<td style="text-align: center;">✔</td>
</tr>
<tr>
<td style="text-align: left;">VRPLTW</td>
<td style="text-align: center;">✔</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;">✔</td>
<td style="text-align: center;">✔</td>
</tr>
<tr>
<td style="text-align: left;">OVRPBL</td>
<td style="text-align: center;">✔</td>
<td style="text-align: center;">✔</td>
<td style="text-align: center;">✔</td>
<td style="text-align: center;">✔</td>
<td style="text-align: center;"></td>
</tr>
<tr>
<td style="text-align: left;">OVRPBTW</td>
<td style="text-align: center;">✔</td>
<td style="text-align: center;">✔</td>
<td style="text-align: center;">✔</td>
<td style="text-align: center;"></td>
<td style="text-align: center;">✔</td>
</tr>
<tr>
<td style="text-align: left;">OVRPLTW</td>
<td style="text-align: center;">✔</td>
<td style="text-align: center;">✔</td>
<td style="text-align: center;"></td>
<td style="text-align: center;">✔</td>
<td style="text-align: center;">✔</td>
</tr>
<tr>
<td style="text-align: left;">VRPBLTW</td>
<td style="text-align: center;">✔</td>
<td style="text-align: center;"></td>
<td style="text-align: center;">✔</td>
<td style="text-align: center;">✔</td>
<td style="text-align: center;">✔</td>
</tr>
<tr>
<td style="text-align: left;">OVRPBLTW</td>
<td style="text-align: center;">✔</td>
<td style="text-align: center;">✔</td>
<td style="text-align: center;">✔</td>
<td style="text-align: center;">✔</td>
<td style="text-align: center;">✔</td>
</tr>
</tbody>
</table>
<p>You may also check out the following papers as reference:</p>
<ul>
<li><a href="https://arxiv.org/abs/2402.16891">"Multi-Task Learning for Routing Problem with Cross-Problem Zero-Shot Generalization" (Liu et al, 2024)</a></li>
<li><a href="https://arxiv.org/abs/2405.01029">"MVMoE: Multi-Task Vehicle Routing Solver with Mixture-of-Experts" (Zhou et al, 2024)</a></li>
<li><a href="https://arxiv.org/abs/2406.15007">"RouteFinder: Towards Foundation Models for Vehicle Routing Problems" (Berto et al, 2024)</a></li>
</ul>


<details class="tip" open>
  <summary>Tip</summary>
  <p>Have a look at <a href="https://pyvrp.org/">https://pyvrp.org/</a> for more information about VRP and its variants and their solutions. Kudos to their help and great job!</p>
</details>

<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>generator</code></b>
              (<code><a class="autorefs autorefs-internal" href="#envs.routing.mtvrp.generator.MTVRPGenerator">MTVRPGenerator</a></code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>Generator for the environment, see :class:<code>MTVRPGenerator</code>.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>generator_params</code></b>
              (<code><span title="dict">dict</span></code>, default:
                  <code>{}</code>
)
          –
          <div class="doc-md-description">
            <p>Parameters for the generator.</p>
          </div>
        </li>
    </ul>












<p><span class="doc-section-title">Methods:</span></p>
    <ul>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" href="#envs.routing.mtvrp.env.MTVRPEnv.load_data">load_data</a></code></b>
            –
            <div class="doc-md-description">
              <p>Dataset loading from file</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" href="#envs.routing.mtvrp.env.MTVRPEnv.render">render</a></code></b>
            –
            <div class="doc-md-description">
              <p>Simple wrapper for render function</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" href="#envs.routing.mtvrp.env.MTVRPEnv.select_start_nodes">select_start_nodes</a></code></b>
            –
            <div class="doc-md-description">
              <p>Select available start nodes for the environment (e.g. for POMO-based training)</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" href="#envs.routing.mtvrp.env.MTVRPEnv.solve">solve</a></code></b>
            –
            <div class="doc-md-description">
              <p>Classical solver for the environment. This is a wrapper for the baselines solver.</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" href="#envs.routing.mtvrp.env.MTVRPEnv.check_variants">check_variants</a></code></b>
            –
            <div class="doc-md-description">
              <p>Check if the problem has the variants</p>
            </div>
          </li>
    </ul>



                  <details class="mkdocstrings-source">
                    <summary>Source code in <code>rl4co/envs/routing/mtvrp/env.py</code></summary>
                    <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">generator</span><span class="p">:</span> <span class="n">MTVRPGenerator</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">generator_params</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{},</span>
    <span class="n">check_solution</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="p">):</span>
    <span class="k">if</span> <span class="n">check_solution</span><span class="p">:</span>
        <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
            <span class="s2">&quot;Solution checking is enabled. This may slow down the environment.&quot;</span>
            <span class="s2">&quot; We recommend disabling this for training by passing `check_solution=False`.&quot;</span>
        <span class="p">)</span>

    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">check_solution</span><span class="o">=</span><span class="n">check_solution</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">generator</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">generator</span> <span class="o">=</span> <span class="n">MTVRPGenerator</span><span class="p">(</span><span class="o">**</span><span class="n">generator_params</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">generator</span> <span class="o">=</span> <span class="n">generator</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_make_spec</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">generator</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
                  </details>



<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h3 id="envs.routing.mtvrp.env.MTVRPEnv.load_data" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">load_data</span>


<a href="#envs.routing.mtvrp.env.MTVRPEnv.load_data" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span class="nf">load_data</span><span class="p">(</span><span class="n">fpath</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="p">[],</span> <span class="n">scale</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Dataset loading from file
Normalize demand by capacity to be in [0, 1]</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>rl4co/envs/routing/mtvrp/env.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">load_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fpath</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="p">[],</span> <span class="n">scale</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Dataset loading from file</span>
<span class="sd">    Normalize demand by capacity to be in [0, 1]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">td_load</span> <span class="o">=</span> <span class="n">load_npz_to_tensordict</span><span class="p">(</span><span class="n">fpath</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">scale</span><span class="p">:</span>
        <span class="n">td_load</span><span class="o">.</span><span class="n">set</span><span class="p">(</span>
            <span class="s2">&quot;demand_linehaul&quot;</span><span class="p">,</span>
            <span class="n">td_load</span><span class="p">[</span><span class="s2">&quot;demand_linehaul&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="n">td_load</span><span class="p">[</span><span class="s2">&quot;capacity_original&quot;</span><span class="p">],</span>
        <span class="p">)</span>
        <span class="n">td_load</span><span class="o">.</span><span class="n">set</span><span class="p">(</span>
            <span class="s2">&quot;demand_backhaul&quot;</span><span class="p">,</span>
            <span class="n">td_load</span><span class="p">[</span><span class="s2">&quot;demand_backhaul&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="n">td_load</span><span class="p">[</span><span class="s2">&quot;capacity_original&quot;</span><span class="p">],</span>
        <span class="p">)</span>
    <span class="k">return</span> <span class="n">td_load</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="envs.routing.mtvrp.env.MTVRPEnv.render" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">render</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#envs.routing.mtvrp.env.MTVRPEnv.render" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span class="nf">render</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Simple wrapper for render function</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>rl4co/envs/routing/mtvrp/env.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">render</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Simple wrapper for render function&quot;&quot;&quot;</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">.render</span><span class="w"> </span><span class="kn">import</span> <span class="n">render</span>

    <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="envs.routing.mtvrp.env.MTVRPEnv.select_start_nodes" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">select_start_nodes</span>


<a href="#envs.routing.mtvrp.env.MTVRPEnv.select_start_nodes" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span class="nf">select_start_nodes</span><span class="p">(</span><span class="n">td</span><span class="p">,</span> <span class="n">num_starts</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Select available start nodes for the environment (e.g. for POMO-based training)</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>rl4co/envs/routing/mtvrp/env.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">select_start_nodes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">td</span><span class="p">,</span> <span class="n">num_starts</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Select available start nodes for the environment (e.g. for POMO-based training)&quot;&quot;&quot;</span>
    <span class="n">num_loc</span> <span class="o">=</span> <span class="n">td</span><span class="p">[</span><span class="s2">&quot;locs&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span>
    <span class="n">selected</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">torch</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">num_starts</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">td</span><span class="o">.</span><span class="n">device</span><span class="p">)</span><span class="o">.</span><span class="n">repeat_interleave</span><span class="p">(</span><span class="n">td</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">%</span> <span class="n">num_loc</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">selected</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="envs.routing.mtvrp.env.MTVRPEnv.solve" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">solve</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#envs.routing.mtvrp.env.MTVRPEnv.solve" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span class="nf">solve</span><span class="p">(</span>
    <span class="n">instances</span><span class="p">:</span> <span class="n"><span title="tensordict.tensordict.TensorDict">TensorDict</span></span><span class="p">,</span>
    <span class="n">max_runtime</span><span class="p">:</span> <span class="n"><span title="float">float</span></span><span class="p">,</span>
    <span class="n">num_procs</span><span class="p">:</span> <span class="n"><span title="int">int</span></span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">solver</span><span class="p">:</span> <span class="n"><span title="str">str</span></span> <span class="o">=</span> <span class="s2">&quot;pyvrp&quot;</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="tuple">tuple</span></span><span class="p">[</span><span class="n"><span title="torch.Tensor">Tensor</span></span><span class="p">,</span> <span class="n"><span title="torch.Tensor">Tensor</span></span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Classical solver for the environment. This is a wrapper for the baselines solver.
Available solvers are: <code>pyvrp</code>, <code>ortools</code>, <code>lkh</code>. Returns the actions and costs.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>rl4co/envs/routing/mtvrp/env.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">solve</span><span class="p">(</span>
    <span class="n">instances</span><span class="p">:</span> <span class="n">TensorDict</span><span class="p">,</span>
    <span class="n">max_runtime</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
    <span class="n">num_procs</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">solver</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;pyvrp&quot;</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Classical solver for the environment. This is a wrapper for the baselines solver.</span>
<span class="sd">    Available solvers are: `pyvrp`, `ortools`, `lkh`. Returns the actions and costs.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">.baselines.solve</span><span class="w"> </span><span class="kn">import</span> <span class="n">solve</span>

    <span class="k">return</span> <span class="n">solve</span><span class="p">(</span><span class="n">instances</span><span class="p">,</span> <span class="n">max_runtime</span><span class="p">,</span> <span class="n">num_procs</span><span class="p">,</span> <span class="n">solver</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="envs.routing.mtvrp.env.MTVRPEnv.check_variants" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">check_variants</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#envs.routing.mtvrp.env.MTVRPEnv.check_variants" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span class="nf">check_variants</span><span class="p">(</span><span class="n">td</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Check if the problem has the variants</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>rl4co/envs/routing/mtvrp/env.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">check_variants</span><span class="p">(</span><span class="n">td</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Check if the problem has the variants&quot;&quot;&quot;</span>
    <span class="n">has_open</span> <span class="o">=</span> <span class="n">td</span><span class="p">[</span><span class="s2">&quot;open_route&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">has_tw</span> <span class="o">=</span> <span class="p">(</span><span class="n">td</span><span class="p">[</span><span class="s2">&quot;time_windows&quot;</span><span class="p">][:,</span> <span class="p">:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="nb">float</span><span class="p">(</span><span class="s2">&quot;inf&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">has_limit</span> <span class="o">=</span> <span class="p">(</span><span class="n">td</span><span class="p">[</span><span class="s2">&quot;distance_limit&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="nb">float</span><span class="p">(</span><span class="s2">&quot;inf&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">has_backhaul</span> <span class="o">=</span> <span class="p">(</span><span class="n">td</span><span class="p">[</span><span class="s2">&quot;demand_backhaul&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">has_open</span><span class="p">,</span> <span class="n">has_tw</span><span class="p">,</span> <span class="n">has_limit</span><span class="p">,</span> <span class="n">has_backhaul</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="envs.routing.mtvrp.generator.MTVRPGenerator" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">MTVRPGenerator</span>


<a href="#envs.routing.mtvrp.generator.MTVRPGenerator" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="language-python doc-signature highlight"><pre><span></span><code><span class="nf">MTVRPGenerator</span><span class="p">(</span>
    <span class="n">num_loc</span><span class="p">:</span> <span class="n"><span title="int">int</span></span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span>
    <span class="n">min_loc</span><span class="p">:</span> <span class="n"><span title="float">float</span></span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span>
    <span class="n">max_loc</span><span class="p">:</span> <span class="n"><span title="float">float</span></span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
    <span class="n">loc_distribution</span><span class="p">:</span> <span class="p">(</span>
        <span class="n"><span title="int">int</span></span> <span class="o">|</span> <span class="n"><span title="float">float</span></span> <span class="o">|</span> <span class="n"><span title="str">str</span></span> <span class="o">|</span> <span class="n"><span title="type">type</span></span> <span class="o">|</span> <span class="n"><span title="collections.abc.Callable">Callable</span></span>
    <span class="p">)</span> <span class="o">=</span> <span class="n"><span title="torch.distributions.Uniform">Uniform</span></span><span class="p">,</span>
    <span class="n">capacity</span><span class="p">:</span> <span class="n"><span title="float">float</span></span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">min_demand</span><span class="p">:</span> <span class="n"><span title="int">int</span></span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">max_demand</span><span class="p">:</span> <span class="n"><span title="int">int</span></span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
    <span class="n">min_backhaul</span><span class="p">:</span> <span class="n"><span title="int">int</span></span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">max_backhaul</span><span class="p">:</span> <span class="n"><span title="int">int</span></span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
    <span class="n">scale_demand</span><span class="p">:</span> <span class="n"><span title="bool">bool</span></span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">max_time</span><span class="p">:</span> <span class="n"><span title="float">float</span></span> <span class="o">=</span> <span class="mf">4.6</span><span class="p">,</span>
    <span class="n">backhaul_ratio</span><span class="p">:</span> <span class="n"><span title="float">float</span></span> <span class="o">=</span> <span class="mf">0.2</span><span class="p">,</span>
    <span class="n">distance_limit</span><span class="p">:</span> <span class="n"><span title="float">float</span></span> <span class="o">=</span> <span class="mf">3.0</span><span class="p">,</span>
    <span class="n">speed</span><span class="p">:</span> <span class="n"><span title="float">float</span></span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
    <span class="n">prob_open</span><span class="p">:</span> <span class="n"><span title="float">float</span></span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span>
    <span class="n">prob_time_window</span><span class="p">:</span> <span class="n"><span title="float">float</span></span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span>
    <span class="n">prob_limit</span><span class="p">:</span> <span class="n"><span title="float">float</span></span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span>
    <span class="n">prob_backhaul</span><span class="p">:</span> <span class="n"><span title="float">float</span></span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span>
    <span class="n">variant_preset</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">use_combinations</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">subsample</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents first">
            <p class="doc doc-class-bases">
              Bases: <code><span title="rl4co.envs.common.utils.Generator">Generator</span></code></p>



        <p>MTVRP Generator.
Class to generate instances of the MTVRP problem.
If a variant is declared and Subsample is True, the generator will sample the problem based on the variant probabilities.
By default, we use Mixed-Batch Training as in Berto et al. 2024 (RouteFinder), i.e. one batch can contain multiple variants.</p>
<p>Example presets:</p>
<ul>
<li>"all": Sample uniformly from 16 variants</li>
<li>"single_feat": Sample uniformly between CVRP, OVRP, VRPB, VRPL, VRPTW (as done in Liu et al. 2024 (MTPOMO))</li>
<li>"single_feat_otw": Sample uniformly between CVRP, OVRP, VRPB, VRPL, VRPTW, OVRPTW (as done in Zhou et al. 2024 (MVMoE))</li>
<li>"cvrp": Only CVRP (similarly for other variants)</li>
</ul>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>num_loc</code></b>
              (<code><span title="int">int</span></code>, default:
                  <code>20</code>
)
          –
          <div class="doc-md-description">
            <p>Number of locations to generate</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>min_loc</code></b>
              (<code><span title="float">float</span></code>, default:
                  <code>0.0</code>
)
          –
          <div class="doc-md-description">
            <p>Minimum location value</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>max_loc</code></b>
              (<code><span title="float">float</span></code>, default:
                  <code>1.0</code>
)
          –
          <div class="doc-md-description">
            <p>Maximum location value</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>loc_distribution</code></b>
              (<code><span title="int">int</span> | <span title="float">float</span> | <span title="str">str</span> | <span title="type">type</span> | <span title="collections.abc.Callable">Callable</span></code>, default:
                  <code><span title="torch.distributions.Uniform">Uniform</span></code>
)
          –
          <div class="doc-md-description">
            <p>Distribution to sample locations from</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>capacity</code></b>
              (<code><span title="float">float</span></code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>Vehicle capacity. If None, get value based on <code>get_vehicle_capacity</code></p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>min_demand</code></b>
              (<code><span title="int">int</span></code>, default:
                  <code>1</code>
)
          –
          <div class="doc-md-description">
            <p>Minimum demand value</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>max_demand</code></b>
              (<code><span title="int">int</span></code>, default:
                  <code>10</code>
)
          –
          <div class="doc-md-description">
            <p>Maximum demand value</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>min_backhaul</code></b>
              (<code><span title="int">int</span></code>, default:
                  <code>1</code>
)
          –
          <div class="doc-md-description">
            <p>Minimum backhaul value</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>max_backhaul</code></b>
              (<code><span title="int">int</span></code>, default:
                  <code>10</code>
)
          –
          <div class="doc-md-description">
            <p>Maximum backhaul value</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>scale_demand</code></b>
              (<code><span title="bool">bool</span></code>, default:
                  <code>True</code>
)
          –
          <div class="doc-md-description">
            <p>Scale demand values (by default, generate between 1 and 10)</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>max_time</code></b>
              (<code><span title="float">float</span></code>, default:
                  <code>4.6</code>
)
          –
          <div class="doc-md-description">
            <p>Maximum time window value (at depot)</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>backhaul_ratio</code></b>
              (<code><span title="float">float</span></code>, default:
                  <code>0.2</code>
)
          –
          <div class="doc-md-description">
            <p>Fraction of backhauls (e.g. 0.2 means 20% of nodes are backhaul)</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>distance_limit</code></b>
              (<code><span title="float">float</span></code>, default:
                  <code>3.0</code>
)
          –
          <div class="doc-md-description">
            <p>Distance limit</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>speed</code></b>
              (<code><span title="float">float</span></code>, default:
                  <code>1.0</code>
)
          –
          <div class="doc-md-description">
            <p>Speed of vehicle. Defaults to 1</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>subsample</code></b>
          –
          <div class="doc-md-description">
            <p>If False, we always sample all attributes (i.e., OVRPBLTW)
If true, we use the</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>**kwargs</code></b>
          –
          <div class="doc-md-description">
            <p>Additional keyword arguments</p>
          </div>
        </li>
    </ul>












<p><span class="doc-section-title">Methods:</span></p>
    <ul>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" href="#envs.routing.mtvrp.generator.MTVRPGenerator.subsample_problems">subsample_problems</a></code></b>
            –
            <div class="doc-md-description">
              <p>Create subproblems starting from seed probabilities depending on their variant.</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" href="#envs.routing.mtvrp.generator.MTVRPGenerator.generate_locations">generate_locations</a></code></b>
            –
            <div class="doc-md-description">
              <p>Generate seed locations.</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" href="#envs.routing.mtvrp.generator.MTVRPGenerator.generate_demands">generate_demands</a></code></b>
            –
            <div class="doc-md-description">
              <p>Classical lineahul demand / delivery from depot (C) and backhaul demand / pickup to depot (B) generation.</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" href="#envs.routing.mtvrp.generator.MTVRPGenerator.generate_time_windows">generate_time_windows</a></code></b>
            –
            <div class="doc-md-description">
              <p>Generate time windows (TW) and service times for each location including depot.</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" href="#envs.routing.mtvrp.generator.MTVRPGenerator.generate_distance_limit">generate_distance_limit</a></code></b>
            –
            <div class="doc-md-description">
              <p>Generates distance limits (L) and checks their feasibilities.</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" href="#envs.routing.mtvrp.generator.MTVRPGenerator.generate_open_route">generate_open_route</a></code></b>
            –
            <div class="doc-md-description">
              <p>Generate open route flags (O). Here we could have a sampler but we simply return True here so all</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" href="#envs.routing.mtvrp.generator.MTVRPGenerator.generate_speed">generate_speed</a></code></b>
            –
            <div class="doc-md-description">
              <p>We simply generate the speed as constant here</p>
            </div>
          </li>
    </ul>



                  <details class="mkdocstrings-source">
                    <summary>Source code in <code>rl4co/envs/routing/mtvrp/generator.py</code></summary>
                    <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">num_loc</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span>
    <span class="n">min_loc</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span>
    <span class="n">max_loc</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
    <span class="n">loc_distribution</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">type</span> <span class="o">|</span> <span class="n">Callable</span> <span class="o">=</span> <span class="n">Uniform</span><span class="p">,</span>
    <span class="n">capacity</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">min_demand</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">max_demand</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
    <span class="n">min_backhaul</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">max_backhaul</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
    <span class="n">scale_demand</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">max_time</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">4.6</span><span class="p">,</span>
    <span class="n">backhaul_ratio</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.2</span><span class="p">,</span>
    <span class="n">distance_limit</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">3.0</span><span class="p">,</span>
    <span class="n">speed</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
    <span class="n">prob_open</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span>
    <span class="n">prob_time_window</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span>
    <span class="n">prob_limit</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span>
    <span class="n">prob_backhaul</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span>
    <span class="n">variant_preset</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">use_combinations</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">subsample</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="c1"># Location distribution</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">num_loc</span> <span class="o">=</span> <span class="n">num_loc</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">min_loc</span> <span class="o">=</span> <span class="n">min_loc</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">max_loc</span> <span class="o">=</span> <span class="n">max_loc</span>
    <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;loc_sampler&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">loc_sampler</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;loc_sampler&quot;</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">loc_sampler</span> <span class="o">=</span> <span class="n">get_sampler</span><span class="p">(</span><span class="s2">&quot;loc&quot;</span><span class="p">,</span> <span class="n">loc_distribution</span><span class="p">,</span> <span class="n">min_loc</span><span class="p">,</span> <span class="n">max_loc</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">capacity</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">capacity</span> <span class="o">=</span> <span class="n">get_vehicle_capacity</span><span class="p">(</span><span class="n">num_loc</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">capacity</span> <span class="o">=</span> <span class="n">capacity</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">min_demand</span> <span class="o">=</span> <span class="n">min_demand</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">max_demand</span> <span class="o">=</span> <span class="n">max_demand</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">min_backhaul</span> <span class="o">=</span> <span class="n">min_backhaul</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">max_backhaul</span> <span class="o">=</span> <span class="n">max_backhaul</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">scale_demand</span> <span class="o">=</span> <span class="n">scale_demand</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">backhaul_ratio</span> <span class="o">=</span> <span class="n">backhaul_ratio</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">max_time</span> <span class="o">=</span> <span class="n">max_time</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">distance_limit</span> <span class="o">=</span> <span class="n">distance_limit</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">speed</span> <span class="o">=</span> <span class="n">speed</span>

    <span class="k">assert</span> <span class="ow">not</span> <span class="p">(</span><span class="n">subsample</span> <span class="ow">and</span> <span class="p">(</span><span class="n">variant_preset</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)),</span> <span class="p">(</span>
        <span class="s2">&quot;Cannot use subsample if variant_preset is not specified. &quot;</span>
    <span class="p">)</span>
    <span class="k">if</span> <span class="n">variant_preset</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Using variant generation preset </span><span class="si">{</span><span class="n">variant_preset</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">variant_probs</span> <span class="o">=</span> <span class="n">VARIANT_GENERATION_PRESETS</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">variant_preset</span><span class="p">)</span>
        <span class="k">assert</span> <span class="n">variant_probs</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">,</span> <span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Variant generation preset </span><span class="si">{</span><span class="n">variant_preset</span><span class="si">}</span><span class="s2"> not found. </span><span class="se">\</span>
<span class="s2">            Available presets are </span><span class="si">{</span><span class="n">VARIANT_GENERATION_PRESETS</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span><span class="si">}</span><span class="s2"> with probabilities </span><span class="si">{</span><span class="n">VARIANT_GENERATION_PRESETS</span><span class="o">.</span><span class="n">values</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">variant_probs</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;O&quot;</span><span class="p">:</span> <span class="n">prob_open</span><span class="p">,</span>
            <span class="s2">&quot;TW&quot;</span><span class="p">:</span> <span class="n">prob_time_window</span><span class="p">,</span>
            <span class="s2">&quot;L&quot;</span><span class="p">:</span> <span class="n">prob_limit</span><span class="p">,</span>
            <span class="s2">&quot;B&quot;</span><span class="p">:</span> <span class="n">prob_backhaul</span><span class="p">,</span>
        <span class="p">}</span>
    <span class="c1"># check probabilities</span>
    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">prob</span> <span class="ow">in</span> <span class="n">variant_probs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">assert</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">prob</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Probability </span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2"> must be between 0 and 1&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">variant_probs</span> <span class="o">=</span> <span class="n">variant_probs</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">variant_preset</span> <span class="o">=</span> <span class="n">variant_preset</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">variant_preset</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">and</span> <span class="n">variant_preset</span> <span class="o">!=</span> <span class="s2">&quot;all&quot;</span><span class="p">:</span>
        <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">variant_preset</span><span class="si">}</span><span class="s2"> selected. Will not use feature combination!&quot;</span><span class="p">)</span>
        <span class="n">use_combinations</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">use_combinations</span> <span class="o">=</span> <span class="n">use_combinations</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">subsample</span> <span class="o">=</span> <span class="n">subsample</span>
</code></pre></div></td></tr></table></div>
                  </details>



<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h3 id="envs.routing.mtvrp.generator.MTVRPGenerator.subsample_problems" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">subsample_problems</span>


<a href="#envs.routing.mtvrp.generator.MTVRPGenerator.subsample_problems" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span class="nf">subsample_problems</span><span class="p">(</span><span class="n">td</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Create subproblems starting from seed probabilities depending on their variant.
If random seed sampled in [0, 1] in batch is greater than prob, remove the constraint
thus, if prob high, it is less likely to remove the constraint (i.e. prob=0.9, 90% chance to keep constraint)</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>rl4co/envs/routing/mtvrp/generator.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">subsample_problems</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">td</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create subproblems starting from seed probabilities depending on their variant.</span>
<span class="sd">    If random seed sampled in [0, 1] in batch is greater than prob, remove the constraint</span>
<span class="sd">    thus, if prob high, it is less likely to remove the constraint (i.e. prob=0.9, 90% chance to keep constraint)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">batch_size</span> <span class="o">=</span> <span class="n">td</span><span class="o">.</span><span class="n">batch_size</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="n">variant_probs</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">variant_probs</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_combinations</span><span class="p">:</span>
        <span class="c1"># in a batch, multiple variants combinations can be picked</span>
        <span class="n">keep_mask</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">batch_size</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">variant_probs</span>  <span class="c1"># O, TW, L, B</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># in a batch, only a variant can be picked.</span>
        <span class="c1"># we assign a 0.5 prob to the last variant (which is normal cvrp)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">variant_preset</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span>
            <span class="n">VARIANT_GENERATION_PRESETS</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
        <span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">variant_preset</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span>
            <span class="s2">&quot;all&quot;</span><span class="p">,</span>
            <span class="s2">&quot;cvrp&quot;</span><span class="p">,</span>
            <span class="s2">&quot;single_feat&quot;</span><span class="p">,</span>
            <span class="s2">&quot;single_feat_otw&quot;</span><span class="p">,</span>
        <span class="p">):</span>
            <span class="n">cvrp_prob</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">cvrp_prob</span> <span class="o">=</span> <span class="mf">0.5</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">variant_preset</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;all&quot;</span><span class="p">,</span> <span class="s2">&quot;cvrp&quot;</span><span class="p">,</span> <span class="s2">&quot;single_feat&quot;</span><span class="p">,</span> <span class="s2">&quot;single_feat_otw&quot;</span><span class="p">):</span>
            <span class="n">indices</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">distributions</span><span class="o">.</span><span class="n">Categorical</span><span class="p">(</span>
                <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">variant_probs</span><span class="o">.</span><span class="n">values</span><span class="p">())</span> <span class="o">+</span> <span class="p">[</span><span class="n">cvrp_prob</span><span class="p">])[</span><span class="kc">None</span><span class="p">]</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span>
                    <span class="n">batch_size</span><span class="p">,</span> <span class="mi">1</span>
                <span class="p">)</span>
            <span class="p">)</span><span class="o">.</span><span class="n">sample</span><span class="p">()</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">variant_preset</span> <span class="o">==</span> <span class="s2">&quot;single_feat_otw&quot;</span><span class="p">:</span>
                <span class="n">keep_mask</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">batch_size</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">bool</span><span class="p">)</span>
                <span class="n">keep_mask</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">batch_size</span><span class="p">),</span> <span class="n">indices</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>

                <span class="c1"># If keep_mask[:, 4] is True, make both keep_mask[:, 0] and keep_mask[:, 1] True</span>
                <span class="n">keep_mask</span><span class="p">[:,</span> <span class="p">:</span><span class="mi">2</span><span class="p">]</span> <span class="o">|=</span> <span class="n">keep_mask</span><span class="p">[:,</span> <span class="mi">4</span><span class="p">:</span><span class="mi">5</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">keep_mask</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">batch_size</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">bool</span><span class="p">)</span>
                <span class="n">keep_mask</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">batch_size</span><span class="p">),</span> <span class="n">indices</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># if the variant is specified, we keep the attributes with probability &gt; 0</span>
            <span class="n">keep_mask</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">batch_size</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">bool</span><span class="p">)</span>
            <span class="n">indices</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">nonzero</span><span class="p">(</span><span class="n">variant_probs</span><span class="p">)</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()</span>
            <span class="n">keep_mask</span><span class="p">[:,</span> <span class="n">indices</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="n">td</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_default_open</span><span class="p">(</span><span class="n">td</span><span class="p">,</span> <span class="o">~</span><span class="n">keep_mask</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">])</span>
    <span class="n">td</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_default_time_window</span><span class="p">(</span><span class="n">td</span><span class="p">,</span> <span class="o">~</span><span class="n">keep_mask</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">])</span>
    <span class="n">td</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_default_distance_limit</span><span class="p">(</span><span class="n">td</span><span class="p">,</span> <span class="o">~</span><span class="n">keep_mask</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">])</span>
    <span class="n">td</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_default_backhaul</span><span class="p">(</span><span class="n">td</span><span class="p">,</span> <span class="o">~</span><span class="n">keep_mask</span><span class="p">[:,</span> <span class="mi">3</span><span class="p">])</span>

    <span class="k">return</span> <span class="n">td</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="envs.routing.mtvrp.generator.MTVRPGenerator.generate_locations" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">generate_locations</span>


<a href="#envs.routing.mtvrp.generator.MTVRPGenerator.generate_locations" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span class="nf">generate_locations</span><span class="p">(</span><span class="n">batch_size</span><span class="p">,</span> <span class="n">num_loc</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="torch.Tensor">Tensor</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Generate seed locations.</p>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<b><code>locs</code></b> (              <code><span title="torch.Tensor">Tensor</span></code>
)          –
          <div class="doc-md-description">
            <p>[B, N+1, 2] where the first location is the depot.</p>
          </div>
        </li>
    </ul>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>rl4co/envs/routing/mtvrp/generator.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">generate_locations</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">batch_size</span><span class="p">,</span> <span class="n">num_loc</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Generate seed locations.</span>

<span class="sd">    Returns:</span>
<span class="sd">        locs: [B, N+1, 2] where the first location is the depot.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">locs</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span><span class="p">(</span><span class="o">*</span><span class="n">batch_size</span><span class="p">,</span> <span class="n">num_loc</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">uniform_</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">min_loc</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_loc</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">locs</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="envs.routing.mtvrp.generator.MTVRPGenerator.generate_demands" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">generate_demands</span>


<a href="#envs.routing.mtvrp.generator.MTVRPGenerator.generate_demands" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span class="nf">generate_demands</span><span class="p">(</span><span class="n">batch_size</span><span class="p">:</span> <span class="n"><span title="int">int</span></span><span class="p">,</span> <span class="n">num_loc</span><span class="p">:</span> <span class="n"><span title="int">int</span></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="torch.Tensor">Tensor</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Classical lineahul demand / delivery from depot (C) and backhaul demand / pickup to depot (B) generation.
Initialize the demand for nodes except the depot, which are added during reset.
Demand sampling Following Kool et al. (2019), demands as integers between 1 and 10.
Generates a slightly different distribution than using torch.randint.</p>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<b><code>linehaul_demand</code></b> (              <code><span title="torch.Tensor">Tensor</span></code>
)          –
          <div class="doc-md-description">
            <p>[B, N]</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
<b><code>backhaul_demand</code></b> (              <code><span title="torch.Tensor">Tensor</span></code>
)          –
          <div class="doc-md-description">
            <p>[B, N]</p>
          </div>
        </li>
    </ul>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>rl4co/envs/routing/mtvrp/generator.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">generate_demands</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">batch_size</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">num_loc</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Classical lineahul demand / delivery from depot (C) and backhaul demand / pickup to depot (B) generation.</span>
<span class="sd">    Initialize the demand for nodes except the depot, which are added during reset.</span>
<span class="sd">    Demand sampling Following Kool et al. (2019), demands as integers between 1 and 10.</span>
<span class="sd">    Generates a slightly different distribution than using torch.randint.</span>

<span class="sd">    Returns:</span>
<span class="sd">        linehaul_demand: [B, N]</span>
<span class="sd">        backhaul_demand: [B, N]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">linehaul_demand</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span><span class="p">(</span><span class="o">*</span><span class="n">batch_size</span><span class="p">,</span> <span class="n">num_loc</span><span class="p">)</span>
        <span class="o">.</span><span class="n">uniform_</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">min_demand</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_demand</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
        <span class="o">.</span><span class="n">int</span><span class="p">()</span>
        <span class="o">+</span> <span class="mi">1</span>
    <span class="p">)</span><span class="o">.</span><span class="n">float</span><span class="p">()</span>
    <span class="c1"># Backhaul demand sampling</span>
    <span class="n">backhaul_demand</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span><span class="p">(</span><span class="o">*</span><span class="n">batch_size</span><span class="p">,</span> <span class="n">num_loc</span><span class="p">)</span>
        <span class="o">.</span><span class="n">uniform_</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">min_backhaul</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_backhaul</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
        <span class="o">.</span><span class="n">int</span><span class="p">()</span>
        <span class="o">+</span> <span class="mi">1</span>
    <span class="p">)</span><span class="o">.</span><span class="n">float</span><span class="p">()</span>
    <span class="n">is_linehaul</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="o">*</span><span class="n">batch_size</span><span class="p">,</span> <span class="n">num_loc</span><span class="p">)</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">backhaul_ratio</span>
    <span class="n">backhaul_demand</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">backhaul_demand</span> <span class="o">*</span> <span class="o">~</span><span class="n">is_linehaul</span>
    <span class="p">)</span>  <span class="c1"># keep only values where they are not linehauls</span>
    <span class="n">linehaul_demand</span> <span class="o">=</span> <span class="n">linehaul_demand</span> <span class="o">*</span> <span class="n">is_linehaul</span>
    <span class="k">return</span> <span class="n">linehaul_demand</span><span class="p">,</span> <span class="n">backhaul_demand</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="envs.routing.mtvrp.generator.MTVRPGenerator.generate_time_windows" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">generate_time_windows</span>


<a href="#envs.routing.mtvrp.generator.MTVRPGenerator.generate_time_windows" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span class="nf">generate_time_windows</span><span class="p">(</span>
    <span class="n">locs</span><span class="p">:</span> <span class="n"><span title="torch.Tensor">Tensor</span></span><span class="p">,</span> <span class="n">speed</span><span class="p">:</span> <span class="n"><span title="torch.Tensor">Tensor</span></span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="torch.Tensor">Tensor</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Generate time windows (TW) and service times for each location including depot.
We refer to the generation process in "Multi-Task Learning for Routing Problem with Cross-Problem Zero-Shot Generalization"
(Liu et al., 2024). Note that another way to generate is from "Learning to Delegate for Large-scale Vehicle Routing" (Li et al, 2021) which
is used in "MVMoE: Multi-Task Vehicle Routing Solver with Mixture-of-Experts" (Zhou et al, 2024). Note that however, in that case
the distance limit would have no influence when time windows are present, since the tw for depot is the same as distance with speed=1.
This function can be overridden for that implementation.
See also <a href="https://github.com/RoyalSkye/Routing-MVMoE">https://github.com/RoyalSkye/Routing-MVMoE</a></p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>locs</code></b>
              (<code><span title="torch.Tensor">Tensor</span></code>)
          –
          <div class="doc-md-description">
            <p>[B, N+1, 2] (depot, locs)</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>speed</code></b>
              (<code><span title="torch.Tensor">Tensor</span></code>)
          –
          <div class="doc-md-description">
            <p>[B]</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<b><code>time_windows</code></b> (              <code><span title="torch.Tensor">Tensor</span></code>
)          –
          <div class="doc-md-description">
            <p>[B, N+1, 2]</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
<b><code>service_time</code></b> (              <code><span title="torch.Tensor">Tensor</span></code>
)          –
          <div class="doc-md-description">
            <p>[B, N+1]</p>
          </div>
        </li>
    </ul>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>rl4co/envs/routing/mtvrp/generator.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">generate_time_windows</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">locs</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span>
    <span class="n">speed</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Generate time windows (TW) and service times for each location including depot.</span>
<span class="sd">    We refer to the generation process in &quot;Multi-Task Learning for Routing Problem with Cross-Problem Zero-Shot Generalization&quot;</span>
<span class="sd">    (Liu et al., 2024). Note that another way to generate is from &quot;Learning to Delegate for Large-scale Vehicle Routing&quot; (Li et al, 2021) which</span>
<span class="sd">    is used in &quot;MVMoE: Multi-Task Vehicle Routing Solver with Mixture-of-Experts&quot; (Zhou et al, 2024). Note that however, in that case</span>
<span class="sd">    the distance limit would have no influence when time windows are present, since the tw for depot is the same as distance with speed=1.</span>
<span class="sd">    This function can be overridden for that implementation.</span>
<span class="sd">    See also https://github.com/RoyalSkye/Routing-MVMoE</span>

<span class="sd">    Args:</span>
<span class="sd">        locs: [B, N+1, 2] (depot, locs)</span>
<span class="sd">        speed: [B]</span>

<span class="sd">    Returns:</span>
<span class="sd">        time_windows: [B, N+1, 2]</span>
<span class="sd">        service_time: [B, N+1]</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">batch_size</span><span class="p">,</span> <span class="n">n_loc</span> <span class="o">=</span> <span class="n">locs</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">locs</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span>  <span class="c1"># no depot</span>

    <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="mf">0.15</span><span class="p">,</span> <span class="mf">0.18</span><span class="p">,</span> <span class="mf">0.2</span>
    <span class="n">service_time</span> <span class="o">=</span> <span class="n">a</span> <span class="o">+</span> <span class="p">(</span><span class="n">b</span> <span class="o">-</span> <span class="n">a</span><span class="p">)</span> <span class="o">*</span> <span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">batch_size</span><span class="p">,</span> <span class="n">n_loc</span><span class="p">)</span>
    <span class="n">tw_length</span> <span class="o">=</span> <span class="n">b</span> <span class="o">+</span> <span class="p">(</span><span class="n">c</span> <span class="o">-</span> <span class="n">b</span><span class="p">)</span> <span class="o">*</span> <span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">batch_size</span><span class="p">,</span> <span class="n">n_loc</span><span class="p">)</span>
    <span class="n">d_0i</span> <span class="o">=</span> <span class="n">get_distance</span><span class="p">(</span><span class="n">locs</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">],</span> <span class="n">locs</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">:])</span>
    <span class="n">h_max</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">max_time</span> <span class="o">-</span> <span class="n">service_time</span> <span class="o">-</span> <span class="n">tw_length</span><span class="p">)</span> <span class="o">/</span> <span class="n">d_0i</span> <span class="o">*</span> <span class="n">speed</span> <span class="o">-</span> <span class="mi">1</span>
    <span class="n">tw_start</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="p">(</span><span class="n">h_max</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">batch_size</span><span class="p">,</span> <span class="n">n_loc</span><span class="p">))</span> <span class="o">*</span> <span class="n">d_0i</span> <span class="o">/</span> <span class="n">speed</span>
    <span class="n">tw_end</span> <span class="o">=</span> <span class="n">tw_start</span> <span class="o">+</span> <span class="n">tw_length</span>

    <span class="c1"># Depot tw is 0, max_time</span>
    <span class="n">time_windows</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span>
        <span class="p">(</span>
            <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">((</span><span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">batch_size</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">tw_start</span><span class="p">),</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span>  <span class="c1"># start</span>
            <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">((</span><span class="n">torch</span><span class="o">.</span><span class="n">full</span><span class="p">((</span><span class="n">batch_size</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_time</span><span class="p">),</span> <span class="n">tw_end</span><span class="p">),</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span>
        <span class="p">),</span>  <span class="c1"># en</span>
        <span class="n">dim</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="c1"># depot service time is 0</span>
    <span class="n">service_time</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">((</span><span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">batch_size</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">service_time</span><span class="p">),</span> <span class="n">dim</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">time_windows</span><span class="p">,</span> <span class="n">service_time</span>  <span class="c1"># [B, N+1, 2], [B, N+1]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="envs.routing.mtvrp.generator.MTVRPGenerator.generate_distance_limit" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">generate_distance_limit</span>


<a href="#envs.routing.mtvrp.generator.MTVRPGenerator.generate_distance_limit" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span class="nf">generate_distance_limit</span><span class="p">(</span>
    <span class="n">shape</span><span class="p">:</span> <span class="n"><span title="tuple">tuple</span></span><span class="p">[</span><span class="n"><span title="int">int</span></span><span class="p">,</span> <span class="n"><span title="int">int</span></span><span class="p">],</span> <span class="n">locs</span><span class="p">:</span> <span class="n"><span title="torch.Tensor">Tensor</span></span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="torch.Tensor">Tensor</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Generates distance limits (L) and checks their feasibilities.</p>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<b><code>distance_limit</code></b> (              <code><span title="torch.Tensor">Tensor</span></code>
)          –
          <div class="doc-md-description">
            <p>[B, 1]</p>
          </div>
        </li>
    </ul>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>rl4co/envs/routing/mtvrp/generator.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">generate_distance_limit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">shape</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span> <span class="n">locs</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Generates distance limits (L) and checks their feasibilities.</span>

<span class="sd">    Returns:</span>
<span class="sd">        distance_limit: [B, 1]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># calculate distance of all locations to depot</span>
    <span class="n">dist_to_depot</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">cdist</span><span class="p">(</span><span class="n">locs</span><span class="p">,</span> <span class="n">locs</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="p">:],</span> <span class="n">p</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">assert</span> <span class="p">(</span>
        <span class="n">dist_to_depot</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">distance_limit</span>  <span class="c1"># go back and forth</span>
    <span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">(),</span> <span class="s2">&quot;Distance limit too low, not all nodes can be reached from the depot.&quot;</span>
    <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="n">shape</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">distance_limit</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="envs.routing.mtvrp.generator.MTVRPGenerator.generate_open_route" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">generate_open_route</span>


<a href="#envs.routing.mtvrp.generator.MTVRPGenerator.generate_open_route" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span class="nf">generate_open_route</span><span class="p">(</span><span class="n">shape</span><span class="p">:</span> <span class="n"><span title="tuple">tuple</span></span><span class="p">[</span><span class="n"><span title="int">int</span></span><span class="p">,</span> <span class="n"><span title="int">int</span></span><span class="p">])</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Generate open route flags (O). Here we could have a sampler but we simply return True here so all
routes are open. Afterwards, we subsample the problems.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>rl4co/envs/routing/mtvrp/generator.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">generate_open_route</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">shape</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Generate open route flags (O). Here we could have a sampler but we simply return True here so all</span>
<span class="sd">    routes are open. Afterwards, we subsample the problems.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">bool</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="envs.routing.mtvrp.generator.MTVRPGenerator.generate_speed" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">generate_speed</span>


<a href="#envs.routing.mtvrp.generator.MTVRPGenerator.generate_speed" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span class="nf">generate_speed</span><span class="p">(</span><span class="n">shape</span><span class="p">:</span> <span class="n"><span title="tuple">tuple</span></span><span class="p">[</span><span class="n"><span title="int">int</span></span><span class="p">,</span> <span class="n"><span title="int">int</span></span><span class="p">])</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>We simply generate the speed as constant here</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>rl4co/envs/routing/mtvrp/generator.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">generate_speed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">shape</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;We simply generate the speed as constant here&quot;&quot;&quot;</span>
    <span class="c1"># in this version, the speed is constant but this class may be overridden</span>
    <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="n">shape</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">speed</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>












                

              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Made with ❤️ by <a href="https://github.com/ai4co">AI4CO</a> contributors
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
      <div class="md-progress" data-md-component="progress" role="progressbar"></div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../../../../..", "features": ["announce.dismiss", "content.code.copy", "content.code.annotate", "content.code.select", "content.tabs.link", "content.tooltips", "navigation.expand", "navigation.instant", "navigation.instant.prefetch", "navigation.instant.preview", "navigation.instant.progress", "navigation.indexes", "navigation.path", "navigation.sections", "navigation.top", "navigation.tracking", "navigation.tabs", "search.suggest", "search.highlight", "search.share", "toc.follow"], "search": "../../../../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"default": "stable"}}</script>
    
    
      <script src="../../../../../assets/javascripts/bundle.79ae519e.min.js"></script>
      
        <script src="../../../../js/katex.js"></script>
      
        <script src="../../../../js/particles.min.js"></script>
      
        <script src="https://unpkg.com/katex@0/dist/katex.min.js"></script>
      
        <script src="https://unpkg.com/katex@0/dist/contrib/auto-render.min.js"></script>
      
    
  </body>
</html>