
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Official documentation for RL4CO">
      
      
      
        <link rel="canonical" href="https://ai4co.github.io/rl4co/docs/content/api/networks/base_policies/">
      
      
        <link rel="prev" href="../../envs/graph/">
      
      
        <link rel="next" href="../nn/">
      
      
        
      
      
      <link rel="icon" href="../../../../assets/figs/rl4co-logo.svg">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.1">
    
    
      
        <title>Policy Base Classes - RL4CO</title>
      
    
    
      <link rel="stylesheet" href="../../../../../assets/stylesheets/main.484c7ddc.min.css">
      
        
        <link rel="stylesheet" href="../../../../../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Noto+Sans:300,300i,400,400i,700,700i%7CFira+Code:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Noto Sans";--md-code-font:"Fira Code"}</style>
      
    
    
      <link rel="stylesheet" href="../../../../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../../../stylesheets/extra.css">
    
      <link rel="stylesheet" href="../../../../stylesheets/mkdocstrings.css">
    
      <link rel="stylesheet" href="https://unpkg.com/katex@0/dist/katex.min.css">
    
    <script>__md_scope=new URL("../../../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#constructive-policies-base-classes" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../../../.." title="RL4CO" class="md-header__button md-logo" aria-label="RL4CO" data-md-component="logo">
      
  <img src="../../../../assets/figs/rl4co-logo.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            RL4CO
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Policy Base Classes
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9zM20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12zm-9.15 3.96h2.3L12 9z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="custom" data-md-color-accent="custom"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="custom" data-md-color-accent="custom"  aria-label="Switch to system preference"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Switch to system preference" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/ai4co/rl4co/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    ai4co/rl4co
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../../.." class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../start/installation/" class="md-tabs__link">
          
  
  
    
  
  Getting Started

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../intro/intro/" class="md-tabs__link">
          
  
  
    
  
  Overview

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../../examples/1-quickstart/" class="md-tabs__link">
          
  
  
    
  
  Tutorials

        </a>
      </li>
    
  

    
  

      
        
  
  
  
    
  
  
    
    
      
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../../envs/base/" class="md-tabs__link">
          
  
  
    
  
  API Reference

        </a>
      </li>
    
  

    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../general/contribute/" class="md-tabs__link">
          
  
  
    
  
  About

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../../.." title="RL4CO" class="md-nav__button md-logo" aria-label="RL4CO" data-md-component="logo">
      
  <img src="../../../../assets/figs/rl4co-logo.svg" alt="logo">

    </a>
    RL4CO
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/ai4co/rl4co/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    ai4co/rl4co
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Home
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Getting Started
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Getting Started
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../start/installation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Installation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../examples/1-quickstart/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    RL4CO Quickstart Notebook
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../start/hydra/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Training with Hydra
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Overview
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../intro/intro/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Introduction
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../intro/environments/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Environments
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../intro/policies/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Policies
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../intro/rl/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    RL Algorithms
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Tutorials
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Tutorials
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4_1" >
        
          
          <label class="md-nav__link" for="__nav_4_1" id="__nav_4_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Main
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1">
            <span class="md-nav__icon md-icon"></span>
            
  
    Main
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../examples/1-quickstart/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    RL4CO Quickstart Notebook
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../examples/2-full-training/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Training: Checkpoints, Logging, and Callbacks
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../examples/3-creating-new-env-model/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    New Environment: Creating and Modeling
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4_2" >
        
          
          <label class="md-nav__link" for="__nav_4_2" id="__nav_4_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Modeling
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Modeling
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../examples/modeling/1-decoding-strategies/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    RL4CO Decoding Strategies Notebook
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../examples/modeling/2-transductive-methods/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Transductive Methods
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../examples/modeling/3-change-encoder/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Encoder Customization
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4_3" >
        
          
          <label class="md-nav__link" for="__nav_4_3" id="__nav_4_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Advanced
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Advanced
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../examples/advanced/1-hydra-config/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Hydra Configuration
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../examples/advanced/3-local-search/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Local Search
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../examples/other/3-data-generator-distributions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Generating data in RL4CO
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4_4" >
        
          
          <label class="md-nav__link" for="__nav_4_4" id="__nav_4_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Routing
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Routing
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../examples/other/1-mtvrp/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    MTVRP: Multi-task VRP environment
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../examples/datasets/1-test-on-tsplib/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Testing Model on TSPLib
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../examples/datasets/2-test-on-cvrplib/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Testing Model on VRPLib
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4_5" >
        
          
          <label class="md-nav__link" for="__nav_4_5" id="__nav_4_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Scheduling
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    Scheduling
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../examples/other/2-scheduling/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Solving the Flexible Job-Shop Scheduling Problem (FJSP)
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" checked>
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    API Reference
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    API Reference
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5_1" >
        
          
          <label class="md-nav__link" for="__nav_5_1" id="__nav_5_1_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Environments
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1">
            <span class="md-nav__icon md-icon"></span>
            
  
    Environments
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../envs/base/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Base Classes
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../envs/routing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Routing Problems
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../envs/scheduling/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Scheduling Problems
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../envs/eda/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    EDA Problems
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../envs/graph/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Graph Problems
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_2" checked>
        
          
          <label class="md-nav__link" for="__nav_5_2" id="__nav_5_2_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Networks
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Networks
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    Policy Base Classes
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    Policy Base Classes
  

    
  </span>
  
  

      </a>
      
        

  

<nav class="md-nav md-nav--secondary" aria-label="Page contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Page contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#models.common.constructive.base.ConstructiveEncoder" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;ConstructiveEncoder
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" ConstructiveEncoder">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#models.common.constructive.base.ConstructiveEncoder.forward" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;forward
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#models.common.constructive.base.ConstructiveDecoder" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;ConstructiveDecoder
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" ConstructiveDecoder">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#models.common.constructive.base.ConstructiveDecoder.forward" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;forward
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#models.common.constructive.base.ConstructiveDecoder.pre_decoder_hook" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;pre_decoder_hook
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#models.common.constructive.base.NoEncoder" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;NoEncoder
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" NoEncoder">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#models.common.constructive.base.NoEncoder.forward" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;forward
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#models.common.constructive.base.ConstructivePolicy" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;ConstructivePolicy
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" ConstructivePolicy">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#models.common.constructive.base.ConstructivePolicy.forward" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;forward
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#autoregressive-policies" class="md-nav__link">
    <span class="md-ellipsis">
      
        Autoregressive Policies
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#models.common.constructive.autoregressive.encoder.AutoregressiveEncoder" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;AutoregressiveEncoder
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#models.common.constructive.autoregressive.decoder.AutoregressiveDecoder" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;AutoregressiveDecoder
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#models.common.constructive.autoregressive.policy.AutoregressivePolicy" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;AutoregressivePolicy
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nonautoregressive-policies" class="md-nav__link">
    <span class="md-ellipsis">
      
        Nonautoregressive Policies
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#models.common.constructive.nonautoregressive.encoder.NonAutoregressiveEncoder" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;NonAutoregressiveEncoder
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#models.common.constructive.nonautoregressive.decoder.NonAutoregressiveDecoder" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;NonAutoregressiveDecoder
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" NonAutoregressiveDecoder">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#models.common.constructive.nonautoregressive.decoder.NonAutoregressiveDecoder.heatmap_to_logits" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;heatmap_to_logits
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#models.common.constructive.nonautoregressive.policy.NonAutoregressivePolicy" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;NonAutoregressivePolicy
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../nn/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Neural Network Modules
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../env_embeddings/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Environment Embeddings
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5_3" >
        
          
          <label class="md-nav__link" for="__nav_5_3" id="__nav_5_3_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    RL Algorithms
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    RL Algorithms
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../rl/base/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Base Classes
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../rl/reinforce/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    REINFORCE
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../rl/ppo/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    PPO
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../rl/a2c/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    A2C
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5_4" >
        
          
          <label class="md-nav__link" for="__nav_5_4" id="__nav_5_4_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Zoo
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Zoo
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../zoo/constructive_ar/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Constructive AR Methods
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../zoo/constructive_nar/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Constructive NAR Methods
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../zoo/improvement/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Improvement Methods
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../zoo/transductive/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Transductive Methods
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5_5" >
        
          
          <label class="md-nav__link" for="__nav_5_5" id="__nav_5_5_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Additional APIs
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    Additional APIs
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tasks/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Train and Evaluation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../decoding/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Decoding Strategies
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Data
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    About
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            
  
    About
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../general/contribute/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Contributing to RL4CO
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../general/faq/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    FAQ
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../general/paper/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Paper and Citation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../general/licensing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    License and Usage
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../general/ai4co/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Join AI4CO
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  

<nav class="md-nav md-nav--secondary" aria-label="Page contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Page contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#models.common.constructive.base.ConstructiveEncoder" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;ConstructiveEncoder
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" ConstructiveEncoder">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#models.common.constructive.base.ConstructiveEncoder.forward" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;forward
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#models.common.constructive.base.ConstructiveDecoder" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;ConstructiveDecoder
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" ConstructiveDecoder">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#models.common.constructive.base.ConstructiveDecoder.forward" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;forward
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#models.common.constructive.base.ConstructiveDecoder.pre_decoder_hook" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;pre_decoder_hook
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#models.common.constructive.base.NoEncoder" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;NoEncoder
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" NoEncoder">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#models.common.constructive.base.NoEncoder.forward" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;forward
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#models.common.constructive.base.ConstructivePolicy" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;ConstructivePolicy
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" ConstructivePolicy">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#models.common.constructive.base.ConstructivePolicy.forward" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;forward
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#autoregressive-policies" class="md-nav__link">
    <span class="md-ellipsis">
      
        Autoregressive Policies
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#models.common.constructive.autoregressive.encoder.AutoregressiveEncoder" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;AutoregressiveEncoder
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#models.common.constructive.autoregressive.decoder.AutoregressiveDecoder" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;AutoregressiveDecoder
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#models.common.constructive.autoregressive.policy.AutoregressivePolicy" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;AutoregressivePolicy
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nonautoregressive-policies" class="md-nav__link">
    <span class="md-ellipsis">
      
        Nonautoregressive Policies
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#models.common.constructive.nonautoregressive.encoder.NonAutoregressiveEncoder" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;NonAutoregressiveEncoder
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#models.common.constructive.nonautoregressive.decoder.NonAutoregressiveDecoder" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;NonAutoregressiveDecoder
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" NonAutoregressiveDecoder">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#models.common.constructive.nonautoregressive.decoder.NonAutoregressiveDecoder.heatmap_to_logits" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;heatmap_to_logits
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#models.common.constructive.nonautoregressive.policy.NonAutoregressivePolicy" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;NonAutoregressivePolicy
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
                



  


  <nav class="md-path" aria-label="Navigation" >
    <ol class="md-path__list">
      
        
  
  
    <li class="md-path__item">
      <a href="../../../../.." class="md-path__link">
        
  <span class="md-ellipsis">
    Home
  </span>

      </a>
    </li>
  

      
      
        
  
  
    
    
      
  
  
    
    
      <li class="md-path__item">
        <a href="../../envs/base/" class="md-path__link">
          
  <span class="md-ellipsis">
    API Reference
  </span>

        </a>
      </li>
    
  

    
  

      
        
  
  
    
    
      <li class="md-path__item">
        <a href="./" class="md-path__link">
          
  <span class="md-ellipsis">
    Networks
  </span>

        </a>
      </li>
    
  

      
    </ol>
  </nav>

              
              <article class="md-content__inner md-typeset">
                


                  


  
  


<h1 id="constructive-policies-base-classes">Constructive Policies Base Classes<a class="headerlink" href="#constructive-policies-base-classes" title="Permanent link">&para;</a></h1>


<div class="doc doc-object doc-module">




    <div class="doc doc-contents first">










<p><span class="doc-section-title">Classes:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          <b><code><a class="autorefs autorefs-internal" href="#models.common.constructive.base.ConstructiveEncoder">ConstructiveEncoder</a></code></b>
          –
          <div class="doc-md-description">
            <p>Base class for the encoder of constructive models</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><a class="autorefs autorefs-internal" href="#models.common.constructive.base.ConstructiveDecoder">ConstructiveDecoder</a></code></b>
          –
          <div class="doc-md-description">
            <p>Base decoder model for constructive models. The decoder is responsible for generating the logits for the action</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><a class="autorefs autorefs-internal" href="#models.common.constructive.base.NoEncoder">NoEncoder</a></code></b>
          –
          <div class="doc-md-description">
            <p>Default encoder decoder-only models, i.e. autoregressive models that re-encode all the state at each decoding step.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><a class="autorefs autorefs-internal" href="#models.common.constructive.base.ConstructivePolicy">ConstructivePolicy</a></code></b>
          –
          <div class="doc-md-description">
            <p>Base class for constructive policies. Constructive policies take as input and instance and output a solution (sequence of actions).</p>
          </div>
        </li>
    </ul>







<div class="doc doc-children">









<div class="doc doc-object doc-class">



<h2 id="models.common.constructive.base.ConstructiveEncoder" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">ConstructiveEncoder</span>


<a href="#models.common.constructive.base.ConstructiveEncoder" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="torch.nn.Module">Module</span></code></p>



        <p>Base class for the encoder of constructive models</p>












<p><span class="doc-section-title">Methods:</span></p>
    <ul>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" href="#models.common.constructive.base.ConstructiveEncoder.forward">forward</a></code></b>
            –
            <div class="doc-md-description">
              <p>Forward pass for the encoder</p>
            </div>
          </li>
    </ul>






<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h3 id="models.common.constructive.base.ConstructiveEncoder.forward" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">forward</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

<a href="#models.common.constructive.base.ConstructiveEncoder.forward" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span class="nf">forward</span><span class="p">(</span><span class="n">td</span><span class="p">:</span> <span class="n"><span title="tensordict.TensorDict">TensorDict</span></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="tuple">tuple</span></span><span class="p">[</span><span class="n"><span title="typing.Any">Any</span></span><span class="p">,</span> <span class="n"><span title="torch.Tensor">Tensor</span></span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Forward pass for the encoder</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>td</code></b>
              (<code><span title="tensordict.TensorDict">TensorDict</span></code>)
          –
          <div class="doc-md-description">
            <p>TensorDict containing the input data</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><span title="tuple">tuple</span>[<span title="typing.Any">Any</span>, <span title="torch.Tensor">Tensor</span>]</code>
          –
          <div class="doc-md-description">
            <p>Tuple containing:</p>
<ul>
<li>latent representation (any type)</li>
<li>initial embeddings (from feature space to embedding space)</li>
</ul>
          </div>
        </li>
    </ul>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>rl4co/models/common/constructive/base.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">td</span><span class="p">:</span> <span class="n">TensorDict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">Any</span><span class="p">,</span> <span class="n">Tensor</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Forward pass for the encoder</span>

<span class="sd">    Args:</span>
<span class="sd">        td: TensorDict containing the input data</span>

<span class="sd">    Returns:</span>
<span class="sd">        Tuple containing:</span>
<span class="sd">          - latent representation (any type)</span>
<span class="sd">          - initial embeddings (from feature space to embedding space)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;Implement me in subclass!&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="models.common.constructive.base.ConstructiveDecoder" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">ConstructiveDecoder</span>


<a href="#models.common.constructive.base.ConstructiveDecoder" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="torch.nn.Module">Module</span></code></p>



        <p>Base decoder model for constructive models. The decoder is responsible for generating the logits for the action</p>












<p><span class="doc-section-title">Methods:</span></p>
    <ul>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" href="#models.common.constructive.base.ConstructiveDecoder.forward">forward</a></code></b>
            –
            <div class="doc-md-description">
              <p>Obtain logits for current action to the next ones</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" href="#models.common.constructive.base.ConstructiveDecoder.pre_decoder_hook">pre_decoder_hook</a></code></b>
            –
            <div class="doc-md-description">
              <p>By default, we don't need to do anything here.</p>
            </div>
          </li>
    </ul>






<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h3 id="models.common.constructive.base.ConstructiveDecoder.forward" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">forward</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

<a href="#models.common.constructive.base.ConstructiveDecoder.forward" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span class="nf">forward</span><span class="p">(</span>
    <span class="n">td</span><span class="p">:</span> <span class="n"><span title="tensordict.TensorDict">TensorDict</span></span><span class="p">,</span> <span class="n">hidden</span><span class="p">:</span> <span class="n"><span title="typing.Any">Any</span></span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">num_starts</span><span class="p">:</span> <span class="n"><span title="int">int</span></span> <span class="o">=</span> <span class="mi">0</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="tuple">tuple</span></span><span class="p">[</span><span class="n"><span title="torch.Tensor">Tensor</span></span><span class="p">,</span> <span class="n"><span title="torch.Tensor">Tensor</span></span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Obtain logits for current action to the next ones</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>td</code></b>
              (<code><span title="tensordict.TensorDict">TensorDict</span></code>)
          –
          <div class="doc-md-description">
            <p>TensorDict containing the input data</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>hidden</code></b>
              (<code><span title="typing.Any">Any</span></code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>Hidden state from the encoder. Can be any type</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>num_starts</code></b>
              (<code><span title="int">int</span></code>, default:
                  <code>0</code>
)
          –
          <div class="doc-md-description">
            <p>Number of starts for multistart decoding</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><span title="tuple">tuple</span>[<span title="torch.Tensor">Tensor</span>, <span title="torch.Tensor">Tensor</span>]</code>
          –
          <div class="doc-md-description">
            <p>Tuple containing the logits and the action mask</p>
          </div>
        </li>
    </ul>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>rl4co/models/common/constructive/base.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">forward</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">td</span><span class="p">:</span> <span class="n">TensorDict</span><span class="p">,</span> <span class="n">hidden</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">num_starts</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">Tensor</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Obtain logits for current action to the next ones</span>

<span class="sd">    Args:</span>
<span class="sd">        td: TensorDict containing the input data</span>
<span class="sd">        hidden: Hidden state from the encoder. Can be any type</span>
<span class="sd">        num_starts: Number of starts for multistart decoding</span>

<span class="sd">    Returns:</span>
<span class="sd">        Tuple containing the logits and the action mask</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;Implement me in subclass!&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="models.common.constructive.base.ConstructiveDecoder.pre_decoder_hook" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">pre_decoder_hook</span>


<a href="#models.common.constructive.base.ConstructiveDecoder.pre_decoder_hook" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span class="nf">pre_decoder_hook</span><span class="p">(</span>
    <span class="n">td</span><span class="p">:</span> <span class="n"><span title="tensordict.TensorDict">TensorDict</span></span><span class="p">,</span>
    <span class="n">env</span><span class="p">:</span> <span class="n"><span title="rl4co.envs.RL4COEnvBase">RL4COEnvBase</span></span><span class="p">,</span>
    <span class="n">hidden</span><span class="p">:</span> <span class="n"><span title="typing.Any">Any</span></span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">num_starts</span><span class="p">:</span> <span class="n"><span title="int">int</span></span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="tuple">tuple</span></span><span class="p">[</span><span class="n"><span title="tensordict.TensorDict">TensorDict</span></span><span class="p">,</span> <span class="n"><span title="rl4co.envs.RL4COEnvBase">RL4COEnvBase</span></span><span class="p">,</span> <span class="n"><span title="typing.Any">Any</span></span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>By default, we don't need to do anything here.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>td</code></b>
              (<code><span title="tensordict.TensorDict">TensorDict</span></code>)
          –
          <div class="doc-md-description">
            <p>TensorDict containing the input data</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>hidden</code></b>
              (<code><span title="typing.Any">Any</span></code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>Hidden state from the encoder</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>env</code></b>
              (<code><span title="rl4co.envs.RL4COEnvBase">RL4COEnvBase</span></code>)
          –
          <div class="doc-md-description">
            <p>Environment for decoding</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>num_starts</code></b>
              (<code><span title="int">int</span></code>, default:
                  <code>0</code>
)
          –
          <div class="doc-md-description">
            <p>Number of starts for multistart decoding</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><span title="tuple">tuple</span>[<span title="tensordict.TensorDict">TensorDict</span>, <span title="rl4co.envs.RL4COEnvBase">RL4COEnvBase</span>, <span title="typing.Any">Any</span>]</code>
          –
          <div class="doc-md-description">
            <p>Tuple containing the updated Tensordict, environment, and hidden state</p>
          </div>
        </li>
    </ul>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>rl4co/models/common/constructive/base.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">pre_decoder_hook</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">td</span><span class="p">:</span> <span class="n">TensorDict</span><span class="p">,</span> <span class="n">env</span><span class="p">:</span> <span class="n">RL4COEnvBase</span><span class="p">,</span> <span class="n">hidden</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">num_starts</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">TensorDict</span><span class="p">,</span> <span class="n">RL4COEnvBase</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;By default, we don&#39;t need to do anything here.</span>

<span class="sd">    Args:</span>
<span class="sd">        td: TensorDict containing the input data</span>
<span class="sd">        hidden: Hidden state from the encoder</span>
<span class="sd">        env: Environment for decoding</span>
<span class="sd">        num_starts: Number of starts for multistart decoding</span>

<span class="sd">    Returns:</span>
<span class="sd">        Tuple containing the updated Tensordict, environment, and hidden state</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">td</span><span class="p">,</span> <span class="n">env</span><span class="p">,</span> <span class="n">hidden</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="models.common.constructive.base.NoEncoder" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">NoEncoder</span>


<a href="#models.common.constructive.base.NoEncoder" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" href="#models.common.constructive.base.ConstructiveEncoder">ConstructiveEncoder</a></code></p>



        <p>Default encoder decoder-only models, i.e. autoregressive models that re-encode all the state at each decoding step.</p>












<p><span class="doc-section-title">Methods:</span></p>
    <ul>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" href="#models.common.constructive.base.NoEncoder.forward">forward</a></code></b>
            –
            <div class="doc-md-description">
              <p>Return Nones for the hidden state and initial embeddings</p>
            </div>
          </li>
    </ul>






<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h3 id="models.common.constructive.base.NoEncoder.forward" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">forward</span>


<a href="#models.common.constructive.base.NoEncoder.forward" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span class="nf">forward</span><span class="p">(</span><span class="n">td</span><span class="p">:</span> <span class="n"><span title="tensordict.TensorDict">TensorDict</span></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="tuple">tuple</span></span><span class="p">[</span><span class="n"><span title="torch.Tensor">Tensor</span></span><span class="p">,</span> <span class="n"><span title="torch.Tensor">Tensor</span></span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Return Nones for the hidden state and initial embeddings</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>rl4co/models/common/constructive/base.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">td</span><span class="p">:</span> <span class="n">TensorDict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">Tensor</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return Nones for the hidden state and initial embeddings&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="models.common.constructive.base.ConstructivePolicy" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">ConstructivePolicy</span>


<a href="#models.common.constructive.base.ConstructivePolicy" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="language-python doc-signature highlight"><pre><span></span><code><span class="nf">ConstructivePolicy</span><span class="p">(</span>
    <span class="n">encoder</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-internal" href="#models.common.constructive.base.ConstructiveEncoder">ConstructiveEncoder</a></span> <span class="o">|</span> <span class="n"><span title="collections.abc.Callable">Callable</span></span><span class="p">,</span>
    <span class="n">decoder</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-internal" href="#models.common.constructive.base.ConstructiveDecoder">ConstructiveDecoder</a></span> <span class="o">|</span> <span class="n"><span title="collections.abc.Callable">Callable</span></span><span class="p">,</span>
    <span class="n">env_name</span><span class="p">:</span> <span class="n"><span title="str">str</span></span> <span class="o">=</span> <span class="s2">&quot;tsp&quot;</span><span class="p">,</span>
    <span class="n">temperature</span><span class="p">:</span> <span class="n"><span title="float">float</span></span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
    <span class="n">tanh_clipping</span><span class="p">:</span> <span class="n"><span title="float">float</span></span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="n">mask_logits</span><span class="p">:</span> <span class="n"><span title="bool">bool</span></span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">train_decode_type</span><span class="p">:</span> <span class="n"><span title="str">str</span></span> <span class="o">=</span> <span class="s2">&quot;sampling&quot;</span><span class="p">,</span>
    <span class="n">val_decode_type</span><span class="p">:</span> <span class="n"><span title="str">str</span></span> <span class="o">=</span> <span class="s2">&quot;greedy&quot;</span><span class="p">,</span>
    <span class="n">test_decode_type</span><span class="p">:</span> <span class="n"><span title="str">str</span></span> <span class="o">=</span> <span class="s2">&quot;greedy&quot;</span><span class="p">,</span>
    <span class="o">**</span><span class="n">unused_kw</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="torch.nn.Module">Module</span></code></p>



        <p>Base class for constructive policies. Constructive policies take as input and instance and output a solution (sequence of actions).
"Constructive" means that a solution is created from scratch by the model.</p>


<details class="the-structure-follows-roughly-the-following-steps" open>
  <summary>The structure follows roughly the following steps</summary>
  <ol>
<li>Create a hidden state from the encoder</li>
<li>Initialize decoding strategy (such as greedy, sampling, etc.)</li>
<li>Decode the action given the hidden state and the environment state at the current step</li>
<li>Update the environment state with the action. Repeat 3-4 until all sequences are done</li>
<li>Obtain log likelihood, rewards etc.</li>
</ol>
</details>        <p>Note that an encoder is not strictly needed (see :class:<code>NoEncoder</code>).). A decoder however is always needed either in the form of a
network or a function.</p>


<details class="note" open>
  <summary>Note</summary>
  <p>There are major differences between this decoding and most RL problems. The most important one is
that reward may not defined for partial solutions, hence we have to wait for the environment to reach a terminal
state before we can compute the reward with <code>env.get_reward()</code>.</p>
</details>

<details class="warning" open>
  <summary>Warning</summary>
  <p>We suppose environments in the <code>done</code> state are still available for sampling. This is because in NCO we need to
wait for all the environments to reach a terminal state before we can stop the decoding process. This is in
contrast with the TorchRL framework (at the moment) where the <code>env.rollout</code> function automatically resets.
You may follow tighter integration with TorchRL here: <a href="https://github.com/ai4co/rl4co/issues/72">https://github.com/ai4co/rl4co/issues/72</a>.</p>
</details>

<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>encoder</code></b>
              (<code><a class="autorefs autorefs-internal" href="#models.common.constructive.base.ConstructiveEncoder">ConstructiveEncoder</a> | <span title="collections.abc.Callable">Callable</span></code>)
          –
          <div class="doc-md-description">
            <p>Encoder to use</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>decoder</code></b>
              (<code><a class="autorefs autorefs-internal" href="#models.common.constructive.base.ConstructiveDecoder">ConstructiveDecoder</a> | <span title="collections.abc.Callable">Callable</span></code>)
          –
          <div class="doc-md-description">
            <p>Decoder to use</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>env_name</code></b>
              (<code><span title="str">str</span></code>, default:
                  <code>&#39;tsp&#39;</code>
)
          –
          <div class="doc-md-description">
            <p>Environment name to solve (used for automatically instantiating networks)</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>temperature</code></b>
              (<code><span title="float">float</span></code>, default:
                  <code>1.0</code>
)
          –
          <div class="doc-md-description">
            <p>Temperature for the softmax during decoding</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>tanh_clipping</code></b>
              (<code><span title="float">float</span></code>, default:
                  <code>0</code>
)
          –
          <div class="doc-md-description">
            <p>Clipping value for the tanh activation (see Bello et al. 2016) during decoding</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>mask_logits</code></b>
              (<code><span title="bool">bool</span></code>, default:
                  <code>True</code>
)
          –
          <div class="doc-md-description">
            <p>Whether to mask the logits or not during decoding</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>train_decode_type</code></b>
              (<code><span title="str">str</span></code>, default:
                  <code>&#39;sampling&#39;</code>
)
          –
          <div class="doc-md-description">
            <p>Decoding strategy for training</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>val_decode_type</code></b>
              (<code><span title="str">str</span></code>, default:
                  <code>&#39;greedy&#39;</code>
)
          –
          <div class="doc-md-description">
            <p>Decoding strategy for validation</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>test_decode_type</code></b>
              (<code><span title="str">str</span></code>, default:
                  <code>&#39;greedy&#39;</code>
)
          –
          <div class="doc-md-description">
            <p>Decoding strategy for testing</p>
          </div>
        </li>
    </ul>












<p><span class="doc-section-title">Methods:</span></p>
    <ul>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" href="#models.common.constructive.base.ConstructivePolicy.forward">forward</a></code></b>
            –
            <div class="doc-md-description">
              <p>Forward pass of the policy.</p>
            </div>
          </li>
    </ul>



                  <details class="mkdocstrings-source">
                    <summary>Source code in <code>rl4co/models/common/constructive/base.py</code></summary>
                    <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">encoder</span><span class="p">:</span> <span class="n">ConstructiveEncoder</span> <span class="o">|</span> <span class="n">Callable</span><span class="p">,</span>
    <span class="n">decoder</span><span class="p">:</span> <span class="n">ConstructiveDecoder</span> <span class="o">|</span> <span class="n">Callable</span><span class="p">,</span>
    <span class="n">env_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;tsp&quot;</span><span class="p">,</span>
    <span class="n">temperature</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
    <span class="n">tanh_clipping</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="n">mask_logits</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">train_decode_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;sampling&quot;</span><span class="p">,</span>
    <span class="n">val_decode_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;greedy&quot;</span><span class="p">,</span>
    <span class="n">test_decode_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;greedy&quot;</span><span class="p">,</span>
    <span class="o">**</span><span class="n">unused_kw</span><span class="p">,</span>
<span class="p">):</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">unused_kw</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Found </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">unused_kw</span><span class="p">)</span><span class="si">}</span><span class="s2"> unused kwargs: </span><span class="si">{</span><span class="n">unused_kw</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">env_name</span> <span class="o">=</span> <span class="n">env_name</span>

    <span class="c1"># Encoder and decoder</span>
    <span class="k">if</span> <span class="n">encoder</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;`None` was provided as encoder. Using `NoEncoder`.&quot;</span><span class="p">)</span>
        <span class="n">encoder</span> <span class="o">=</span> <span class="n">NoEncoder</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">encoder</span> <span class="o">=</span> <span class="n">encoder</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">decoder</span> <span class="o">=</span> <span class="n">decoder</span>

    <span class="c1"># Decoding strategies</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">temperature</span> <span class="o">=</span> <span class="n">temperature</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">tanh_clipping</span> <span class="o">=</span> <span class="n">tanh_clipping</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">mask_logits</span> <span class="o">=</span> <span class="n">mask_logits</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">train_decode_type</span> <span class="o">=</span> <span class="n">train_decode_type</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">val_decode_type</span> <span class="o">=</span> <span class="n">val_decode_type</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">test_decode_type</span> <span class="o">=</span> <span class="n">test_decode_type</span>
</code></pre></div></td></tr></table></div>
                  </details>



<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h3 id="models.common.constructive.base.ConstructivePolicy.forward" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">forward</span>


<a href="#models.common.constructive.base.ConstructivePolicy.forward" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span class="nf">forward</span><span class="p">(</span>
    <span class="n">td</span><span class="p">:</span> <span class="n"><span title="tensordict.TensorDict">TensorDict</span></span><span class="p">,</span>
    <span class="n">env</span><span class="p">:</span> <span class="n"><span title="str">str</span></span> <span class="o">|</span> <span class="n"><span title="rl4co.envs.RL4COEnvBase">RL4COEnvBase</span></span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">phase</span><span class="p">:</span> <span class="n"><span title="str">str</span></span> <span class="o">=</span> <span class="s2">&quot;train&quot;</span><span class="p">,</span>
    <span class="n">calc_reward</span><span class="p">:</span> <span class="n"><span title="bool">bool</span></span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">return_actions</span><span class="p">:</span> <span class="n"><span title="bool">bool</span></span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">return_entropy</span><span class="p">:</span> <span class="n"><span title="bool">bool</span></span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">return_hidden</span><span class="p">:</span> <span class="n"><span title="bool">bool</span></span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">return_init_embeds</span><span class="p">:</span> <span class="n"><span title="bool">bool</span></span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">return_sum_log_likelihood</span><span class="p">:</span> <span class="n"><span title="bool">bool</span></span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">actions</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">max_steps</span><span class="o">=</span><span class="mi">1000000</span><span class="p">,</span>
    <span class="o">**</span><span class="n">decoding_kwargs</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="dict">dict</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Forward pass of the policy.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>td</code></b>
              (<code><span title="tensordict.TensorDict">TensorDict</span></code>)
          –
          <div class="doc-md-description">
            <p>TensorDict containing the environment state</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>env</code></b>
              (<code><span title="str">str</span> | <span title="rl4co.envs.RL4COEnvBase">RL4COEnvBase</span> | None</code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>Environment to use for decoding. If None, the environment is instantiated from <code>env_name</code>. Note that
it is more efficient to pass an already instantiated environment each time for fine-grained control</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>phase</code></b>
              (<code><span title="str">str</span></code>, default:
                  <code>&#39;train&#39;</code>
)
          –
          <div class="doc-md-description">
            <p>Phase of the algorithm (train, val, test)</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>calc_reward</code></b>
              (<code><span title="bool">bool</span></code>, default:
                  <code>True</code>
)
          –
          <div class="doc-md-description">
            <p>Whether to calculate the reward</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>return_actions</code></b>
              (<code><span title="bool">bool</span></code>, default:
                  <code>True</code>
)
          –
          <div class="doc-md-description">
            <p>Whether to return the actions</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>return_entropy</code></b>
              (<code><span title="bool">bool</span></code>, default:
                  <code>False</code>
)
          –
          <div class="doc-md-description">
            <p>Whether to return the entropy</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>return_hidden</code></b>
              (<code><span title="bool">bool</span></code>, default:
                  <code>False</code>
)
          –
          <div class="doc-md-description">
            <p>Whether to return the hidden state</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>return_init_embeds</code></b>
              (<code><span title="bool">bool</span></code>, default:
                  <code>False</code>
)
          –
          <div class="doc-md-description">
            <p>Whether to return the initial embeddings</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>return_sum_log_likelihood</code></b>
              (<code><span title="bool">bool</span></code>, default:
                  <code>True</code>
)
          –
          <div class="doc-md-description">
            <p>Whether to return the sum of the log likelihood</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>actions</code></b>
          –
          <div class="doc-md-description">
            <p>Actions to use for evaluating the policy.
If passed, use these actions instead of sampling from the policy to calculate log likelihood</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>max_steps</code></b>
          –
          <div class="doc-md-description">
            <p>Maximum number of decoding steps for sanity check to avoid infinite loops if envs are buggy (i.e. do not reach <code>done</code>)</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>decoding_kwargs</code></b>
          –
          <div class="doc-md-description">
            <p>Keyword arguments for the decoding strategy. See :class:<code>rl4co.utils.decoding.DecodingStrategy</code> for more information.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<b><code>out</code></b> (              <code><span title="dict">dict</span></code>
)          –
          <div class="doc-md-description">
            <p>Dictionary containing the reward, log likelihood, and optionally the actions and entropy</p>
          </div>
        </li>
    </ul>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>rl4co/models/common/constructive/base.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">forward</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">td</span><span class="p">:</span> <span class="n">TensorDict</span><span class="p">,</span>
    <span class="n">env</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">RL4COEnvBase</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">phase</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;train&quot;</span><span class="p">,</span>
    <span class="n">calc_reward</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">return_actions</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">return_entropy</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">return_hidden</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">return_init_embeds</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">return_sum_log_likelihood</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">actions</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">max_steps</span><span class="o">=</span><span class="mi">1_000_000</span><span class="p">,</span>
    <span class="o">**</span><span class="n">decoding_kwargs</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Forward pass of the policy.</span>

<span class="sd">    Args:</span>
<span class="sd">        td: TensorDict containing the environment state</span>
<span class="sd">        env: Environment to use for decoding. If None, the environment is instantiated from `env_name`. Note that</span>
<span class="sd">            it is more efficient to pass an already instantiated environment each time for fine-grained control</span>
<span class="sd">        phase: Phase of the algorithm (train, val, test)</span>
<span class="sd">        calc_reward: Whether to calculate the reward</span>
<span class="sd">        return_actions: Whether to return the actions</span>
<span class="sd">        return_entropy: Whether to return the entropy</span>
<span class="sd">        return_hidden: Whether to return the hidden state</span>
<span class="sd">        return_init_embeds: Whether to return the initial embeddings</span>
<span class="sd">        return_sum_log_likelihood: Whether to return the sum of the log likelihood</span>
<span class="sd">        actions: Actions to use for evaluating the policy.</span>
<span class="sd">            If passed, use these actions instead of sampling from the policy to calculate log likelihood</span>
<span class="sd">        max_steps: Maximum number of decoding steps for sanity check to avoid infinite loops if envs are buggy (i.e. do not reach `done`)</span>
<span class="sd">        decoding_kwargs: Keyword arguments for the decoding strategy. See :class:`rl4co.utils.decoding.DecodingStrategy` for more information.</span>

<span class="sd">    Returns:</span>
<span class="sd">        out: Dictionary containing the reward, log likelihood, and optionally the actions and entropy</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Encoder: get encoder output and initial embeddings from initial state</span>
    <span class="n">hidden</span><span class="p">,</span> <span class="n">init_embeds</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">encoder</span><span class="p">(</span><span class="n">td</span><span class="p">)</span>

    <span class="c1"># Instantiate environment if needed</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">env</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">or</span> <span class="n">env</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">env_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">env_name</span> <span class="k">if</span> <span class="n">env</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">env</span>
        <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Instantiated environment not provided; instantiating </span><span class="si">{</span><span class="n">env_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">env</span> <span class="o">=</span> <span class="n">get_env</span><span class="p">(</span><span class="n">env_name</span><span class="p">)</span>

    <span class="c1"># Get decode type depending on phase and whether actions are passed for evaluation</span>
    <span class="n">decode_type</span> <span class="o">=</span> <span class="n">decoding_kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;decode_type&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">actions</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">decode_type</span> <span class="o">=</span> <span class="s2">&quot;evaluate&quot;</span>
    <span class="k">elif</span> <span class="n">decode_type</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">decode_type</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">phase</span><span class="si">}</span><span class="s2">_decode_type&quot;</span><span class="p">)</span>

    <span class="c1"># Setup decoding strategy</span>
    <span class="c1"># we pop arguments that are not part of the decoding strategy</span>
    <span class="n">decode_strategy</span><span class="p">:</span> <span class="n">DecodingStrategy</span> <span class="o">=</span> <span class="n">get_decoding_strategy</span><span class="p">(</span>
        <span class="n">decode_type</span><span class="p">,</span>
        <span class="n">temperature</span><span class="o">=</span><span class="n">decoding_kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;temperature&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">temperature</span><span class="p">),</span>
        <span class="n">tanh_clipping</span><span class="o">=</span><span class="n">decoding_kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;tanh_clipping&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">tanh_clipping</span><span class="p">),</span>
        <span class="n">mask_logits</span><span class="o">=</span><span class="n">decoding_kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;mask_logits&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mask_logits</span><span class="p">),</span>
        <span class="n">store_all_logp</span><span class="o">=</span><span class="n">decoding_kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;store_all_logp&quot;</span><span class="p">,</span> <span class="n">return_entropy</span><span class="p">),</span>
        <span class="o">**</span><span class="n">decoding_kwargs</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="c1"># Pre-decoding hook: used for the initial step(s) of the decoding strategy</span>
    <span class="n">td</span><span class="p">,</span> <span class="n">env</span><span class="p">,</span> <span class="n">num_starts</span> <span class="o">=</span> <span class="n">decode_strategy</span><span class="o">.</span><span class="n">pre_decoder_hook</span><span class="p">(</span><span class="n">td</span><span class="p">,</span> <span class="n">env</span><span class="p">)</span>

    <span class="c1"># Additionally call a decoder hook if needed before main decoding</span>
    <span class="n">td</span><span class="p">,</span> <span class="n">env</span><span class="p">,</span> <span class="n">hidden</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decoder</span><span class="o">.</span><span class="n">pre_decoder_hook</span><span class="p">(</span><span class="n">td</span><span class="p">,</span> <span class="n">env</span><span class="p">,</span> <span class="n">hidden</span><span class="p">,</span> <span class="n">num_starts</span><span class="p">)</span>

    <span class="c1"># Main decoding: loop until all sequences are done</span>
    <span class="n">step</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">while</span> <span class="ow">not</span> <span class="n">td</span><span class="p">[</span><span class="s2">&quot;done&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">all</span><span class="p">():</span>
        <span class="n">logits</span><span class="p">,</span> <span class="n">mask</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decoder</span><span class="p">(</span><span class="n">td</span><span class="p">,</span> <span class="n">hidden</span><span class="p">,</span> <span class="n">num_starts</span><span class="p">)</span>
        <span class="n">td</span> <span class="o">=</span> <span class="n">decode_strategy</span><span class="o">.</span><span class="n">step</span><span class="p">(</span>
            <span class="n">logits</span><span class="p">,</span>
            <span class="n">mask</span><span class="p">,</span>
            <span class="n">td</span><span class="p">,</span>
            <span class="n">action</span><span class="o">=</span><span class="n">actions</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">step</span><span class="p">]</span> <span class="k">if</span> <span class="n">actions</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">td</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">td</span><span class="p">)[</span><span class="s2">&quot;next&quot;</span><span class="p">]</span>
        <span class="n">step</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="n">step</span> <span class="o">&gt;</span> <span class="n">max_steps</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Exceeded maximum number of steps (</span><span class="si">{</span><span class="n">max_steps</span><span class="si">}</span><span class="s2">) duing decoding&quot;</span><span class="p">)</span>
            <span class="k">break</span>

    <span class="c1"># Post-decoding hook: used for the final step(s) of the decoding strategy</span>
    <span class="n">logprobs</span><span class="p">,</span> <span class="n">actions</span><span class="p">,</span> <span class="n">td</span><span class="p">,</span> <span class="n">env</span> <span class="o">=</span> <span class="n">decode_strategy</span><span class="o">.</span><span class="n">post_decoder_hook</span><span class="p">(</span><span class="n">td</span><span class="p">,</span> <span class="n">env</span><span class="p">)</span>

    <span class="c1"># Output dictionary construction</span>
    <span class="k">if</span> <span class="n">calc_reward</span><span class="p">:</span>
        <span class="n">td</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;reward&quot;</span><span class="p">,</span> <span class="n">env</span><span class="o">.</span><span class="n">get_reward</span><span class="p">(</span><span class="n">td</span><span class="p">,</span> <span class="n">actions</span><span class="p">))</span>

    <span class="n">outdict</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;reward&quot;</span><span class="p">:</span> <span class="n">td</span><span class="p">[</span><span class="s2">&quot;reward&quot;</span><span class="p">],</span>
        <span class="s2">&quot;log_likelihood&quot;</span><span class="p">:</span> <span class="n">get_log_likelihood</span><span class="p">(</span>
            <span class="n">logprobs</span><span class="p">,</span> <span class="n">actions</span><span class="p">,</span> <span class="n">td</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;mask&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span> <span class="n">return_sum_log_likelihood</span>
        <span class="p">),</span>
    <span class="p">}</span>

    <span class="k">if</span> <span class="n">return_actions</span><span class="p">:</span>
        <span class="n">outdict</span><span class="p">[</span><span class="s2">&quot;actions&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">actions</span>
    <span class="k">if</span> <span class="n">return_entropy</span><span class="p">:</span>
        <span class="n">outdict</span><span class="p">[</span><span class="s2">&quot;entropy&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">calculate_entropy</span><span class="p">(</span><span class="n">logprobs</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">return_hidden</span><span class="p">:</span>
        <span class="n">outdict</span><span class="p">[</span><span class="s2">&quot;hidden&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">hidden</span>
    <span class="k">if</span> <span class="n">return_init_embeds</span><span class="p">:</span>
        <span class="n">outdict</span><span class="p">[</span><span class="s2">&quot;init_embeds&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">init_embeds</span>

    <span class="k">return</span> <span class="n">outdict</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div><h2 id="autoregressive-policies">Autoregressive Policies<a class="headerlink" href="#autoregressive-policies" title="Permanent link">&para;</a></h2>


<div class="doc doc-object doc-module">




    <div class="doc doc-contents first">










<p><span class="doc-section-title">Classes:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          <b><code><a class="autorefs autorefs-internal" href="#models.common.constructive.autoregressive.encoder.AutoregressiveEncoder">AutoregressiveEncoder</a></code></b>
          –
          <div class="doc-md-description">
            <p>Template class for an autoregressive encoder, simple wrapper around</p>
          </div>
        </li>
    </ul>







<div class="doc doc-children">









<div class="doc doc-object doc-class">



<h2 id="models.common.constructive.autoregressive.encoder.AutoregressiveEncoder" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">AutoregressiveEncoder</span>


<a href="#models.common.constructive.autoregressive.encoder.AutoregressiveEncoder" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="rl4co.models.common.constructive.base.ConstructiveEncoder">ConstructiveEncoder</span></code></p>



        <p>Template class for an autoregressive encoder, simple wrapper around
:class:<code>rl4co.models.common.constructive.base.ConstructiveEncoder</code>.</p>


<details class="tip" open>
  <summary>Tip</summary>
  <p>This class will not work as it is and is just a template.
An example for autoregressive encoder can be found as :class:<code>rl4co.models.zoo.am.encoder.AttentionModelEncoder</code>.</p>
</details>













    </div>

</div>




  </div>

    </div>

</div>

<div class="doc doc-object doc-module">




    <div class="doc doc-contents first">










<p><span class="doc-section-title">Classes:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          <b><code><a class="autorefs autorefs-internal" href="#models.common.constructive.autoregressive.decoder.AutoregressiveDecoder">AutoregressiveDecoder</a></code></b>
          –
          <div class="doc-md-description">
            <p>Template class for an autoregressive decoder, simple wrapper around</p>
          </div>
        </li>
    </ul>







<div class="doc doc-children">









<div class="doc doc-object doc-class">



<h2 id="models.common.constructive.autoregressive.decoder.AutoregressiveDecoder" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">AutoregressiveDecoder</span>


<a href="#models.common.constructive.autoregressive.decoder.AutoregressiveDecoder" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="rl4co.models.common.constructive.base.ConstructiveDecoder">ConstructiveDecoder</span></code></p>



        <p>Template class for an autoregressive decoder, simple wrapper around
:class:<code>rl4co.models.common.constructive.base.ConstructiveDecoder</code></p>


<details class="tip" open>
  <summary>Tip</summary>
  <p>This class will not work as it is and is just a template.
An example for autoregressive encoder can be found as :class:<code>rl4co.models.zoo.am.decoder.AttentionModelDecoder</code>.</p>
</details>













    </div>

</div>




  </div>

    </div>

</div>

<div class="doc doc-object doc-module">




    <div class="doc doc-contents first">










<p><span class="doc-section-title">Classes:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          <b><code><a class="autorefs autorefs-internal" href="#models.common.constructive.autoregressive.policy.AutoregressivePolicy">AutoregressivePolicy</a></code></b>
          –
          <div class="doc-md-description">
            <p>Template class for an autoregressive policy, simple wrapper around</p>
          </div>
        </li>
    </ul>







<div class="doc doc-children">









<div class="doc doc-object doc-class">



<h2 id="models.common.constructive.autoregressive.policy.AutoregressivePolicy" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">AutoregressivePolicy</span>


<a href="#models.common.constructive.autoregressive.policy.AutoregressivePolicy" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="language-python doc-signature highlight"><pre><span></span><code><span class="nf">AutoregressivePolicy</span><span class="p">(</span>
    <span class="n">encoder</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-internal" href="#models.common.constructive.autoregressive.encoder.AutoregressiveEncoder">AutoregressiveEncoder</a></span><span class="p">,</span>
    <span class="n">decoder</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-internal" href="#models.common.constructive.autoregressive.decoder.AutoregressiveDecoder">AutoregressiveDecoder</a></span><span class="p">,</span>
    <span class="n">env_name</span><span class="p">:</span> <span class="n"><span title="str">str</span></span> <span class="o">=</span> <span class="s2">&quot;tsp&quot;</span><span class="p">,</span>
    <span class="n">temperature</span><span class="p">:</span> <span class="n"><span title="float">float</span></span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
    <span class="n">tanh_clipping</span><span class="p">:</span> <span class="n"><span title="float">float</span></span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="n">mask_logits</span><span class="p">:</span> <span class="n"><span title="bool">bool</span></span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">train_decode_type</span><span class="p">:</span> <span class="n"><span title="str">str</span></span> <span class="o">=</span> <span class="s2">&quot;sampling&quot;</span><span class="p">,</span>
    <span class="n">val_decode_type</span><span class="p">:</span> <span class="n"><span title="str">str</span></span> <span class="o">=</span> <span class="s2">&quot;greedy&quot;</span><span class="p">,</span>
    <span class="n">test_decode_type</span><span class="p">:</span> <span class="n"><span title="str">str</span></span> <span class="o">=</span> <span class="s2">&quot;greedy&quot;</span><span class="p">,</span>
    <span class="o">**</span><span class="n">unused_kw</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="rl4co.models.common.constructive.base.ConstructivePolicy">ConstructivePolicy</span></code></p>



        <p>Template class for an autoregressive policy, simple wrapper around
:class:<code>rl4co.models.common.constructive.base.ConstructivePolicy</code>.</p>


<details class="note" open>
  <summary>Note</summary>
  <p>While a decoder is required, an encoder is optional and will be initialized to
:class:<code>rl4co.models.common.constructive.autoregressive.encoder.NoEncoder</code>.
This can be used in decoder-only models in which at each step actions do not depend on
previously encoded states.</p>
</details>












                  <details class="mkdocstrings-source">
                    <summary>Source code in <code>rl4co/models/common/constructive/autoregressive/policy.py</code></summary>
                    <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">encoder</span><span class="p">:</span> <span class="n">AutoregressiveEncoder</span><span class="p">,</span>
    <span class="n">decoder</span><span class="p">:</span> <span class="n">AutoregressiveDecoder</span><span class="p">,</span>
    <span class="n">env_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;tsp&quot;</span><span class="p">,</span>
    <span class="n">temperature</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
    <span class="n">tanh_clipping</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="n">mask_logits</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">train_decode_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;sampling&quot;</span><span class="p">,</span>
    <span class="n">val_decode_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;greedy&quot;</span><span class="p">,</span>
    <span class="n">test_decode_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;greedy&quot;</span><span class="p">,</span>
    <span class="o">**</span><span class="n">unused_kw</span><span class="p">,</span>
<span class="p">):</span>
    <span class="c1"># We raise an error for the user if no decoder was provided</span>
    <span class="k">if</span> <span class="n">decoder</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;AutoregressivePolicy requires a decoder to be provided.&quot;</span><span class="p">)</span>

    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
        <span class="n">encoder</span><span class="o">=</span><span class="n">encoder</span><span class="p">,</span>
        <span class="n">decoder</span><span class="o">=</span><span class="n">decoder</span><span class="p">,</span>
        <span class="n">env_name</span><span class="o">=</span><span class="n">env_name</span><span class="p">,</span>
        <span class="n">temperature</span><span class="o">=</span><span class="n">temperature</span><span class="p">,</span>
        <span class="n">tanh_clipping</span><span class="o">=</span><span class="n">tanh_clipping</span><span class="p">,</span>
        <span class="n">mask_logits</span><span class="o">=</span><span class="n">mask_logits</span><span class="p">,</span>
        <span class="n">train_decode_type</span><span class="o">=</span><span class="n">train_decode_type</span><span class="p">,</span>
        <span class="n">val_decode_type</span><span class="o">=</span><span class="n">val_decode_type</span><span class="p">,</span>
        <span class="n">test_decode_type</span><span class="o">=</span><span class="n">test_decode_type</span><span class="p">,</span>
        <span class="o">**</span><span class="n">unused_kw</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
                  </details>



<div class="doc doc-children">












  </div>

    </div>

</div>




  </div>

    </div>

</div><h2 id="nonautoregressive-policies">Nonautoregressive Policies<a class="headerlink" href="#nonautoregressive-policies" title="Permanent link">&para;</a></h2>


<div class="doc doc-object doc-module">




    <div class="doc doc-contents first">










<p><span class="doc-section-title">Classes:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          <b><code><a class="autorefs autorefs-internal" href="#models.common.constructive.nonautoregressive.encoder.NonAutoregressiveEncoder">NonAutoregressiveEncoder</a></code></b>
          –
          <div class="doc-md-description">
            <p>Template class for an autoregressive encoder, simple wrapper around</p>
          </div>
        </li>
    </ul>







<div class="doc doc-children">









<div class="doc doc-object doc-class">



<h2 id="models.common.constructive.nonautoregressive.encoder.NonAutoregressiveEncoder" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">NonAutoregressiveEncoder</span>


<a href="#models.common.constructive.nonautoregressive.encoder.NonAutoregressiveEncoder" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="rl4co.models.common.constructive.base.ConstructiveEncoder">ConstructiveEncoder</span></code></p>



        <p>Template class for an autoregressive encoder, simple wrapper around
:class:<code>rl4co.models.common.constructive.base.ConstructiveEncoder</code>.</p>


<details class="tip" open>
  <summary>Tip</summary>
  <p>This class will not work as it is and is just a template.
An example for autoregressive encoder can be found as :class:<code>rl4co.models.zoo.am.encoder.AttentionModelEncoder</code>.</p>
</details>













    </div>

</div>




  </div>

    </div>

</div>

<div class="doc doc-object doc-module">




    <div class="doc doc-contents first">










<p><span class="doc-section-title">Classes:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          <b><code><a class="autorefs autorefs-internal" href="#models.common.constructive.nonautoregressive.decoder.NonAutoregressiveDecoder">NonAutoregressiveDecoder</a></code></b>
          –
          <div class="doc-md-description">
            <p>The nonautoregressive decoder is a simple callable class that</p>
          </div>
        </li>
    </ul>







<div class="doc doc-children">









<div class="doc doc-object doc-class">



<h2 id="models.common.constructive.nonautoregressive.decoder.NonAutoregressiveDecoder" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">NonAutoregressiveDecoder</span>


<a href="#models.common.constructive.nonautoregressive.decoder.NonAutoregressiveDecoder" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="rl4co.models.common.constructive.base.ConstructiveDecoder">ConstructiveDecoder</span></code></p>



        <p>The nonautoregressive decoder is a simple callable class that
takes the tensor dictionary and the heatmaps logits and returns the logits for the current
action logits and the action mask.</p>












<p><span class="doc-section-title">Methods:</span></p>
    <ul>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" href="#models.common.constructive.nonautoregressive.decoder.NonAutoregressiveDecoder.heatmap_to_logits">heatmap_to_logits</a></code></b>
            –
            <div class="doc-md-description">
              <p>Obtain heatmap logits for current action to the next ones</p>
            </div>
          </li>
    </ul>






<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h3 id="models.common.constructive.nonautoregressive.decoder.NonAutoregressiveDecoder.heatmap_to_logits" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">heatmap_to_logits</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#models.common.constructive.nonautoregressive.decoder.NonAutoregressiveDecoder.heatmap_to_logits" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span class="nf">heatmap_to_logits</span><span class="p">(</span>
    <span class="n">td</span><span class="p">:</span> <span class="n"><span title="tensordict.TensorDict">TensorDict</span></span><span class="p">,</span> <span class="n">heatmaps_logits</span><span class="p">:</span> <span class="n"><span title="torch.Tensor">Tensor</span></span><span class="p">,</span> <span class="n">num_starts</span><span class="p">:</span> <span class="n"><span title="int">int</span></span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Obtain heatmap logits for current action to the next ones</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>rl4co/models/common/constructive/nonautoregressive/decoder.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">heatmap_to_logits</span><span class="p">(</span><span class="n">td</span><span class="p">:</span> <span class="n">TensorDict</span><span class="p">,</span> <span class="n">heatmaps_logits</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">num_starts</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Obtain heatmap logits for current action to the next ones&quot;&quot;&quot;</span>
    <span class="n">batch_size</span> <span class="o">=</span> <span class="n">heatmaps_logits</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">_indexer</span> <span class="o">=</span> <span class="n">_multistart_batched_index</span><span class="p">(</span><span class="n">batch_size</span><span class="p">,</span> <span class="n">num_starts</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">_indexer</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">td</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="n">current_node</span> <span class="o">=</span> <span class="n">td</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;current_node&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">current_node</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">logits</span> <span class="o">=</span> <span class="n">heatmaps_logits</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">logits</span> <span class="o">=</span> <span class="n">logits</span><span class="p">[</span><span class="n">_indexer</span><span class="p">,</span> <span class="p">:]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">logits</span> <span class="o">=</span> <span class="n">heatmaps_logits</span><span class="p">[</span><span class="n">_indexer</span><span class="p">,</span> <span class="n">current_node</span><span class="p">,</span> <span class="p">:]</span>
    <span class="k">return</span> <span class="n">logits</span><span class="p">,</span> <span class="n">td</span><span class="p">[</span><span class="s2">&quot;action_mask&quot;</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>

<div class="doc doc-object doc-module">




    <div class="doc doc-contents first">










<p><span class="doc-section-title">Classes:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          <b><code><a class="autorefs autorefs-internal" href="#models.common.constructive.nonautoregressive.policy.NonAutoregressivePolicy">NonAutoregressivePolicy</a></code></b>
          –
          <div class="doc-md-description">
            <p>Template class for an nonautoregressive policy, simple wrapper around</p>
          </div>
        </li>
    </ul>







<div class="doc doc-children">









<div class="doc doc-object doc-class">



<h2 id="models.common.constructive.nonautoregressive.policy.NonAutoregressivePolicy" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">NonAutoregressivePolicy</span>


<a href="#models.common.constructive.nonautoregressive.policy.NonAutoregressivePolicy" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="language-python doc-signature highlight"><pre><span></span><code><span class="nf">NonAutoregressivePolicy</span><span class="p">(</span>
    <span class="n">encoder</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-internal" href="#models.common.constructive.nonautoregressive.encoder.NonAutoregressiveEncoder">NonAutoregressiveEncoder</a></span><span class="p">,</span>
    <span class="n">decoder</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-internal" href="#models.common.constructive.nonautoregressive.decoder.NonAutoregressiveDecoder">NonAutoregressiveDecoder</a></span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">env_name</span><span class="p">:</span> <span class="n"><span title="str">str</span></span> <span class="o">=</span> <span class="s2">&quot;tsp&quot;</span><span class="p">,</span>
    <span class="n">temperature</span><span class="p">:</span> <span class="n"><span title="float">float</span></span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
    <span class="n">tanh_clipping</span><span class="p">:</span> <span class="n"><span title="float">float</span></span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="n">mask_logits</span><span class="p">:</span> <span class="n"><span title="bool">bool</span></span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">train_decode_type</span><span class="p">:</span> <span class="n"><span title="str">str</span></span> <span class="o">=</span> <span class="s2">&quot;sampling&quot;</span><span class="p">,</span>
    <span class="n">val_decode_type</span><span class="p">:</span> <span class="n"><span title="str">str</span></span> <span class="o">=</span> <span class="s2">&quot;greedy&quot;</span><span class="p">,</span>
    <span class="n">test_decode_type</span><span class="p">:</span> <span class="n"><span title="str">str</span></span> <span class="o">=</span> <span class="s2">&quot;greedy&quot;</span><span class="p">,</span>
    <span class="o">**</span><span class="n">unused_kw</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="rl4co.models.common.constructive.base.ConstructivePolicy">ConstructivePolicy</span></code></p>



        <p>Template class for an nonautoregressive policy, simple wrapper around
:class:<code>rl4co.models.common.constructive.base.ConstructivePolicy</code>.</p>













                  <details class="mkdocstrings-source">
                    <summary>Source code in <code>rl4co/models/common/constructive/nonautoregressive/policy.py</code></summary>
                    <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">encoder</span><span class="p">:</span> <span class="n">NonAutoregressiveEncoder</span><span class="p">,</span>
    <span class="n">decoder</span><span class="p">:</span> <span class="n">NonAutoregressiveDecoder</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">env_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;tsp&quot;</span><span class="p">,</span>
    <span class="n">temperature</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
    <span class="n">tanh_clipping</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="n">mask_logits</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">train_decode_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;sampling&quot;</span><span class="p">,</span>
    <span class="n">val_decode_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;greedy&quot;</span><span class="p">,</span>
    <span class="n">test_decode_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;greedy&quot;</span><span class="p">,</span>
    <span class="o">**</span><span class="n">unused_kw</span><span class="p">,</span>
<span class="p">):</span>
    <span class="c1"># If decoder is not passed, we default to the non-autoregressive decoder that decodes the heatmap</span>
    <span class="k">if</span> <span class="n">decoder</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">decoder</span> <span class="o">=</span> <span class="n">NonAutoregressiveDecoder</span><span class="p">()</span>

    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
        <span class="n">encoder</span><span class="o">=</span><span class="n">encoder</span><span class="p">,</span>
        <span class="n">decoder</span><span class="o">=</span><span class="n">decoder</span><span class="p">,</span>
        <span class="n">env_name</span><span class="o">=</span><span class="n">env_name</span><span class="p">,</span>
        <span class="n">temperature</span><span class="o">=</span><span class="n">temperature</span><span class="p">,</span>
        <span class="n">tanh_clipping</span><span class="o">=</span><span class="n">tanh_clipping</span><span class="p">,</span>
        <span class="n">mask_logits</span><span class="o">=</span><span class="n">mask_logits</span><span class="p">,</span>
        <span class="n">train_decode_type</span><span class="o">=</span><span class="n">train_decode_type</span><span class="p">,</span>
        <span class="n">val_decode_type</span><span class="o">=</span><span class="n">val_decode_type</span><span class="p">,</span>
        <span class="n">test_decode_type</span><span class="o">=</span><span class="n">test_decode_type</span><span class="p">,</span>
        <span class="o">**</span><span class="n">unused_kw</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
                  </details>



<div class="doc doc-children">












  </div>

    </div>

</div>




  </div>

    </div>

</div><h1 id="improvement-policies-base-classes">Improvement Policies (Base Classes)<a class="headerlink" href="#improvement-policies-base-classes" title="Permanent link">&para;</a></h1>


<div class="doc doc-object doc-module">




    <div class="doc doc-contents first">










<p><span class="doc-section-title">Classes:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          <b><code><a class="autorefs autorefs-internal" href="#models.common.improvement.base.ImprovementEncoder">ImprovementEncoder</a></code></b>
          –
          <div class="doc-md-description">
            <p>Base class for the encoder of improvement models</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><a class="autorefs autorefs-internal" href="#models.common.improvement.base.ImprovementDecoder">ImprovementDecoder</a></code></b>
          –
          <div class="doc-md-description">
            <p>Base decoder model for improvement models. The decoder is responsible for generating the logits of the action</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><a class="autorefs autorefs-internal" href="#models.common.improvement.base.ImprovementPolicy">ImprovementPolicy</a></code></b>
          –
          <div class="doc-md-description">
            <p>Base class for improvement policies. Improvement policies take an instance + a solution as input and output a specific operator that changes the current solution to a new one.</p>
          </div>
        </li>
    </ul>







<div class="doc doc-children">









<div class="doc doc-object doc-class">



<h2 id="models.common.improvement.base.ImprovementEncoder" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">ImprovementEncoder</span>


<a href="#models.common.improvement.base.ImprovementEncoder" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="language-python doc-signature highlight"><pre><span></span><code><span class="nf">ImprovementEncoder</span><span class="p">(</span>
    <span class="n">embed_dim</span><span class="p">:</span> <span class="n"><span title="int">int</span></span> <span class="o">=</span> <span class="mi">128</span><span class="p">,</span>
    <span class="n">init_embedding</span><span class="p">:</span> <span class="n"><span title="torch.nn.Module">Module</span></span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">pos_embedding</span><span class="p">:</span> <span class="n"><span title="torch.nn.Module">Module</span></span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">env_name</span><span class="p">:</span> <span class="n"><span title="str">str</span></span> <span class="o">=</span> <span class="s2">&quot;pdp_ruin_repair&quot;</span><span class="p">,</span>
    <span class="n">pos_type</span><span class="p">:</span> <span class="n"><span title="str">str</span></span> <span class="o">=</span> <span class="s2">&quot;CPE&quot;</span><span class="p">,</span>
    <span class="n">num_heads</span><span class="p">:</span> <span class="n"><span title="int">int</span></span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span>
    <span class="n">num_layers</span><span class="p">:</span> <span class="n"><span title="int">int</span></span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
    <span class="n">normalization</span><span class="p">:</span> <span class="n"><span title="str">str</span></span> <span class="o">=</span> <span class="s2">&quot;layer&quot;</span><span class="p">,</span>
    <span class="n">feedforward_hidden</span><span class="p">:</span> <span class="n"><span title="int">int</span></span> <span class="o">=</span> <span class="mi">128</span><span class="p">,</span>
    <span class="n">linear_bias</span><span class="p">:</span> <span class="n"><span title="bool">bool</span></span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="torch.nn.Module">Module</span></code></p>



        <p>Base class for the encoder of improvement models</p>












<p><span class="doc-section-title">Methods:</span></p>
    <ul>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" href="#models.common.improvement.base.ImprovementEncoder.forward">forward</a></code></b>
            –
            <div class="doc-md-description">
              <p>Forward pass of the encoder.</p>
            </div>
          </li>
    </ul>



                  <details class="mkdocstrings-source">
                    <summary>Source code in <code>rl4co/models/common/improvement/base.py</code></summary>
                    <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">embed_dim</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">128</span><span class="p">,</span>
    <span class="n">init_embedding</span><span class="p">:</span> <span class="n">nn</span><span class="o">.</span><span class="n">Module</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">pos_embedding</span><span class="p">:</span> <span class="n">nn</span><span class="o">.</span><span class="n">Module</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">env_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;pdp_ruin_repair&quot;</span><span class="p">,</span>
    <span class="n">pos_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;CPE&quot;</span><span class="p">,</span>
    <span class="n">num_heads</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span>
    <span class="n">num_layers</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
    <span class="n">normalization</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;layer&quot;</span><span class="p">,</span>
    <span class="n">feedforward_hidden</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">128</span><span class="p">,</span>
    <span class="n">linear_bias</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">):</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">env_name</span><span class="p">,</span> <span class="n">RL4COEnvBase</span><span class="p">):</span>
        <span class="n">env_name</span> <span class="o">=</span> <span class="n">env_name</span><span class="o">.</span><span class="n">name</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">env_name</span> <span class="o">=</span> <span class="n">env_name</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">init_embedding</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">env_init_embedding</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">env_name</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;embed_dim&quot;</span><span class="p">:</span> <span class="n">embed_dim</span><span class="p">,</span> <span class="s2">&quot;linear_bias&quot;</span><span class="p">:</span> <span class="n">linear_bias</span><span class="p">})</span>
        <span class="k">if</span> <span class="n">init_embedding</span> <span class="ow">is</span> <span class="kc">None</span>
        <span class="k">else</span> <span class="n">init_embedding</span>
    <span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">pos_type</span> <span class="o">=</span> <span class="n">pos_type</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">pos_embedding</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">pos_init_embedding</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pos_type</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;embed_dim&quot;</span><span class="p">:</span> <span class="n">embed_dim</span><span class="p">})</span>
        <span class="k">if</span> <span class="n">pos_embedding</span> <span class="ow">is</span> <span class="kc">None</span>
        <span class="k">else</span> <span class="n">pos_embedding</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
                  </details>



<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h3 id="models.common.improvement.base.ImprovementEncoder.forward" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">forward</span>


<a href="#models.common.improvement.base.ImprovementEncoder.forward" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span class="nf">forward</span><span class="p">(</span><span class="n">td</span><span class="p">:</span> <span class="n"><span title="tensordict.TensorDict">TensorDict</span></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="tuple">tuple</span></span><span class="p">[</span><span class="n"><span title="torch.Tensor">Tensor</span></span><span class="p">,</span> <span class="n"><span title="torch.Tensor">Tensor</span></span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Forward pass of the encoder.
Transform the input TensorDict into a latent representation.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>td</code></b>
              (<code><span title="tensordict.TensorDict">TensorDict</span></code>)
          –
          <div class="doc-md-description">
            <p>Input TensorDict containing the environment state</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<b><code>h</code></b> (              <code><span title="torch.Tensor">Tensor</span></code>
)          –
          <div class="doc-md-description">
            <p>Latent representation of the input</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
<b><code>init_h</code></b> (              <code><span title="torch.Tensor">Tensor</span></code>
)          –
          <div class="doc-md-description">
            <p>Initial embedding of the input</p>
          </div>
        </li>
    </ul>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>rl4co/models/common/improvement/base.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">td</span><span class="p">:</span> <span class="n">TensorDict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">Tensor</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Forward pass of the encoder.</span>
<span class="sd">    Transform the input TensorDict into a latent representation.</span>

<span class="sd">    Args:</span>
<span class="sd">        td: Input TensorDict containing the environment state</span>

<span class="sd">    Returns:</span>
<span class="sd">        h: Latent representation of the input</span>
<span class="sd">        init_h: Initial embedding of the input</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Transfer to embedding space (node)</span>
    <span class="n">init_h</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">init_embedding</span><span class="p">(</span><span class="n">td</span><span class="p">)</span>

    <span class="c1"># Transfer to embedding space (solution)</span>
    <span class="n">init_p</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pos_embedding</span><span class="p">(</span><span class="n">td</span><span class="p">)</span>

    <span class="c1"># Process embedding</span>
    <span class="n">final_h</span><span class="p">,</span> <span class="n">final_p</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_encoder_forward</span><span class="p">(</span><span class="n">init_h</span><span class="p">,</span> <span class="n">init_p</span><span class="p">)</span>

    <span class="c1"># Return latent representation and initial embedding</span>
    <span class="k">return</span> <span class="n">final_h</span><span class="p">,</span> <span class="n">final_p</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="models.common.improvement.base.ImprovementDecoder" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">ImprovementDecoder</span>


<a href="#models.common.improvement.base.ImprovementDecoder" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="torch.nn.Module">Module</span></code></p>



        <p>Base decoder model for improvement models. The decoder is responsible for generating the logits of the action</p>












<p><span class="doc-section-title">Methods:</span></p>
    <ul>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" href="#models.common.improvement.base.ImprovementDecoder.forward">forward</a></code></b>
            –
            <div class="doc-md-description">
              <p>Obtain logits to perform operators that improve the current solution to the next ones</p>
            </div>
          </li>
    </ul>






<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h3 id="models.common.improvement.base.ImprovementDecoder.forward" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">forward</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

<a href="#models.common.improvement.base.ImprovementDecoder.forward" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span class="nf">forward</span><span class="p">(</span>
    <span class="n">td</span><span class="p">:</span> <span class="n"><span title="tensordict.TensorDict">TensorDict</span></span><span class="p">,</span> <span class="n">final_h</span><span class="p">:</span> <span class="n"><span title="torch.Tensor">Tensor</span></span><span class="p">,</span> <span class="n">final_p</span><span class="p">:</span> <span class="n"><span title="torch.Tensor">Tensor</span></span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="torch.Tensor">Tensor</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Obtain logits to perform operators that improve the current solution to the next ones</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>td</code></b>
              (<code><span title="tensordict.TensorDict">TensorDict</span></code>)
          –
          <div class="doc-md-description">
            <p>TensorDict with the current environment state</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>final_h</code></b>
              (<code><span title="torch.Tensor">Tensor</span></code>)
          –
          <div class="doc-md-description">
            <p>final node embeddings</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>final_p</code></b>
              (<code><span title="torch.Tensor">Tensor</span></code>)
          –
          <div class="doc-md-description">
            <p>final positional embeddings</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><span title="torch.Tensor">Tensor</span></code>
          –
          <div class="doc-md-description">
            <p>Tuple containing the logits</p>
          </div>
        </li>
    </ul>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>rl4co/models/common/improvement/base.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">td</span><span class="p">:</span> <span class="n">TensorDict</span><span class="p">,</span> <span class="n">final_h</span><span class="p">:</span> <span class="n">Tensor</span><span class="p">,</span> <span class="n">final_p</span><span class="p">:</span> <span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tensor</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Obtain logits to perform operators that improve the current solution to the next ones</span>

<span class="sd">    Args:</span>
<span class="sd">        td: TensorDict with the current environment state</span>
<span class="sd">        final_h: final node embeddings</span>
<span class="sd">        final_p: final positional embeddings</span>

<span class="sd">    Returns:</span>
<span class="sd">        Tuple containing the logits</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;Implement me in subclass!&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="models.common.improvement.base.ImprovementPolicy" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">ImprovementPolicy</span>


<a href="#models.common.improvement.base.ImprovementPolicy" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="torch.nn.Module">Module</span></code></p>



        <p>Base class for improvement policies. Improvement policies take an instance + a solution as input and output a specific operator that changes the current solution to a new one.</p>
<p>"Improvement" means that a solution is (potentially) improved to a new one by the model.</p>












<p><span class="doc-section-title">Methods:</span></p>
    <ul>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" href="#models.common.improvement.base.ImprovementPolicy.forward">forward</a></code></b>
            –
            <div class="doc-md-description">
              <p>Forward pass of the policy.</p>
            </div>
          </li>
    </ul>






<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h3 id="models.common.improvement.base.ImprovementPolicy.forward" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">forward</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

<a href="#models.common.improvement.base.ImprovementPolicy.forward" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span class="nf">forward</span><span class="p">(</span>
    <span class="n">td</span><span class="p">:</span> <span class="n"><span title="tensordict.TensorDict">TensorDict</span></span><span class="p">,</span>
    <span class="n">env</span><span class="p">:</span> <span class="n"><span title="str">str</span></span> <span class="o">|</span> <span class="n"><span title="rl4co.envs.RL4COEnvBase">RL4COEnvBase</span></span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">phase</span><span class="p">:</span> <span class="n"><span title="str">str</span></span> <span class="o">=</span> <span class="s2">&quot;train&quot;</span><span class="p">,</span>
    <span class="n">return_actions</span><span class="p">:</span> <span class="n"><span title="bool">bool</span></span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">return_entropy</span><span class="p">:</span> <span class="n"><span title="bool">bool</span></span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">return_init_embeds</span><span class="p">:</span> <span class="n"><span title="bool">bool</span></span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">actions</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="o">**</span><span class="n">decoding_kwargs</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="dict">dict</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Forward pass of the policy.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>td</code></b>
              (<code><span title="tensordict.TensorDict">TensorDict</span></code>)
          –
          <div class="doc-md-description">
            <p>TensorDict containing the environment state</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>env</code></b>
              (<code><span title="str">str</span> | <span title="rl4co.envs.RL4COEnvBase">RL4COEnvBase</span></code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>Environment to use for decoding. If None, the environment is instantiated from <code>env_name</code>. Note that
it is more efficient to pass an already instantiated environment each time for fine-grained control</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>phase</code></b>
              (<code><span title="str">str</span></code>, default:
                  <code>&#39;train&#39;</code>
)
          –
          <div class="doc-md-description">
            <p>Phase of the algorithm (train, val, test)</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>return_actions</code></b>
              (<code><span title="bool">bool</span></code>, default:
                  <code>True</code>
)
          –
          <div class="doc-md-description">
            <p>Whether to return the actions</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>return_entropy</code></b>
              (<code><span title="bool">bool</span></code>, default:
                  <code>False</code>
)
          –
          <div class="doc-md-description">
            <p>Whether to return the entropy</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>return_init_embeds</code></b>
              (<code><span title="bool">bool</span></code>, default:
                  <code>False</code>
)
          –
          <div class="doc-md-description">
            <p>Whether to return the initial embeddings</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>actions</code></b>
          –
          <div class="doc-md-description">
            <p>Actions to use for evaluating the policy.
If passed, use these actions instead of sampling from the policy to calculate log likelihood</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>decoding_kwargs</code></b>
          –
          <div class="doc-md-description">
            <p>Keyword arguments for the decoding strategy. See :class:<code>rl4co.utils.decoding.DecodingStrategy</code> for more information.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<b><code>out</code></b> (              <code><span title="dict">dict</span></code>
)          –
          <div class="doc-md-description">
            <p>Dictionary containing the reward, log likelihood, and optionally the actions and entropy</p>
          </div>
        </li>
    </ul>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>rl4co/models/common/improvement/base.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">forward</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">td</span><span class="p">:</span> <span class="n">TensorDict</span><span class="p">,</span>
    <span class="n">env</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">RL4COEnvBase</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">phase</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;train&quot;</span><span class="p">,</span>
    <span class="n">return_actions</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">return_entropy</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">return_init_embeds</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">actions</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="o">**</span><span class="n">decoding_kwargs</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Forward pass of the policy.</span>

<span class="sd">    Args:</span>
<span class="sd">        td: TensorDict containing the environment state</span>
<span class="sd">        env: Environment to use for decoding. If None, the environment is instantiated from `env_name`. Note that</span>
<span class="sd">            it is more efficient to pass an already instantiated environment each time for fine-grained control</span>
<span class="sd">        phase: Phase of the algorithm (train, val, test)</span>
<span class="sd">        return_actions: Whether to return the actions</span>
<span class="sd">        return_entropy: Whether to return the entropy</span>
<span class="sd">        return_init_embeds: Whether to return the initial embeddings</span>
<span class="sd">        actions: Actions to use for evaluating the policy.</span>
<span class="sd">            If passed, use these actions instead of sampling from the policy to calculate log likelihood</span>
<span class="sd">        decoding_kwargs: Keyword arguments for the decoding strategy. See :class:`rl4co.utils.decoding.DecodingStrategy` for more information.</span>

<span class="sd">    Returns:</span>
<span class="sd">        out: Dictionary containing the reward, log likelihood, and optionally the actions and entropy</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;Implement me in subclass!&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>












                

              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Made with ❤️ by <a href="https://github.com/ai4co">AI4CO</a> contributors
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
      <div class="md-progress" data-md-component="progress" role="progressbar"></div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../../../../..", "features": ["announce.dismiss", "content.code.copy", "content.code.annotate", "content.code.select", "content.tabs.link", "content.tooltips", "navigation.expand", "navigation.instant", "navigation.instant.prefetch", "navigation.instant.preview", "navigation.instant.progress", "navigation.indexes", "navigation.path", "navigation.sections", "navigation.top", "navigation.tracking", "navigation.tabs", "search.suggest", "search.highlight", "search.share", "toc.follow"], "search": "../../../../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"default": "stable"}}</script>
    
    
      <script src="../../../../../assets/javascripts/bundle.79ae519e.min.js"></script>
      
        <script src="../../../../js/katex.js"></script>
      
        <script src="../../../../js/particles.min.js"></script>
      
        <script src="https://unpkg.com/katex@0/dist/katex.min.js"></script>
      
        <script src="https://unpkg.com/katex@0/dist/contrib/auto-render.min.js"></script>
      
    
  </body>
</html>